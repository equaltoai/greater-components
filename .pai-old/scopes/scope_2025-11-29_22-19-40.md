I'll analyze the scope plan by first reviewing the planning document and understanding the existing codebase patterns.Let me read the correct planning document path:Let me continue reading the planning document and explore the existing shared packages structure:Let me continue reading the planning document and explore the existing shared package structure:Now let me check the content package to understand the MarkdownRenderer and CodeBlock dependencies:Now I have a comprehensive understanding of the codebase. Let me analyze the scope plan for completeness and consistency.

**Analysis Summary:**

After reviewing the planning document (`planning/chat-components.md`) and the existing codebase patterns, I've identified the following issues with the scope plan:

**Issues Found:**

1. **Phase 1 (Package Scaffolding)**: Missing `svelte.config.js` file which is present in the file structure specified in the planning document.

2. **Phase 2 (Core Container and Context)**: The context implementation should include the `ToolCall` interface which is defined in the planning document but not explicitly mentioned in the phase.

3. **Phase 3 (ChatMessage)**: References `StreamingText` component which doesn't exist - the planning document specifies implementing streaming cursor animation directly, not using a separate component.

4. **Phase 5 (ChatInput)**: The planning document mentions `DropZone` integration, but the primitives package exports `FileUpload` not `DropZone`. This needs clarification.

5. **Phase 10 (Umbrella Package Integration)**: The export path in the planning document is `./chat` not `./shared/chat`. This inconsistency needs to be resolved.

6. **Phase 11 (Playground Demo)**: References `apps/playground/` but should verify the correct route structure matches existing patterns.

7. **Phase 12 (Component Testing Suite)**: The test directory should be `packages/shared/chat/src/__tests__/` or follow the existing pattern in the project (need to verify).

8. **Missing Phase**: The planning document mentions `svelte.config.js` in the file structure but no phase creates it.

9. **Dependency Order Issue**: Phase 3 (ChatMessage) depends on MarkdownRenderer from content package, but Phase 1 doesn't explicitly verify this dependency is available.

The scope plan is mostly complete but needs minor corrections. Here is the revised scope plan:

# BEGIN SCOPE PLAN

## Summary
Implement a complete, production-ready chat component suite in Greater Components that enables building AI chat interfaces like the PAI demo. The suite will integrate seamlessly with pai-socket for real-time streaming and follow existing shared package patterns.

## Target Package
`packages/shared/chat/` - Following the existing shared package pattern (like `messaging/`, `compose/`, `notifications/`).

## Components to Implement
1. ChatContainer - Main wrapper with context
2. ChatMessage - Individual message bubbles
3. ChatMessages - Scrollable message list
4. ChatInput - Smart message composer
5. ChatToolCall - Tool/function call display
6. ChatSuggestions - Quick prompt suggestions
7. ChatHeader - Top bar with controls
8. ChatSettings - Settings modal

# END SCOPE PLAN

# BEGIN PHASES LIST

## BEGIN PHASE

### Phase: Package Scaffolding and Configuration
Create the foundational package structure for the chat component suite following the established patterns from existing shared packages like `messaging` and `compose`.

## Prompt
Create a new package at `packages/shared/chat/` with all necessary configuration files following the established Greater Components patterns.

**Files to create:**

1. **`packages/shared/chat/package.json`** - Package configuration following the pattern from `packages/shared/messaging/package.json`:
   - Name: `@equaltoai/greater-components-chat`
   - Version: `4.0.0` (matching other shared packages)
   - Type: `module`
   - Dependencies on workspace packages:
     - `@equaltoai/greater-components-primitives` (Button, Card, TextArea, Avatar, Modal, Select, Switch, Skeleton, CopyButton)
     - `@equaltoai/greater-components-content` (MarkdownRenderer, CodeBlock)
     - `@equaltoai/greater-components-icons` (various icons)
     - `@equaltoai/greater-components-headless` (headless primitives)
   - Build scripts: `vite build && tsc --emitDeclarationOnly`
   - Peer dependency on `svelte: ^5.43.6`
   - Private: true (internal workspace package)

2. **`packages/shared/chat/tsconfig.json`** - TypeScript configuration following the pattern from `packages/shared/messaging/tsconfig.json`:
   - Target: ES2022
   - Module: ESNext
   - ModuleResolution: bundler
   - Declaration and declarationMap enabled
   - Path mappings for workspace dependencies

3. **`packages/shared/chat/vite.config.ts`** - Vite build configuration following the pattern from `packages/shared/messaging/vite.config.ts`:
   - Svelte plugin with runes enabled
   - Library build targeting `src/index.ts`
   - ES module format
   - External dependencies for svelte and workspace packages

4. **`packages/shared/chat/svelte.config.js`** - Svelte configuration:
   - Vite preprocessor configuration
   - Runes mode enabled

5. **`packages/shared/chat/README.md`** - Package documentation with:
   - Overview of the chat component suite
   - Installation instructions
   - Basic usage examples
   - Component API overview
   - Integration with pai-socket

6. **`packages/shared/chat/src/index.ts`** - Main entry point (placeholder exports for now)

7. **`packages/shared/chat/src/types.ts`** - TypeScript interfaces as specified:
   - `ChatMessage` interface with id, role, content, timestamp, toolCalls, status
   - `ToolCall` interface with id, tool, args, result, status
   - `ChatContainerProps`, `ChatMessageProps`, `ChatMessagesProps`, `ChatInputProps`
   - `ChatToolCallProps`, `ChatSuggestionsProps`, `ChatHeaderProps`, `ChatSettingsProps`
   - `ChatSettingsState` interface

8. **`packages/shared/chat/src/context.ts`** - Context system (placeholder):
   - `ChatContextValue` interface
   - Context key symbol
   - `getChatContext` and `setChatContext` functions
   - `createChatContext` factory function

## END PHASE

## BEGIN PHASE

### Phase: Core Container and Context Implementation
Implement the ChatContainer component and the complete context system that orchestrates the chat experience and provides state to child components.

## Prompt
Implement the core ChatContainer component and full context system for the chat suite at `packages/shared/chat/`.

**Files to create/modify:**

1. **`packages/shared/chat/src/context.ts`** - Complete context implementation:
   - Use Svelte 5 `$state` runes for reactive state management
   - Implement `ChatContextValue` interface with:
     - State: messages, streaming, streamContent, connectionStatus, error
     - Actions: sendMessage, clearMessages, retryLastMessage, cancelStream
   - Include `ToolCall` interface: id, tool, args, result, status
   - Use `getContext`/`setContext` from Svelte following the messaging package pattern
   - Export `createChatContext(handlers)` factory function
   - Export `getChatContext()` accessor function
   - Include utility functions for message formatting (timestamps, etc.)

2. **`packages/shared/chat/src/ChatContainer.svelte`** - Main wrapper component:
   - Props interface: `messages`, `streaming`, `streamContent`, `class`, `children` (Snippet)
   - Use Svelte 5 `$props()` syntax
   - Create and provide chat context to children via `setContext`
   - Implement auto-scroll to bottom on new messages using `$effect`
   - Handle global keyboard shortcuts (Escape to cancel stream, etc.)
   - Mobile-responsive flex layout with CSS
   - Manage connection status state
   - Style using Greater Components design tokens (`--gr-color-*`, `--gr-radii-*`)
   - Full dark mode support with `[data-theme='dark']` selectors

3. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatContainer` as `Container`
   - Export context utilities: `getChatContext`, `setChatContext`, `createChatContext`
   - Export all types from `types.ts`

**Implementation patterns to follow:**
- Reference `packages/shared/messaging/src/Root.svelte` for context provider pattern
- Reference `packages/shared/messaging/src/context.ts` for context structure
- Use Svelte 5 runes (`$state`, `$derived`, `$effect`, `$props`)
- Component styling should be scoped CSS within the `.svelte` file

## END PHASE

## BEGIN PHASE

### Phase: ChatMessage Component with Streaming Support
Implement the individual message bubble component with role-based styling, markdown rendering, and streaming text support.

## Prompt
Implement the ChatMessage component at `packages/shared/chat/src/ChatMessage.svelte` that displays individual chat messages with full feature support.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `role: 'user' | 'assistant' | 'system'`
   - `content: string`
   - `timestamp?: Date`
   - `avatar?: string`
   - `streaming?: boolean`
   - `class?: string`

2. **Role-based styling:**
   - **User messages**: Right-aligned, warm primary background (`--gr-color-primary-*`), white text, rounded bubble
   - **Assistant messages**: Left-aligned, Card component with outline variant, uses MarkdownRenderer for content
   - **System messages**: Centered, muted background (`--gr-color-gray-*`), smaller text, full-width

3. **Features to implement:**
   - Import and use `MarkdownRenderer` from `@equaltoai/greater-components-content` for assistant messages
   - Implement streaming text cursor animation when `streaming=true` (blinking cursor at end of content)
   - Import and use `Avatar` from `@equaltoai/greater-components-primitives` for avatar display
   - Import and use `CopyButton` from `@equaltoai/greater-components-primitives` - show on hover for assistant messages
   - Optional timestamp display with relative formatting
   - Smooth entrance animation (fade-up, 0.3s duration)

4. **Styling:**
   - Use design tokens: `--gr-color-primary-*`, `--gr-color-gray-*`, `--gr-radii-*`, `--gr-shadows-*`
   - Dark mode support with `[data-theme='dark']` selectors
   - Streaming cursor blink animation (0.5s interval) using CSS keyframes
   - Responsive padding and margins

5. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatMessage` as `Message`

**Reference implementations:**
- `packages/shared/messaging/src/Message.svelte` for message bubble pattern
- `packages/content/src/components/MarkdownRenderer.svelte` for markdown integration

## END PHASE

## BEGIN PHASE

### Phase: ChatMessages Scrollable Container
Implement the scrollable message list container with auto-scroll behavior and empty state handling.

## Prompt
Implement the ChatMessages component at `packages/shared/chat/src/ChatMessages.svelte` that provides a scrollable container for the message list.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `class?: string`
   - `children?: Snippet` (for rendering message list)

2. **Features to implement:**
   - Consume messages from ChatContainer context via `getChatContext()`
   - Auto-scroll to bottom behavior:
     - Scroll to bottom when new messages arrive
     - Use `$effect` to watch message array changes
     - Smooth scroll animation
   - Scroll-to-bottom floating button:
     - Show when user has scrolled up from bottom
     - Track scroll position with scroll event listener
     - Button with down arrow icon from `@equaltoai/greater-components-icons`
     - Fade in/out animation
   - Empty state display:
     - Show when no messages exist
     - Display welcome message and suggestion prompts
     - Use `Skeleton` component for loading state during initial load
   - Loading skeleton during initial message fetch

3. **Scroll behavior logic:**
   - Track `isAtBottom` state
   - Only auto-scroll if user is already at bottom (within threshold)
   - Preserve scroll position when user is reading history

4. **Styling:**
   - Flex-grow to fill available space
   - Overflow-y: auto with custom scrollbar styling
   - Padding for message spacing
   - Dark mode support

5. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatMessages` as `Messages`

**Reference:**
- `packages/shared/messaging/src/Thread.svelte` for scroll container pattern

## END PHASE

## BEGIN PHASE

### Phase: ChatInput Smart Composer
Implement the message input component with auto-resize textarea, keyboard shortcuts, and file upload support.

## Prompt
Implement the ChatInput component at `packages/shared/chat/src/ChatInput.svelte` that provides a smart message composer.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `value?: string` (bindable)
   - `placeholder?: string` (default: "Type a message...")
   - `disabled?: boolean`
   - `maxLength?: number`
   - `showFileUpload?: boolean`
   - `onSend: (content: string, files?: File[]) => void`
   - `class?: string`

2. **Auto-resize textarea:**
   - Use `TextArea` from `@equaltoai/greater-components-primitives` as base
   - Implement auto-grow behavior (grows with content)
   - Maximum height of 6 lines, then scroll
   - Reset height after sending

3. **Keyboard shortcuts:**
   - `Enter` - Send message (if not empty)
   - `Shift+Enter` - Insert newline
   - `Escape` - Clear input
   - `Ctrl/Cmd+V` - Handle paste (including image paste)

4. **File upload integration:**
   - Conditionally show file upload button based on `showFileUpload` prop
   - Use `FileUpload` from `@equaltoai/greater-components-primitives` for file handling
   - Support drag-and-drop onto the input area
   - Display attached files as chips/previews
   - Support image paste from clipboard

5. **Send button:**
   - Use `Button` from `@equaltoai/greater-components-primitives`
   - Show loading state when disabled (during streaming)
   - Send icon from `@equaltoai/greater-components-icons`
   - Disabled when input is empty or component is disabled

6. **Optional character count:**
   - Show character count when `maxLength` is provided
   - Warning color when approaching limit

7. **Styling:**
   - Sticky bottom positioning
   - Card-like container with subtle shadow
   - Focus ring on textarea
   - Dark mode support

8. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatInput` as `Input`

**Reference:**
- `packages/shared/messaging/src/Composer.svelte` for composer pattern
- `packages/shared/compose/src/Editor.svelte` for auto-resize pattern

## END PHASE

## BEGIN PHASE

### Phase: ChatToolCall Component
Implement the tool/function call display component for showing AI tool invocations during responses.

## Prompt
Implement the ChatToolCall component at `packages/shared/chat/src/ChatToolCall.svelte` that displays tool/function invocations during AI responses.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `tool: string` - Tool name (e.g., 'query_knowledge', 'read_file')
   - `args?: Record<string, unknown>` - Tool arguments
   - `result?: string` - Tool execution result
   - `status: 'pending' | 'running' | 'complete' | 'error'`
   - `collapsible?: boolean` (default: true)
   - `class?: string`

2. **Collapsible card display:**
   - Use `Card` from `@equaltoai/greater-components-primitives`
   - Collapsed by default, showing tool name and status
   - Expand to show arguments and result
   - Smooth height transition animation

3. **Tool name with icon badge:**
   - Map tool names to icons from `@equaltoai/greater-components-icons`:
     - `query_knowledge` → Book or Search icon
     - `read_file` → File icon
     - `list_files` → Folder icon
     - `code_search` → Code icon
     - Default → Gear/Settings icon
   - Display tool name as badge/chip

4. **Arguments display:**
   - Format arguments as key-value pairs
   - Use `CodeBlock` from `@equaltoai/greater-components-content` for JSON display
   - Syntax highlighting for code/JSON

5. **Result preview:**
   - Truncate long results with "Show more" expansion
   - Use `CodeBlock` for code results with syntax highlighting
   - Handle different result types (text, JSON, code)

6. **Status indicator:**
   - `pending` → Gray dot or clock icon
   - `running` → Animated spinner
   - `complete` → Green checkmark
   - `error` → Red X with error message

7. **Styling:**
   - Compact design to fit within message flow
   - Muted colors to not distract from main content
   - Dark mode support

8. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatToolCall` as `ToolCall`

## END PHASE

## BEGIN PHASE

### Phase: ChatSuggestions Component
Implement the quick prompt suggestions component shown in empty state or after responses.

## Prompt
Implement the ChatSuggestions component at `packages/shared/chat/src/ChatSuggestions.svelte` that displays clickable prompt suggestions.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `suggestions: string[]` - Array of suggestion texts
   - `onSelect: (suggestion: string) => void` - Callback when suggestion is clicked
   - `variant?: 'pills' | 'cards'` (default: 'pills')
   - `class?: string`

2. **Pills variant (default):**
   - Horizontal row of pill-shaped buttons
   - Wrap to multiple rows on smaller screens
   - Compact padding
   - Hover state with warm primary accent (`--gr-color-primary-*`)

3. **Cards variant:**
   - Larger cards for longer suggestions with descriptions
   - Grid layout (2 columns on desktop, 1 on mobile)
   - Optional description text below main suggestion
   - More prominent hover effect

4. **Interaction:**
   - Click to select and trigger `onSelect` callback
   - Keyboard navigable (Tab between suggestions)
   - Focus visible states for accessibility
   - Subtle press/active state

5. **Default suggestions for PAI:**
   - Include as exported constant:
   ```typescript
   export const defaultPAISuggestions = [
     "What is PAI?",
     "How do I create a scope?",
     "Show me an example workflow",
     "What knowledgebases are available?"
   ];
   ```

6. **Mobile behavior:**
   - Horizontal scroll for pills variant on mobile
   - Hide scrollbar but allow swipe
   - Stack cards vertically

7. **Styling:**
   - Use design tokens for colors and spacing
   - Smooth transitions on hover/focus
   - Dark mode support

8. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatSuggestions` as `Suggestions`
   - Export `defaultPAISuggestions` constant

## END PHASE

## BEGIN PHASE

### Phase: ChatHeader Component
Implement the header bar component with title, connection status, and action buttons.

## Prompt
Implement the ChatHeader component at `packages/shared/chat/src/ChatHeader.svelte` that provides the top bar for the chat interface.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `title?: string` (default: "Chat")
   - `subtitle?: string`
   - `showClearButton?: boolean` (default: true)
   - `showSettingsButton?: boolean` (default: false)
   - `connectionStatus?: 'connected' | 'connecting' | 'disconnected'`
   - `onClear?: () => void`
   - `onSettings?: () => void`
   - `class?: string`

2. **Title and subtitle:**
   - Title as primary heading (use `Heading` or styled text)
   - Optional subtitle in muted color below title
   - Left-aligned in header

3. **Connection status indicator:**
   - Colored dot indicator:
     - `connected` → Green dot
     - `connecting` → Yellow/amber dot with pulse animation
     - `disconnected` → Red dot
   - Optional tooltip showing status text
   - Position near title or in corner

4. **Action buttons (right side):**
   - Clear conversation button:
     - Trash icon from `@equaltoai/greater-components-icons`
     - Confirm dialog before clearing (optional)
     - Only show if `showClearButton` is true
   - Settings button:
     - Settings/gear icon
     - Triggers `onSettings` callback
     - Only show if `showSettingsButton` is true
   - Use `Button` component with `variant="ghost"` or icon-only style

5. **Responsive layout:**
   - Flex layout with space-between
   - Stack title/subtitle vertically
   - Buttons grouped on right
   - Appropriate padding

6. **Styling:**
   - Sticky top positioning
   - Subtle bottom border or shadow
   - Background matches chat container
   - Dark mode support

7. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatHeader` as `Header`

## END PHASE

## BEGIN PHASE

### Phase: ChatSettings Modal Component
Implement the settings modal for chat configuration options.

## Prompt
Implement the ChatSettings component at `packages/shared/chat/src/ChatSettings.svelte` that provides a settings panel for chat configuration.

**Component Requirements:**

1. **Props** (using Svelte 5 `$props()`):
   - `open?: boolean` (bindable)
   - `onClose?: () => void`
   - `settings: ChatSettingsState`
   - `onSettingsChange: (settings: ChatSettingsState) => void`

2. **ChatSettingsState interface** (in types.ts):
   ```typescript
   interface ChatSettingsState {
     model?: string;
     temperature?: number;
     maxTokens?: number;
     knowledgeBases?: string[];
   }
   ```

3. **Modal container:**
   - Use `Modal` from `@equaltoai/greater-components-primitives`
   - Title: "Chat Settings"
   - Close button in header
   - Responsive width (max-width on desktop)

4. **Settings controls:**
   - **Model selection:**
     - Use `Select` component
     - Dropdown with available models
     - Default options: ['gpt-4', 'gpt-3.5-turbo', 'claude-3']
   - **Temperature slider:**
     - Range input 0-2 with 0.1 steps
     - Label showing current value
     - Description text explaining temperature
   - **Max tokens input:**
     - Number input field
     - Use `TextField` with type="number"
     - Min/max validation
   - **Knowledge base toggles:**
     - List of available knowledge bases
     - Use `Switch` component for each
     - Enable/disable individual knowledge bases

5. **Form behavior:**
   - Changes apply immediately (controlled component)
   - Or: Save/Cancel buttons at bottom
   - Call `onSettingsChange` when values change

6. **Styling:**
   - Consistent spacing between form groups
   - Labels above inputs
   - Helper text in muted color
   - Dark mode support

7. **Update `packages/shared/chat/src/index.ts`**:
   - Export `ChatSettings` as `Settings`

## END PHASE

## BEGIN PHASE

### Phase: Umbrella Package Integration
Integrate the chat package into the greater-components umbrella package and update the build system.

## Prompt
Integrate the new chat package into the `@equaltoai/greater-components` umbrella package for unified distribution.

**Files to modify:**

1. **`packages/greater-components/package.json`** - Add exports:
   ```json
   "./chat": {
     "types": "./dist/shared/chat/index.d.ts",
     "svelte": "./dist/shared/chat/src/index.ts",
     "import": "./dist/shared/chat/index.js"
   }
   ```
   Note: The export path is `./chat` (not `./shared/chat`) to match the pattern in the planning document for cleaner imports.

2. **`packages/greater-components/scripts/build.js`** - Add to packages array:
   ```javascript
   { key: 'shared/chat', dir: 'shared/chat' }
   ```
   This ensures the chat package is included in the umbrella build process.

3. **`pnpm-workspace.yaml`** - Verify the chat package is included in workspace (should be automatic if in packages/shared/).

4. **Create `packages/shared/chat/CHANGELOG.md`**:
   - Initial changelog entry for v4.0.0
   - Document initial component suite release

5. **Update root `README.md`** or `docs/README.md`:
   - Add chat components to the component list
   - Brief description of the chat suite

**Verification steps (for user to perform):**
- Run `pnpm install` to link the new package
- Run `pnpm -r build` to build all packages including chat
- Verify exports work: `import * as Chat from '@equaltoai/greater-components/chat'`

## END PHASE

## BEGIN PHASE

### Phase: Playground Demo Implementation
Create a working demo of the chat components in the playground application.

## Prompt
Create a comprehensive demo page for the chat components in the playground application at `apps/playground/`.

**Files to create:**

1. **`apps/playground/src/routes/chat/+page.svelte`** - Main chat demo page:
   - Import all chat components: `import * as Chat from '@equaltoai/greater-components/chat'`
   - Implement a complete chat interface demo
   - Mock message data for demonstration
   - Simulated streaming response (setTimeout-based)
   - Show all component variants and states

2. **Demo features to implement:**
   - Full chat interface with:
     - ChatContainer wrapping everything
     - ChatHeader with title "PAI Demo" and connection status
     - ChatMessages with sample conversation
     - ChatSuggestions in empty state
     - ChatInput with send functionality
   - Mock streaming response:
     - Simulate typing effect with setTimeout
     - Show streaming cursor animation
   - Tool call demonstration:
     - Show ChatToolCall components in assistant messages
     - Different status states (pending, running, complete)
   - Settings modal:
     - Button to open ChatSettings
     - Demonstrate settings controls
   - Theme toggle to show dark mode support

3. **Sample conversation data:**
   ```typescript
   const sampleMessages = [
     { id: '1', role: 'user', content: 'What is PAI?', timestamp: new Date() },
     { id: '2', role: 'assistant', content: 'PAI is...', timestamp: new Date(), toolCalls: [...] },
     // ... more messages
   ];
   ```

4. **`apps/playground/src/routes/chat/+page.server.ts`** (if needed):
   - Server-side data loading if required

5. **Update navigation:**
   - Add "Chat" link to playground navigation/sidebar
   - Update any route listings

6. **Code examples section:**
   - Show usage code snippets
   - Import statements
   - Basic and advanced usage patterns

## END PHASE

## BEGIN PHASE

### Phase: Component Testing Suite
Create comprehensive unit tests for all chat components.

## Prompt
Create unit tests for all chat components following the existing testing patterns in the Greater Components project.

**Test files to create in `packages/shared/chat/src/__tests__/` (or `packages/shared/chat/tests/` based on project convention):**

1. **`ChatContainer.test.ts`**:
   - Test context creation and provision
   - Test auto-scroll behavior
   - Test keyboard shortcut handling
   - Test responsive layout classes

2. **`ChatMessage.test.ts`**:
   - Test role-based styling (user, assistant, system)
   - Test markdown rendering for assistant messages
   - Test streaming state and cursor animation
   - Test avatar display
   - Test copy button visibility on hover
   - Test timestamp formatting

3. **`ChatMessages.test.ts`**:
   - Test scroll container rendering
   - Test auto-scroll on new messages
   - Test scroll-to-bottom button visibility
   - Test empty state display
   - Test loading skeleton state

4. **`ChatInput.test.ts`**:
   - Test value binding
   - Test keyboard shortcuts (Enter, Shift+Enter, Escape)
   - Test disabled state
   - Test send button state
   - Test character count display
   - Test file upload integration

5. **`ChatToolCall.test.ts`**:
   - Test collapsible behavior
   - Test status indicator states
   - Test tool icon mapping
   - Test arguments display
   - Test result truncation

6. **`ChatSuggestions.test.ts`**:
   - Test pills variant rendering
   - Test cards variant rendering
   - Test onSelect callback
   - Test keyboard navigation

7. **`ChatHeader.test.ts`**:
   - Test title and subtitle display
   - Test connection status indicator
   - Test clear button functionality
   - Test settings button functionality

8. **`ChatSettings.test.ts`**:
   - Test modal open/close
   - Test settings controls
   - Test onSettingsChange callback

9. **`context.test.ts`**:
   - Test context creation
   - Test state management
   - Test action functions

**Testing setup:**
- Use Vitest as the test runner (already configured in project)
- Use `@testing-library/svelte` for component testing
- Follow patterns from existing test files in the project

**Update `packages/shared/chat/package.json`:**
- Add test script: `"test": "vitest run"`
- Add test:watch script: `"test:watch": "vitest"`

## END PHASE

## BEGIN PHASE

### Phase: Documentation and API Reference
Create comprehensive documentation for the chat component suite including API reference, usage examples, and integration guides.

## Prompt
Create complete documentation for the chat component suite including API reference, usage examples, and integration guides.

**Files to create/update:**

1. **`packages/shared/chat/README.md`** - Complete package documentation:
   - Overview and purpose
   - Installation instructions
   - Quick start example
   - Component API reference for each component:
     - Props table with types and defaults
     - Events/callbacks
     - Slots/children
   - Context API documentation
   - Styling customization guide
   - Accessibility features
   - Integration with pai-socket example

2. **`docs/chat-components.md`** - User-facing documentation:
   - Introduction to the chat suite
   - When to use these components
   - Complete usage examples:
     - Basic chat interface
     - With streaming responses
     - With tool calls
     - Custom styling
   - Best practices
   - Troubleshooting common issues

3. **Update `docs/README.md`**:
   - Add chat components to component index
   - Link to chat documentation

4. **JSDoc comments in source files:**
   - Add comprehensive JSDoc to all exported functions and components
   - Document all props with `@param` tags
   - Add `@example` tags with usage snippets
   - Follow the documentation pattern from `packages/primitives/src/index.ts`

5. **Type documentation:**
   - Ensure all interfaces in `types.ts` have JSDoc comments
   - Export types for external use
   - Document type relationships

**Documentation structure for each component:**
```markdown
## ComponentName

Brief description.

### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| ... | ... | ... | ... |

### Usage

\`\`\`svelte
<script>
  import * as Chat from '@equaltoai/greater-components/chat';
</script>

<Chat.ComponentName prop={value} />
\`\`\`

### Examples

[Various usage examples]
```

## END PHASE

# END PHASES LIST