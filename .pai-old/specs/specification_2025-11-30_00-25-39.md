# BEGIN MODULES LIST

## BEGIN MODULE

### Module: Chat Package README Documentation
Complete package documentation for the chat component suite with installation, quick start, API reference, and usage examples.

## Description
Creates comprehensive README.md documentation for the `@equaltoai/greater-components-chat` package. This documentation follows the established pattern from `packages/adapters/README.md` and includes: package overview, installation instructions, quick start example, component API reference with props tables, context API documentation, styling customization guide, accessibility features, and integration examples with pai-socket.

## Type
update

## Dependencies
none

## Files
packages/shared/chat/README.md

## File Changes
- packages/shared/chat/README.md: BEFORE: <<<# @equaltoai/greater-components-chat

AI chat interface components for Greater Components. Build conversational UIs with streaming responses, tool calls, and configurable settings.>>> | AFTER: <<<# @equaltoai/greater-components-chat

AI chat interface components for Greater Components. Build conversational UIs with streaming responses, tool calls, and configurable settings.

## Installation

```bash
pnpm add @equaltoai/greater-components-chat
```

### Peer Dependencies

The chat components depend on other Greater Components packages:

```bash
pnpm add @equaltoai/greater-components-primitives @equaltoai/greater-components-icons @equaltoai/greater-components-content
```

## Quick Start

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  const handlers = {
    onSubmit: async (content) => {
      // Send message to AI backend
      const response = await fetch('/api/chat', {
        method: 'POST',
        body: JSON.stringify({ message: content }),
      });
      return response.json();
    },
  };
</script>

<Chat.Container {handlers}>
  <Chat.Header title="AI Assistant" />
  <Chat.Messages />
  <Chat.Input placeholder="Type a message..." />
</Chat.Container>
```

## Components

### Chat.Container

Main container component that provides chat context and layout wrapper for all chat components. The container creates a chat context that child components access via `getChatContext()`.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `class` | `string` | `''` | Custom CSS class |
| `children` | `Snippet` | `undefined` | Child components |

**Context Props (passed to createChatContext):**

The container internally creates a chat context. You can customize behavior by providing handlers:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
  import { createChatContext } from '@equaltoai/greater-components-chat';

  const handlers = {
    onSubmit: async (content) => { /* handle message */ },
    onClear: () => { /* handle clear */ },
  };

  const initialSettings = {
    model: 'gpt-4',
    temperature: 0.7,
  };
</script>
```

**Example:**

```svelte
<Chat.Container class="my-chat">
  <Chat.Header title="AI Assistant" />
  <Chat.Messages />
  <Chat.Input />
</Chat.Container>
```

### Chat.Header

Top bar component with title, connection status, and action buttons.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `title` | `string` | `undefined` | Title text displayed in the header |
| `subtitle` | `string` | `undefined` | Subtitle text below the title |
| `connectionStatus` | `'connected' \| 'connecting' \| 'disconnected'` | `undefined` | Connection status indicator |
| `showClearButton` | `boolean` | `undefined` | Whether to show clear conversation button |
| `showSettingsButton` | `boolean` | `undefined` | Whether to show settings button |
| `onClear` | `() => void` | `undefined` | Called when clear button is clicked |
| `onSettings` | `() => void` | `undefined` | Called when settings button is clicked |
| `actions` | `Snippet` | `undefined` | Custom actions slot for additional buttons |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.Header 
  title="AI Assistant" 
  subtitle="Powered by GPT-4"
  connectionStatus="connected"
  showClearButton={true}
  showSettingsButton={true}
  onClear={() => clearConversation()}
  onSettings={() => settingsOpen = true}
/>
```

### Chat.Messages

Scrollable message list container with auto-scroll behavior and empty state handling.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `messages` | `ChatMessage[]` | required | Array of messages to display |
| `autoScroll` | `boolean` | `undefined` | Whether to auto-scroll to new messages |
| `showAvatars` | `boolean` | `undefined` | Whether to show avatars in messages |
| `assistantAvatar` | `string` | `undefined` | Custom avatar URL for assistant messages |
| `userAvatar` | `string` | `undefined` | Custom avatar URL for user messages |
| `renderMarkdown` | `boolean` | `undefined` | Whether to render markdown in message content |
| `loading` | `boolean` | `undefined` | Loading state indicator |
| `emptyState` | `Snippet` | `undefined` | Custom empty state content |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.Messages 
  {messages}
  autoScroll={true}
  showAvatars={true}
/>
```

### Chat.Message

Individual chat message display component with role-based styling and markdown rendering.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `message` | `ChatMessage` | required | The message to display |
| `showAvatar` | `boolean` | `undefined` | Whether to show the avatar |
| `assistantAvatar` | `string` | `undefined` | Custom avatar URL for assistant messages |
| `userAvatar` | `string` | `undefined` | Custom avatar URL for user messages |
| `renderMarkdown` | `boolean` | `undefined` | Whether to render markdown in message content |
| `class` | `string` | `undefined` | Custom CSS class |

### Chat.Input

Smart message composer with auto-resize textarea, keyboard shortcuts, and file upload support.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `value` | `string` | `undefined` | Current input value (bindable) |
| `placeholder` | `string` | `undefined` | Placeholder text |
| `disabled` | `boolean` | `undefined` | Whether the input is disabled |
| `autofocus` | `boolean` | `undefined` | Whether to auto-focus the input |
| `maxLength` | `number` | `undefined` | Maximum character limit |
| `showCharacterCount` | `boolean` | `undefined` | Whether to show character count |
| `multiline` | `boolean` | `undefined` | Whether to allow multiline input |
| `rows` | `number` | `undefined` | Number of rows for multiline input |
| `showFileUpload` | `boolean` | `undefined` | Whether to show file upload button |
| `acceptedFileTypes` | `string` | `undefined` | Accepted file types for upload |
| `maxFiles` | `number` | `undefined` | Maximum number of files that can be attached |
| `maxFileSize` | `number` | `undefined` | Maximum file size in bytes |
| `onSubmit` | `(content: string) => void \| Promise<void>` | `undefined` | Called when message is submitted (legacy) |
| `onSend` | `(content: string, files?: File[]) => void \| Promise<void>` | `undefined` | Called when message is submitted with optional files |
| `onChange` | `(value: string) => void` | `undefined` | Called when input value changes |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.Input 
  placeholder="Type a message..."
  showFileUpload={true}
  maxLength={4000}
  onSend={(content, files) => handleSend(content, files)}
/>
```

### Chat.Suggestions

Quick prompt suggestions displayed in empty state or after responses.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `suggestions` | `string[] \| ChatSuggestionItem[]` | required | Array of suggestions |
| `onSelect` | `(suggestion: string) => void` | required | Called when a suggestion is selected |
| `variant` | `'pills' \| 'cards'` | `'pills'` | Visual variant |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.Suggestions
  suggestions={[
    { text: "What is PAI?", description: "Learn about the platform" },
    { text: "How do I create a scope?" },
  ]}
  variant="cards"
  onSelect={(suggestion) => handleSelect(suggestion)}
/>
```

### Chat.ToolCall

Tool/function call display component with collapsible card and status indicators.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `toolCall` | `ToolCall` | required | The tool call to display |
| `showResult` | `boolean` | `undefined` | Whether to show the result |
| `collapsible` | `boolean` | `undefined` | Whether the card is collapsible |
| `defaultCollapsed` | `boolean` | `undefined` | Whether the result is initially collapsed |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.ToolCall 
  toolCall={{ 
    id: '1',
    tool: 'query_knowledge', 
    args: { query: "search term" },
    result: "Found 3 results...",
    status: 'complete'
  }}
  collapsible={true}
/>
```

### Chat.Settings

Chat configuration modal for model selection, temperature, and knowledge base toggles.

**Props:**

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `open` | `boolean` | `undefined` | Whether the settings modal is open (bindable) |
| `settings` | `ChatSettingsState` | required | Current settings state |
| `availableModels` | `Array<{ id: string; name: string }>` | `undefined` | Available models for selection |
| `availableKnowledgeBases` | `KnowledgeBaseConfig[]` | `undefined` | Available knowledge bases |
| `onSettingsChange` | `(settings: ChatSettingsState) => void` | `undefined` | Called when settings change |
| `onChange` | `(settings: ChatSettingsState) => void` | `undefined` | Called when settings change (legacy alias) |
| `onSave` | `(settings: ChatSettingsState) => void` | `undefined` | Called when settings are saved |
| `onClose` | `() => void` | `undefined` | Called when settings panel is closed |
| `class` | `string` | `undefined` | Custom CSS class |

**Example:**

```svelte
<Chat.Settings
  bind:open={settingsOpen}
  settings={chatSettings}
  onSettingsChange={(s) => chatSettings = s}
  availableModels={[
    { id: 'gpt-4', name: 'GPT-4' },
    { id: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo' },
  ]}
  availableKnowledgeBases={[
    { id: 'docs', name: 'Documentation', enabled: true },
  ]}
/>
```

## Context API

The chat components use Svelte context for shared state management.

### createChatContext

Creates a new chat context with handlers and initial settings.

```typescript
import { createChatContext } from '@equaltoai/greater-components-chat';

const context = createChatContext(handlers, initialSettings);
```

### getChatContext

Retrieves the current chat context from a parent `Chat.Container`.

```typescript
import { getChatContext } from '@equaltoai/greater-components-chat';

const context = getChatContext();

// Access state
const messages = context.state.messages;
const isStreaming = context.state.streaming;

// Use methods
context.addMessage({ role: 'user', content: 'Hello', status: 'complete' });
context.clearMessages();
context.sendMessage('Hello');
```

### ChatContextValue

```typescript
interface ChatContextValue {
  state: ChatState;
  handlers: ChatHandlers;
  updateState: (partial: Partial<ChatState>) => void;
  addMessage: (message: Omit<ChatMessage, 'id' | 'timestamp'>) => ChatMessage;
  updateMessage: (id: string, updates: Partial<ChatMessage>) => void;
  removeMessage: (id: string) => void;
  clearMessages: () => void;
  setError: (error: string | null) => void;
  toggleSettings: () => void;
  sendMessage: (content: string) => Promise<void>;
  retryLastMessage: () => Promise<void>;
  cancelStream: () => void;
  updateStreamContent: (content: string) => void;
  setConnectionStatus: (status: ConnectionStatus) => void;
  addToolCall: (messageId: string, toolCall: Omit<ToolCall, 'id'>) => ToolCall;
  updateToolCall: (messageId: string, toolCallId: string, updates: Partial<ToolCall>) => void;
}
```

### ChatHandlers

```typescript
interface ChatHandlers {
  onSubmit?: (content: string) => Promise<void> | void;
  onRegenerate?: (messageId: string) => Promise<void> | void;
  onEdit?: (messageId: string, content: string) => Promise<void> | void;
  onDelete?: (messageId: string) => Promise<void> | void;
  onClear?: () => Promise<void> | void;
  onSettingsChange?: (settings: ChatSettingsState) => void;
  onStopStreaming?: () => void;
  onRetry?: () => Promise<void> | void;
}
```

### ChatState

```typescript
interface ChatState {
  messages: ChatMessage[];
  loading: boolean;
  streaming: boolean;
  streamContent: string;
  connectionStatus: ConnectionStatus;
  error: string | null;
  settings: ChatSettingsState;
  settingsOpen: boolean;
}
```

## Types

### ChatMessage

```typescript
interface ChatMessage {
  id: string;
  role: 'user' | 'assistant' | 'system';
  content: string;
  timestamp: Date;
  toolCalls?: ToolCall[];
  status: 'pending' | 'streaming' | 'complete' | 'error';
  error?: string;
}
```

### ToolCall

```typescript
interface ToolCall {
  id: string;
  tool: string;
  args: Record<string, unknown>;
  result?: unknown;
  status: 'pending' | 'running' | 'complete' | 'error';
  error?: string;
}
```

### ChatSettingsState

```typescript
interface ChatSettingsState {
  model?: string;
  temperature?: number;
  maxTokens?: number;
  systemPrompt?: string;
  streaming?: boolean;
  knowledgeBases?: string[];
  [key: string]: unknown;
}
```

## Usage Examples

### Basic Chat Interface

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
  import { getChatContext } from '@equaltoai/greater-components-chat';

  let messages = $state([]);

  const handlers = {
    onSubmit: async (content) => {
      const response = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: content }),
      });
      const data = await response.json();
      
      // Add assistant response
      messages = [...messages, {
        id: crypto.randomUUID(),
        role: 'assistant',
        content: data.response,
        timestamp: new Date(),
        status: 'complete',
      }];
    },
    onClear: () => {
      messages = [];
    },
  };
</script>

<Chat.Container>
  <Chat.Header title="AI Assistant" showClearButton={true} onClear={handlers.onClear} />
  <Chat.Messages {messages} />
  <Chat.Input onSend={handlers.onSubmit} placeholder="Ask me anything..." />
</Chat.Container>
```

### With Streaming Responses

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);
  let loading = $state(false);

  async function handleSubmit(content) {
    // Add user message
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date(),
      status: 'complete',
    }];

    loading = true;

    try {
      const response = await fetch('/api/chat/stream', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: content }),
      });

      const reader = response.body.getReader();
      const decoder = new TextDecoder();
      let streamContent = '';

      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        streamContent += decoder.decode(value);
      }

      // Add completed assistant message
      messages = [...messages, {
        id: crypto.randomUUID(),
        role: 'assistant',
        content: streamContent,
        timestamp: new Date(),
        status: 'complete',
      }];
    } finally {
      loading = false;
    }
  }
</script>

<Chat.Container>
  <Chat.Header title="AI Assistant" connectionStatus="connected" />
  <Chat.Messages {messages} {loading} />
  <Chat.Input 
    placeholder="Type a message..."
    disabled={loading}
    onSend={handleSubmit}
  />
</Chat.Container>
```

### With Tool Calls

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);

  async function handleSubmitWithTools(content) {
    // Add user message
    const userMsg = {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date(),
      status: 'complete',
    };
    messages = [...messages, userMsg];

    // Add assistant message with tool call
    const assistantMsg = {
      id: crypto.randomUUID(),
      role: 'assistant',
      content: '',
      timestamp: new Date(),
      status: 'streaming',
      toolCalls: [{
        id: crypto.randomUUID(),
        tool: 'search_documents',
        args: { query: content },
        status: 'running',
      }],
    };
    messages = [...messages, assistantMsg];

    // Execute tool (your implementation)
    const result = await searchDocuments(content);

    // Update with result
    messages = messages.map(m => {
      if (m.id === assistantMsg.id) {
        return {
          ...m,
          content: `Based on the search results: ${result}`,
          status: 'complete',
          toolCalls: m.toolCalls?.map(tc => ({
            ...tc,
            result,
            status: 'complete',
          })),
        };
      }
      return m;
    });
  }
</script>

<Chat.Container>
  <Chat.Header title="AI with Tools" />
  <Chat.Messages {messages} />
  <Chat.Input onSend={handleSubmitWithTools} />
</Chat.Container>
```

### With Custom Styling

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
</script>

<div class="custom-chat-wrapper">
  <Chat.Container class="custom-container">
    <Chat.Header 
      title="Custom Chat" 
      class="custom-header"
    />
    <Chat.Messages {messages} class="custom-messages" />
    <Chat.Suggestions
      suggestions={["Option 1", "Option 2"]}
      variant="cards"
      class="custom-suggestions"
      onSelect={handleSelect}
    />
    <Chat.Input class="custom-input" onSend={handleSend} />
  </Chat.Container>
</div>

<style>
  .custom-chat-wrapper {
    --gr-chat-bg: var(--gr-color-surface-1);
    --gr-chat-border-radius: var(--gr-radii-lg);
    max-width: 800px;
    margin: 0 auto;
  }

  :global(.custom-container) {
    border: 1px solid var(--gr-color-border);
    border-radius: var(--gr-chat-border-radius);
    overflow: hidden;
  }

  :global(.custom-header) {
    background: var(--gr-color-surface-2);
    border-bottom: 1px solid var(--gr-color-border);
  }

  :global(.custom-messages) {
    min-height: 400px;
    max-height: 600px;
  }
</style>
```

## Accessibility

The chat components are built with accessibility in mind:

- **Keyboard Navigation**: Full keyboard support for all interactive elements
- **Screen Reader Support**: Proper ARIA labels and live regions for message updates
- **Focus Management**: Auto-focus on input, focus trap in modals
- **Reduced Motion**: Respects `prefers-reduced-motion` for animations
- **Color Contrast**: WCAG 2.1 AA compliant color combinations

### Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Enter` | Send message (single line mode) |
| `Shift + Enter` | New line in message |
| `Escape` | Cancel streaming response |
| `Ctrl/Cmd + Shift + Backspace` | Clear conversation |

## Styling

Chat components use CSS custom properties for theming. Override these variables to customize appearance:

```css
:root {
  /* Container */
  --gr-chat-bg: var(--gr-color-surface-1);
  --gr-chat-border-radius: var(--gr-radii-lg);
  
  /* Messages */
  --gr-chat-message-user-bg: var(--gr-color-primary-100);
  --gr-chat-message-assistant-bg: var(--gr-color-surface-2);
  --gr-chat-message-border-radius: var(--gr-radii-md);
  
  /* Input */
  --gr-chat-input-bg: var(--gr-color-surface-1);
  --gr-chat-input-border: var(--gr-color-border);
  
  /* Suggestions */
  --gr-chat-suggestion-bg: var(--gr-color-surface-2);
  --gr-chat-suggestion-hover-bg: var(--gr-color-surface-3);
}
```

## Best Practices

1. **Always provide handlers**: At minimum, provide `onSend` or `onSubmit` to handle message sending
2. **Handle loading states**: Disable input during loading to prevent duplicate messages
3. **Show connection status**: Display connection status for real-time applications
4. **Provide suggestions**: Help users get started with suggestion prompts
5. **Handle errors gracefully**: Display error states and provide retry options
6. **Test accessibility**: Verify keyboard navigation and screen reader compatibility

## Troubleshooting

### Messages not appearing

Ensure you're passing the `messages` prop to `Chat.Messages`:

```svelte
<Chat.Messages {messages} />
```

### Streaming not working

1. Check that you're updating the messages array reactively
2. Verify the API connection is established
3. Ensure loading state is being managed correctly

### Styles not applied

Import the required CSS:

```typescript
import '@equaltoai/greater-components/tokens/theme.css';
import '@equaltoai/greater-components/style.css';
```

## License

AGPL-3.0-only>>> | TYPE: content replacement | DESC: Complete package README with installation, quick start, component API reference (matching actual types.ts), context API, types, usage examples, accessibility, styling, and troubleshooting

## Priority
high

## END MODULE

## BEGIN MODULE

### Module: User-Facing Chat Documentation
Create comprehensive user-facing documentation for the chat component suite in the docs directory.

## Description
Creates `docs/chat-suite.md` (using a different name to avoid conflict with existing `docs/examples/chat-components.md`) with user-facing documentation including introduction, when to use, complete usage examples (basic, streaming, tool calls, custom styling), best practices, and troubleshooting. Follows the established documentation patterns from `docs/README.md` and `docs/api-reference.md`.

## Type
creation

## Dependencies
none

## Files
docs/chat-suite.md

## File Changes
- docs/chat-suite.md: BEFORE: DOES NOT EXIST | AFTER: <<<# Chat Component Suite

<!-- AI Training: This is the user-facing documentation for Greater Components Chat suite -->

Build conversational AI interfaces with the Greater Components Chat suite. These components provide a complete solution for creating chat UIs with streaming responses, tool calls, and configurable settings.

## When to Use

Use the Chat components when you need to:

- **Build AI chat interfaces** â€“ Create conversational UIs for AI assistants, chatbots, or support systems
- **Handle streaming responses** â€“ Display real-time streaming text from AI models
- **Show tool/function calls** â€“ Visualize AI tool invocations with status and results
- **Manage chat settings** â€“ Allow users to configure model, temperature, and knowledge bases
- **Support file attachments** â€“ Enable users to upload files with their messages

## Installation

```bash
pnpm add @equaltoai/greater-components-chat
```

### Required CSS

```typescript
// In your app's entry point
import '@equaltoai/greater-components/tokens/theme.css';
import '@equaltoai/greater-components/style.css';
```

## Quick Start

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);

  async function handleSend(content) {
    // Add user message
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date(),
      status: 'complete',
    }];

    // Call your API
    const response = await fetch('/api/chat', {
      method: 'POST',
      body: JSON.stringify({ message: content }),
    });
    const data = await response.json();

    // Add assistant response
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'assistant',
      content: data.response,
      timestamp: new Date(),
      status: 'complete',
    }];
  }
</script>

<Chat.Container>
  <Chat.Header title="AI Assistant" />
  <Chat.Messages {messages} />
  <Chat.Input placeholder="Type a message..." onSend={handleSend} />
</Chat.Container>
```

## Component Overview

| Component | Purpose |
|-----------|---------|
| `Chat.Container` | Main wrapper providing context and layout |
| `Chat.Header` | Top bar with title, status, and actions |
| `Chat.Messages` | Scrollable message list with auto-scroll |
| `Chat.Message` | Individual message display |
| `Chat.Input` | Message composer with file upload |
| `Chat.Suggestions` | Quick prompt suggestions |
| `Chat.ToolCall` | Tool invocation display |
| `Chat.Settings` | Configuration modal |

## Usage Examples

### Basic Chat Interface

The simplest chat implementation with message submission:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);

  async function handleSend(content) {
    // Add user message
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date(),
      status: 'complete',
    }];

    // Call your API
    const response = await fetch('/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: content }),
    });
    const data = await response.json();

    // Add assistant response
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'assistant',
      content: data.response,
      timestamp: new Date(),
      status: 'complete',
    }];
  }

  function handleClear() {
    messages = [];
  }
</script>

<Chat.Container>
  <Chat.Header 
    title="AI Assistant" 
    showClearButton={true}
    onClear={handleClear}
  />
  <Chat.Messages {messages} />
  <Chat.Input placeholder="Ask me anything..." onSend={handleSend} />
</Chat.Container>
```

### With Streaming Responses

Handle real-time streaming from AI models:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);
  let loading = $state(false);

  async function handleSend(content) {
    // Add user message
    messages = [...messages, {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date(),
      status: 'complete',
    }];

    loading = true;

    try {
      const response = await fetch('/api/chat/stream', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: content }),
      });

      const reader = response.body.getReader();
      const decoder = new TextDecoder();
      let streamContent = '';

      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        
        const chunk = decoder.decode(value);
        streamContent += chunk;
      }

      // Add completed assistant message
      messages = [...messages, {
        id: crypto.randomUUID(),
        role: 'assistant',
        content: streamContent,
        timestamp: new Date(),
        status: 'complete',
      }];
    } finally {
      loading = false;
    }
  }
</script>

<Chat.Container>
  <Chat.Header 
    title="AI Assistant" 
    connectionStatus="connected"
  />
  <Chat.Messages {messages} {loading} />
  <Chat.Input 
    placeholder="Type a message..."
    disabled={loading}
    onSend={handleSend}
  />
</Chat.Container>
```

### With Suggestions

Provide quick prompts to help users get started:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
  import { defaultPAISuggestions } from '@equaltoai/greater-components-chat';

  let messages = $state([]);
  let showSuggestions = $derived(messages.length === 0);

  async function handleSend(content) {
    // Handle message submission
  }

  function handleSuggestionSelect(suggestion) {
    handleSend(suggestion);
  }
</script>

<Chat.Container>
  <Chat.Header title="AI Assistant" />
  <Chat.Messages {messages} />
  
  {#if showSuggestions}
    <Chat.Suggestions
      suggestions={defaultPAISuggestions}
      onSelect={handleSuggestionSelect}
      variant="pills"
    />
  {/if}
  
  <Chat.Input onSend={handleSend} />
</Chat.Container>
```

### With Settings Panel

Allow users to configure chat behavior:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  let messages = $state([]);
  let settingsOpen = $state(false);
  let chatSettings = $state({
    model: 'gpt-4',
    temperature: 0.7,
    maxTokens: 4096,
    streaming: true,
  });

  const availableModels = [
    { id: 'gpt-4', name: 'GPT-4' },
    { id: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo' },
    { id: 'claude-3', name: 'Claude 3' },
  ];

  const availableKnowledgeBases = [
    { id: 'docs', name: 'Documentation', description: 'Product documentation' },
    { id: 'api', name: 'API Reference', description: 'API specifications' },
  ];

  async function handleSend(content) {
    // Use chatSettings.model, chatSettings.temperature, etc.
  }
</script>

<Chat.Container>
  <Chat.Header 
    title="AI Assistant"
    showSettingsButton={true}
    onSettings={() => settingsOpen = true}
  />
  <Chat.Messages {messages} />
  <Chat.Input onSend={handleSend} />
</Chat.Container>

<Chat.Settings
  bind:open={settingsOpen}
  settings={chatSettings}
  {availableModels}
  {availableKnowledgeBases}
  onSettingsChange={(s) => chatSettings = s}
  onClose={() => settingsOpen = false}
/>
```

### Custom Styling

Customize the appearance with CSS custom properties:

```svelte
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
</script>

<div class="branded-chat">
  <Chat.Container>
    <Chat.Header title="Support Chat" />
    <Chat.Messages {messages} />
    <Chat.Input onSend={handleSend} />
  </Chat.Container>
</div>

<style>
  .branded-chat {
    /* Container styling */
    --gr-chat-bg: #f8fafc;
    --gr-chat-border-radius: 16px;
    
    /* Message styling */
    --gr-chat-message-user-bg: #3b82f6;
    --gr-chat-message-user-color: white;
    --gr-chat-message-assistant-bg: white;
    
    /* Input styling */
    --gr-chat-input-bg: white;
    --gr-chat-input-border: #e2e8f0;
    --gr-chat-input-focus-border: #3b82f6;
    
    max-width: 600px;
    margin: 0 auto;
    height: 80vh;
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    overflow: hidden;
  }
</style>
```

## Best Practices

### 1. Handle Loading States

Always show feedback during message processing:

```svelte
<Chat.Input 
  disabled={loading}
  placeholder={loading ? "AI is typing..." : "Type a message..."}
  onSend={handleSend}
/>
```

### 2. Provide Error Handling

Display errors and offer retry options:

```svelte
<script>
  let error = $state(null);

  async function handleSend(content) {
    try {
      // ... send message
    } catch (e) {
      error = e.message;
    }
  }

  function handleRetry() {
    error = null;
    // Retry logic
  }
</script>
```

### 3. Persist Conversation History

Save messages for returning users:

```svelte
<script>
  import { browser } from '$app/environment';

  let messages = $state([]);

  // Load on mount
  $effect(() => {
    if (browser) {
      const saved = localStorage.getItem('chat-history');
      if (saved) messages = JSON.parse(saved);
    }
  });

  // Save on change
  $effect(() => {
    if (browser && messages.length > 0) {
      localStorage.setItem('chat-history', JSON.stringify(messages));
    }
  });
</script>
```

### 4. Implement Rate Limiting

Prevent spam and API abuse:

```svelte
<script>
  let lastSubmitTime = 0;
  const MIN_INTERVAL = 1000; // 1 second

  async function handleSend(content) {
    const now = Date.now();
    if (now - lastSubmitTime < MIN_INTERVAL) {
      return; // Too fast, ignore
    }
    lastSubmitTime = now;
    // ... process message
  }
</script>
```

## Troubleshooting

### Messages not displaying

**Problem**: Messages are added but don't appear in the UI.

**Solution**: Ensure you're passing the `messages` prop to `Chat.Messages`:

```svelte
<Chat.Messages {messages} />
```

### Styles not applied

**Problem**: Components render but look unstyled.

**Solution**: Import the required CSS files:

```typescript
import '@equaltoai/greater-components/tokens/theme.css';
import '@equaltoai/greater-components/style.css';
```

### File upload not working

**Problem**: File upload button doesn't appear or files aren't attached.

**Solution**: 
1. Enable file upload:
   ```svelte
   <Chat.Input showFileUpload={true} onSend={handleSend} />
   ```
2. Handle files in your send handler:
   ```svelte
   function handleSend(content, files) {
     // files is an array of File objects
   }
   ```

## Related Documentation

- [API Reference](./api-reference.md) â€“ Complete API documentation
- [Core Patterns](./core-patterns.md) â€“ Component usage patterns
- [Chat Interface Examples](./examples/chat-components.md) â€“ Building chat with primitives
- [Troubleshooting](./troubleshooting.md) â€“ Common issues and solutions

## License

AGPL-3.0-only>>> | TYPE: content creation | DESC: Create comprehensive user-facing documentation for chat components with examples and troubleshooting

## Priority
high

## END MODULE

## BEGIN MODULE

### Module: Update Main Documentation Index
Add chat components to the main documentation index in docs/README.md.

## Description
Updates `docs/README.md` to include a link to the new chat suite documentation in the appropriate section, following the existing documentation structure and patterns.

## Type
update

## Dependencies
User-Facing Chat Documentation

## Files
docs/README.md

## File Changes
- docs/README.md: BEFORE: <<<### ðŸ“š Core Documentation

- [API Reference](./api-reference.md) â€“ Complete API for all packages (primitives, headless, fediverse, adapters, icons, tokens, utils)
- [Core Patterns](./core-patterns.md) â€“ Canonical usage patterns with examples for styled components, headless components, theming, and Lesser integration
- [CSS Architecture](./css-architecture.md) â€“ Two-layer CSS system, import configurations, and styling troubleshooting
- [Development Guidelines](./development-guidelines.md) â€“ Component creation standards, testing requirements, and review checklist
- [Testing Guide](./testing-guide.md) â€“ Unit testing with Vitest, E2E testing with Playwright, accessibility testing strategies
- [Troubleshooting](./troubleshooting.md) â€“ Common issues with verified solutions for installation, TypeScript, SSR, and Lesser integration>>> | AFTER: <<<### ðŸ“š Core Documentation

- [API Reference](./api-reference.md) â€“ Complete API for all packages (primitives, headless, fediverse, adapters, icons, tokens, utils)
- [Chat Component Suite](./chat-suite.md) â€“ AI chat interface components with streaming, tool calls, and settings
- [Core Patterns](./core-patterns.md) â€“ Canonical usage patterns with examples for styled components, headless components, theming, and Lesser integration
- [CSS Architecture](./css-architecture.md) â€“ Two-layer CSS system, import configurations, and styling troubleshooting
- [Development Guidelines](./development-guidelines.md) â€“ Component creation standards, testing requirements, and review checklist
- [Testing Guide](./testing-guide.md) â€“ Unit testing with Vitest, E2E testing with Playwright, accessibility testing strategies
- [Troubleshooting](./troubleshooting.md) â€“ Common issues with verified solutions for installation, TypeScript, SSR, and Lesser integration>>> | TYPE: line edit | DESC: Add chat suite documentation link to the Core Documentation section

## Priority
medium

## END MODULE

## BEGIN MODULE

### Module: Enhanced JSDoc for Chat Index
Add comprehensive JSDoc comments to the chat package index.ts following the pattern from primitives/src/index.ts.

## Description
Updates `packages/shared/chat/src/index.ts` with enhanced JSDoc comments for all exported components and utilities, following the documentation pattern established in `packages/primitives/src/index.ts`. Includes `@fileoverview`, `@module`, `@example`, `@public`, and `@param` tags.

## Type
update

## Dependencies
none

## Files
packages/shared/chat/src/index.ts

## File Changes
- packages/shared/chat/src/index.ts: BEFORE: <<</**
 * Chat Component Suite
 *
 * AI chat interface components for building conversational UIs.
 * Supports streaming responses, tool calls, and configurable settings.
 *
 * @module @equaltoai/greater-components-chat
 *
 * @example Basic usage
 * ```svelte
 * <script>
 *   import * as Chat from '@equaltoai/greater-components-chat';
 *
 *   const handlers = {
 *     onSubmit: async (content) => {
 *       // Send message to AI backend
 *       const response = await fetch('/api/chat', {
 *         method: 'POST',
 *         body: JSON.stringify({ message: content }),
 *       });
 *       return response.json();
 *     },
 *   };
 * </script>
 *
 * <Chat.Container {handlers}>
 *   <Chat.Header title="AI Assistant" />
 *   <Chat.Messages />
 *   <Chat.Input placeholder="Type a message..." />
 * </Chat.Container>
 * ```
 *
 * @example With suggestions
 * ```svelte
 * <Chat.Container {handlers}>
 *   <Chat.Messages />
 *   <Chat.Suggestions
 *     suggestions={[
 *       { id: '1', text: 'Tell me a joke' },
 *       { id: '2', text: 'What can you help with?' },
 *     ]}
 *   />
 *   <Chat.Input />
 * </Chat.Container>
 * ```
 */

// Export types
export type {
  MessageRole,
  MessageStatus,
  ToolCallStatus,
  ToolCall,
  ChatMessage,
  ChatContainerProps,
  ChatMessageProps,
  ChatMessagesProps,
  ChatInputProps,
  ChatToolCallProps,
  ChatSuggestion,
  ChatSuggestionItem,
  ChatSuggestionsProps,
  ChatHeaderProps,
  ChatSettingsState,
  ChatSettingsProps,
  KnowledgeBaseConfig,
} from './types.js';

// Export context utilities and types
export type {
  ChatHandlers,
  ChatState,
  ChatContextValue,
  ConnectionStatus,
} from './context.svelte.js';

export {
  createChatContext,
  getChatContext,
  setChatContext,
  hasChatContext,
  formatMessageTime,
  formatStreamDuration,
  getConnectionStatusText,
} from './context.svelte.js';

// Component exports
export { default as Container } from './ChatContainer.svelte';

// Component exports
export { default as Message } from './ChatMessage.svelte';

// Messages list container with auto-scroll
export { default as Messages } from './ChatMessages.svelte';

// Chat input component
export { default as Input } from './ChatInput.svelte';

// Tool call display component
export { default as ToolCall } from './ChatToolCall.svelte';

// Chat header component
export { default as Header } from './ChatHeader.svelte';

// Suggestions component for quick prompts
export { default as Suggestions } from './ChatSuggestions.svelte';

// Settings modal component
export { default as Settings } from './ChatSettings.svelte';

/**
 * Default PAI suggestions for empty state
 */
export const defaultPAISuggestions: string[] = [
  "What is PAI?",
  "How do I create a scope?",
  "Show me an example workflow",
  "What knowledgebases are available?"
];

/**
 * Default model options for ChatSettings
 */
export const defaultModelOptions = [
  { id: 'gpt-4', name: 'GPT-4' },
  { id: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo' },
  { id: 'claude-3', name: 'Claude 3' },
];>>> | AFTER: <<</**
 * @fileoverview Greater Components Chat - AI chat interface components
 *
 * This package provides a comprehensive set of chat UI components built with
 * Svelte 5 for creating conversational AI interfaces. All components feature
 * full TypeScript support, streaming response handling, tool call visualization,
 * and WCAG 2.1 AA accessibility compliance.
 *
 * @version 4.0.0
 * @author Greater Contributors
 * @license AGPL-3.0-only
 * @module @equaltoai/greater-components-chat
 * @public
 *
 * @example Basic chat interface
 * ```svelte
 * <script>
 *   import * as Chat from '@equaltoai/greater-components-chat';
 *
 *   let messages = $state([]);
 *
 *   async function handleSend(content) {
 *     messages = [...messages, {
 *       id: crypto.randomUUID(),
 *       role: 'user',
 *       content,
 *       timestamp: new Date(),
 *       status: 'complete',
 *     }];
 *     // Call your API...
 *   }
 * </script>
 *
 * <Chat.Container>
 *   <Chat.Header title="AI Assistant" />
 *   <Chat.Messages {messages} />
 *   <Chat.Input placeholder="Type a message..." onSend={handleSend} />
 * </Chat.Container>
 * ```
 *
 * @example With suggestions
 * ```svelte
 * <Chat.Container>
 *   <Chat.Messages {messages} />
 *   <Chat.Suggestions
 *     suggestions={["Tell me a joke", "What can you help with?"]}
 *     onSelect={(s) => handleSend(s)}
 *   />
 *   <Chat.Input onSend={handleSend} />
 * </Chat.Container>
 * ```
 */

// ============================================================================
// Type Exports
// ============================================================================

/**
 * Message and state types for chat components.
 * @public
 */
export type {
  /** Role of a message sender: 'user', 'assistant', or 'system' */
  MessageRole,
  /** Status of a message: 'pending', 'streaming', 'complete', or 'error' */
  MessageStatus,
  /** Status of a tool call: 'pending', 'running', 'complete', or 'error' */
  ToolCallStatus,
  /** Tool/function call definition with args and result */
  ToolCall,
  /** Chat message with role, content, timestamp, and status */
  ChatMessage,
  /** Props for Chat.Container component */
  ChatContainerProps,
  /** Props for Chat.Message component */
  ChatMessageProps,
  /** Props for Chat.Messages component */
  ChatMessagesProps,
  /** Props for Chat.Input component */
  ChatInputProps,
  /** Props for Chat.ToolCall component */
  ChatToolCallProps,
  /** Suggestion item with id and text */
  ChatSuggestion,
  /** Simple suggestion item for string-based API */
  ChatSuggestionItem,
  /** Props for Chat.Suggestions component */
  ChatSuggestionsProps,
  /** Props for Chat.Header component */
  ChatHeaderProps,
  /** Chat settings state (model, temperature, etc.) */
  ChatSettingsState,
  /** Props for Chat.Settings component */
  ChatSettingsProps,
  /** Knowledge base configuration for settings */
  KnowledgeBaseConfig,
} from './types.js';

/**
 * Context types for chat state management.
 * @public
 */
export type {
  /** Event handlers for chat operations */
  ChatHandlers,
  /** Chat state including messages, streaming, and settings */
  ChatState,
  /** Complete chat context value with state and methods */
  ChatContextValue,
  /** Connection status: 'disconnected', 'connecting', 'connected', or 'error' */
  ConnectionStatus,
} from './context.svelte.js';

// ============================================================================
// Context Utilities
// ============================================================================

/**
 * Creates a new chat context with handlers and initial settings.
 *
 * @param handlers - Chat event handlers (onSubmit, onClear, etc.)
 * @param initialSettings - Initial settings state
 * @returns Chat context value with state and methods
 *
 * @example
 * ```typescript
 * const context = createChatContext({
 *   onSubmit: async (content) => { ... },
 *   onClear: () => { ... },
 * }, {
 *   model: 'gpt-4',
 *   temperature: 0.7,
 * });
 * ```
 * @public
 */
export { createChatContext } from './context.svelte.js';

/**
 * Retrieves the current chat context from a parent Chat.Container.
 * Must be called within a component that is a child of Chat.Container.
 *
 * @returns Chat context value
 * @throws Error if called outside of Chat.Container
 *
 * @example
 * ```typescript
 * const context = getChatContext();
 * context.addMessage({ role: 'user', content: 'Hello', status: 'complete' });
 * ```
 * @public
 */
export { getChatContext } from './context.svelte.js';

/**
 * Sets the chat context. Used internally by Chat.Container.
 * @internal
 */
export { setChatContext } from './context.svelte.js';

/**
 * Checks if a chat context exists in the current component tree.
 *
 * @returns True if chat context is available
 *
 * @example
 * ```typescript
 * if (hasChatContext()) {
 *   const context = getChatContext();
 * }
 * ```
 * @public
 */
export { hasChatContext } from './context.svelte.js';

/**
 * Formats a message timestamp for display.
 *
 * @param date - The date to format
 * @returns Formatted time string (e.g., "2:30 PM")
 * @public
 */
export { formatMessageTime } from './context.svelte.js';

/**
 * Formats streaming duration for display.
 *
 * @param startTime - Stream start timestamp
 * @returns Formatted duration string (e.g., "5s")
 * @public
 */
export { formatStreamDuration } from './context.svelte.js';

/**
 * Gets human-readable text for connection status.
 *
 * @param status - Connection status
 * @returns Status text (e.g., "Connected", "Connecting...")
 * @public
 */
export { getConnectionStatusText } from './context.svelte.js';

// ============================================================================
// Component Exports
// ============================================================================

/**
 * Main chat container component providing context and layout.
 *
 * Provides the chat context and layout wrapper for all chat components.
 *
 * @example
 * ```svelte
 * <Chat.Container>
 *   <Chat.Header title="AI Assistant" />
 *   <Chat.Messages {messages} />
 *   <Chat.Input onSend={handleSend} />
 * </Chat.Container>
 * ```
 * @public
 */
export { default as Container } from './ChatContainer.svelte';

/**
 * Individual chat message display component.
 *
 * Displays chat messages with role-based styling, markdown rendering,
 * and interactive features like copy.
 *
 * @example
 * ```svelte
 * <Chat.Message
 *   message={{ id: '1', role: 'assistant', content: 'Hello!', status: 'complete', timestamp: new Date() }}
 *   showAvatar={true}
 * />
 * ```
 * @public
 */
export { default as Message } from './ChatMessage.svelte';

/**
 * Scrollable message list container with auto-scroll.
 *
 * Provides a scrollable container for the message list with auto-scroll behavior
 * and empty state handling.
 *
 * @example
 * ```svelte
 * <Chat.Messages
 *   {messages}
 *   autoScroll={true}
 *   showAvatars={true}
 * />
 * ```
 * @public
 */
export { default as Messages } from './ChatMessages.svelte';

/**
 * Smart message composer with auto-resize and file upload.
 *
 * Provides a message input with auto-resize textarea, keyboard shortcuts,
 * file upload support, and character count functionality.
 *
 * @example
 * ```svelte
 * <Chat.Input
 *   placeholder="Type a message..."
 *   showFileUpload={true}
 *   onSend={(content, files) => handleSend(content, files)}
 * />
 * ```
 * @public
 */
export { default as Input } from './ChatInput.svelte';

/**
 * Tool/function call display component.
 *
 * Displays AI tool invocations during responses with collapsible card,
 * status indicators, and syntax-highlighted arguments/results.
 *
 * @example
 * ```svelte
 * <Chat.ToolCall
 *   toolCall={{
 *     id: '1',
 *     tool: 'search',
 *     args: { query: 'test' },
 *     status: 'complete',
 *     result: 'Found 3 results'
 *   }}
 * />
 * ```
 * @public
 */
export { default as ToolCall } from './ChatToolCall.svelte';

/**
 * Chat interface header component.
 *
 * Provides the top bar for the chat interface with title, connection status,
 * and action buttons (clear, settings).
 *
 * @example
 * ```svelte
 * <Chat.Header
 *   title="AI Assistant"
 *   subtitle="Powered by GPT-4"
 *   connectionStatus="connected"
 *   showClearButton={true}
 *   onClear={() => clearConversation()}
 * />
 * ```
 * @public
 */
export { default as Header } from './ChatHeader.svelte';

/**
 * Quick prompt suggestions component.
 *
 * Displays clickable prompt suggestions in empty state or after responses.
 * Supports pills (default) and cards variants with full keyboard navigation.
 *
 * @example
 * ```svelte
 * <Chat.Suggestions
 *   suggestions={["What is PAI?", "Show me examples"]}
 *   onSelect={(s) => handleSelect(s)}
 *   variant="pills"
 * />
 * ```
 * @public
 */
export { default as Suggestions } from './ChatSuggestions.svelte';

/**
 * Chat configuration modal component.
 *
 * Provides a settings panel for configuring chat behavior including
 * model selection, temperature, max tokens, and knowledge base toggles.
 *
 * @example
 * ```svelte
 * <Chat.Settings
 *   bind:open={settingsOpen}
 *   settings={chatSettings}
 *   availableModels={[{ id: 'gpt-4', name: 'GPT-4' }]}
 *   onSettingsChange={(s) => chatSettings = s}
 * />
 * ```
 * @public
 */
export { default as Settings } from './ChatSettings.svelte';

// ============================================================================
// Constants
// ============================================================================

/**
 * Default PAI suggestions for empty state.
 *
 * Pre-defined suggestion prompts for PAI-related chat interfaces.
 * Use these as a starting point or replace with your own suggestions.
 *
 * @example
 * ```svelte
 * <Chat.Suggestions
 *   suggestions={defaultPAISuggestions}
 *   onSelect={handleSelect}
 * />
 * ```
 * @public
 */
export const defaultPAISuggestions: string[] = [
  "What is PAI?",
  "How do I create a scope?",
  "Show me an example workflow",
  "What knowledgebases are available?"
];

/**
 * Default model options for ChatSettings.
 *
 * Pre-defined model options for the settings panel.
 * Replace with your own models based on your backend capabilities.
 *
 * @example
 * ```svelte
 * <Chat.Settings
 *   availableModels={defaultModelOptions}
 *   ...
 * />
 * ```
 * @public
 */
export const defaultModelOptions = [
  { id: 'gpt-4', name: 'GPT-4' },
  { id: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo' },
  { id: 'claude-3', name: 'Claude 3' },
];>>> | TYPE: content replacement | DESC: Enhanced JSDoc comments following primitives/src/index.ts pattern with comprehensive documentation for all exports

## Priority
high

## END MODULE

## BEGIN MODULE

### Module: Update API Reference with Chat Package
Add the Chat Package section to the main API reference documentation.

## Description
Updates `docs/api-reference.md` to include the Chat Package section with component documentation following the established pattern for other packages (Primitives, Fediverse, etc.).

## Type
update

## Dependencies
none

## Files
docs/api-reference.md

## File Changes
- docs/api-reference.md: BEFORE: <<<## Table of Contents

- [Primitives Package](#primitives-package)
  - [Settings Components](#settings-components)
  - [Theme Components](#theme-components)
- [Headless Package](#headless-package)
- [Fediverse Package](#fediverse-package)
  - [Profile Components](#profile-components)
- [Adapters Package](#adapters-package)
- [Tokens Package](#tokens-package)
- [Icons Package](#icons-package)
- [Utils Package](#utils-package)
  - [Preference Store](#preference-store)
  - [Theme Utilities](#theme-utilities)
- [Testing Package](#testing-package)>>> | AFTER: <<<## Table of Contents

- [Primitives Package](#primitives-package)
  - [Settings Components](#settings-components)
  - [Theme Components](#theme-components)
- [Headless Package](#headless-package)
- [Fediverse Package](#fediverse-package)
  - [Profile Components](#profile-components)
- [Chat Package](#chat-package)
  - [Chat Components](#chat-components)
  - [Context API](#context-api)
- [Adapters Package](#adapters-package)
- [Tokens Package](#tokens-package)
- [Icons Package](#icons-package)
- [Utils Package](#utils-package)
  - [Preference Store](#preference-store)
  - [Theme Utilities](#theme-utilities)
- [Testing Package](#testing-package)>>> | TYPE: line edit | DESC: Add Chat Package to table of contents

- docs/api-reference.md: BEFORE: <<<---

## Adapters Package>>> | AFTER: <<<---

## Chat Package

`@equaltoai/greater-components-chat`

AI chat interface components for building conversational UIs with streaming responses, tool calls, and configurable settings.

### Chat Components

#### Chat.Container

**Purpose:** Main container providing chat context and layout wrapper.

**Props:**

```typescript
interface ChatContainerProps {
  class?: string;
  children?: Snippet;
}
```

**Example:**

```svelte
<Chat.Container>
  <Chat.Header title="AI Assistant" />
  <Chat.Messages {messages} />
  <Chat.Input onSend={handleSend} />
</Chat.Container>
```

#### Chat.Header

**Purpose:** Top bar with title, connection status, and action buttons.

**Props:**

```typescript
interface ChatHeaderProps {
  title?: string;
  subtitle?: string;
  connectionStatus?: 'connected' | 'connecting' | 'disconnected';
  showClearButton?: boolean;
  showSettingsButton?: boolean;
  onClear?: () => void;
  onSettings?: () => void;
  actions?: Snippet;
  class?: string;
}
```

#### Chat.Messages

**Purpose:** Scrollable message list with auto-scroll and empty state.

**Props:**

```typescript
interface ChatMessagesProps {
  messages: ChatMessage[];
  autoScroll?: boolean;
  showAvatars?: boolean;
  assistantAvatar?: string;
  userAvatar?: string;
  renderMarkdown?: boolean;
  loading?: boolean;
  emptyState?: Snippet;
  class?: string;
}
```

#### Chat.Input

**Purpose:** Message composer with auto-resize and file upload.

**Props:**

```typescript
interface ChatInputProps {
  value?: string; // bindable
  placeholder?: string;
  disabled?: boolean;
  autofocus?: boolean;
  maxLength?: number;
  showCharacterCount?: boolean;
  multiline?: boolean;
  rows?: number;
  showFileUpload?: boolean;
  acceptedFileTypes?: string;
  maxFiles?: number;
  maxFileSize?: number;
  onSubmit?: (content: string) => void | Promise<void>;
  onSend?: (content: string, files?: File[]) => void | Promise<void>;
  onChange?: (value: string) => void;
  class?: string;
}
```

#### Chat.Suggestions

**Purpose:** Quick prompt suggestions with pills or cards variant.

**Props:**

```typescript
interface ChatSuggestionsProps {
  suggestions: string[] | ChatSuggestionItem[];
  onSelect: (suggestion: string) => void;
  variant?: 'pills' | 'cards';
  class?: string;
}
```

#### Chat.ToolCall

**Purpose:** Tool invocation display with collapsible results.

**Props:**

```typescript
interface ChatToolCallProps {
  toolCall: ToolCall;
  showResult?: boolean;
  collapsible?: boolean;
  defaultCollapsed?: boolean;
  class?: string;
}
```

#### Chat.Settings

**Purpose:** Configuration modal for model, temperature, and knowledge bases.

**Props:**

```typescript
interface ChatSettingsProps {
  open?: boolean; // bindable
  settings: ChatSettingsState;
  availableModels?: Array<{ id: string; name: string }>;
  availableKnowledgeBases?: KnowledgeBaseConfig[];
  onSettingsChange?: (settings: ChatSettingsState) => void;
  onChange?: (settings: ChatSettingsState) => void;
  onSave?: (settings: ChatSettingsState) => void;
  onClose?: () => void;
  class?: string;
}
```

### Context API

#### createChatContext

**Purpose:** Creates a new chat context with handlers and settings.

**API:**

```typescript
function createChatContext(
  handlers?: ChatHandlers,
  initialSettings?: ChatSettingsState
): ChatContextValue;
```

#### getChatContext

**Purpose:** Retrieves the current chat context from parent Container.

**API:**

```typescript
function getChatContext(): ChatContextValue;

interface ChatContextValue {
  state: ChatState;
  handlers: ChatHandlers;
  updateState: (partial: Partial<ChatState>) => void;
  addMessage: (message: Omit<ChatMessage, 'id' | 'timestamp'>) => ChatMessage;
  updateMessage: (id: string, updates: Partial<ChatMessage>) => void;
  removeMessage: (id: string) => void;
  clearMessages: () => void;
  setError: (error: string | null) => void;
  sendMessage: (content: string) => Promise<void>;
  cancelStream: () => void;
  addToolCall: (messageId: string, toolCall: Omit<ToolCall, 'id'>) => ToolCall;
  updateToolCall: (messageId: string, toolCallId: string, updates: Partial<ToolCall>) => void;
}
```

#### ChatHandlers

**Purpose:** Event handlers for chat operations.

```typescript
interface ChatHandlers {
  onSubmit?: (content: string) => Promise<void> | void;
  onRegenerate?: (messageId: string) => Promise<void> | void;
  onEdit?: (messageId: string, content: string) => Promise<void> | void;
  onDelete?: (messageId: string) => Promise<void> | void;
  onClear?: () => Promise<void> | void;
  onSettingsChange?: (settings: ChatSettingsState) => void;
  onStopStreaming?: () => void;
  onRetry?: () => Promise<void> | void;
}
```

---

## Adapters Package>>> | TYPE: line edit | DESC: Add complete Chat Package section to API reference before Adapters Package

## Priority
medium

## END MODULE

# END MODULES LIST