import{j as Lt,a as b,b as $,c as Ue,f as ps,g as _s,t as N,s as W,h as It}from"../chunks/BTgIKdxS.js";import{am as bs,an as Wt,p as Ht,J as Tt,b as Bt,a4 as ze,t as le,a as qt,g as n,c as d,s as u,h as ae,r as l,d as A,f as xe,u as U,Q as Re,e as ws,R as H}from"../chunks/D-WlePPY.js";import{p as ue,i as V,s as ys,a as Ss}from"../chunks/COMTHQNu.js";import{s as lt,d as Me,e as Oe,b as Pt}from"../chunks/EAUZg0eb.js";import{c as Se}from"../chunks/D4O329PC.js";import{D as xs}from"../chunks/DhBnkOx0.js";import{C as je,a as Ms}from"../chunks/BgGPVHid.js";import{B as oe}from"../chunks/B3zyJtUo.js";import{G as zs,H as Cs}from"../chunks/jrho69yD.js";import{H as js}from"../chunks/DbSbmSIx.js";import{S as Es}from"../chunks/4NBDaI4l.js";import{f as ks,M as Os}from"../chunks/CyXc35a2.js";import{S as Ee}from"../chunks/RefRh14L.js";import{S as ct,h as Is}from"../chunks/-F1yS8MK.js";import"../chunks/BcdIAkWN.js";import{b as Ts}from"../chunks/gQNFtiqf.js";import{i as Ps,g as As,b as Fs,j as Ds,a as Rs,k as $s}from"../chunks/Cl-J97cL.js";import{l as Ls,p as Ws}from"../chunks/LKMhQozY.js";function ke(c,o,e){let s=e.initialDeps??[],t,i=!0;function a(){var r,m,S;let v;e.key&&((r=e.debug)!=null&&r.call(e))&&(v=Date.now());const P=c();if(!(P.length!==s.length||P.some((D,j)=>s[j]!==D)))return t;s=P;let F;if(e.key&&((m=e.debug)!=null&&m.call(e))&&(F=Date.now()),t=o(...P),e.key&&((S=e.debug)!=null&&S.call(e))){const D=Math.round((Date.now()-v)*100)/100,j=Math.round((Date.now()-F)*100)/100,h=j/16,g=(x,E)=>{for(x=String(x);x.length<E;)x=" "+x;return x};console.info(`%c⏱ ${g(j,5)} /${g(D,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,e?.key)}return e?.onChange&&!(i&&e.skipInitialOnChange)&&e.onChange(t),i=!1,t}return a.updateDeps=r=>{s=r},a}function At(c,o){if(c===void 0)throw new Error("Unexpected undefined");return c}const Hs=(c,o)=>Math.abs(c-o)<1.01,Bs=(c,o,e)=>{let s;return function(...t){c.clearTimeout(s),s=c.setTimeout(()=>o.apply(this,t),e)}},Ft=c=>{const{offsetWidth:o,offsetHeight:e}=c;return{width:o,height:e}},qs=c=>c,Ns=c=>{const o=Math.max(c.startIndex-c.overscan,0),e=Math.min(c.endIndex+c.overscan,c.count-1),s=[];for(let t=o;t<=e;t++)s.push(t);return s},Us=(c,o)=>{const e=c.scrollElement;if(!e)return;const s=c.targetWindow;if(!s)return;const t=a=>{const{width:r,height:m}=a;o({width:Math.round(r),height:Math.round(m)})};if(t(Ft(e)),!s.ResizeObserver)return()=>{};const i=new s.ResizeObserver(a=>{const r=()=>{const m=a[0];if(m?.borderBoxSize){const S=m.borderBoxSize[0];if(S){t({width:S.inlineSize,height:S.blockSize});return}}t(Ft(e))};c.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(r):r()});return i.observe(e,{box:"border-box"}),()=>{i.unobserve(e)}},Dt={passive:!0},Rt=typeof window>"u"?!0:"onscrollend"in window,Vs=(c,o)=>{const e=c.scrollElement;if(!e)return;const s=c.targetWindow;if(!s)return;let t=0;const i=c.options.useScrollendEvent&&Rt?()=>{}:Bs(s,()=>{o(t,!1)},c.options.isScrollingResetDelay),a=v=>()=>{const{horizontal:P,isRtl:p}=c.options;t=P?e.scrollLeft*(p&&-1||1):e.scrollTop,i(),o(t,v)},r=a(!0),m=a(!1);e.addEventListener("scroll",r,Dt);const S=c.options.useScrollendEvent&&Rt;return S&&e.addEventListener("scrollend",m,Dt),()=>{e.removeEventListener("scroll",r),S&&e.removeEventListener("scrollend",m)}},Ks=(c,o,e)=>{if(o?.borderBoxSize){const s=o.borderBoxSize[0];if(s)return Math.round(s[e.options.horizontal?"inlineSize":"blockSize"])}return c[e.options.horizontal?"offsetWidth":"offsetHeight"]},Js=(c,{adjustments:o=0,behavior:e},s)=>{var t,i;const a=c+o;(i=(t=s.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[s.options.horizontal?"left":"top"]:a,behavior:e})};class Qs{constructor(o){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.currentScrollToIndex=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const s=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var t;(t=s())==null||t.disconnect(),e=null},observe:t=>{var i;return(i=s())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=s())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([s,t])=>{typeof t>"u"&&delete e[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:qs,rangeExtractor:Ns,onChange:()=>{},measureElement:Ks,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var s,t;(t=(s=this.options).onChange)==null||t.call(s,this,e)},this.maybeNotify=ke(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(t=>{this.observer.observe(t)}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(t,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t,this.isScrolling=i,this.maybeNotify()})),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0})}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,s)=>{const t=new Map,i=new Map;for(let a=s-1;a>=0;a--){const r=e[a];if(t.has(r.lane))continue;const m=i.get(r.lane);if(m==null||r.end>m.end?i.set(r.lane,r):r.end<m.end&&t.set(r.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,r)=>a.end===r.end?a.index-r.index:a.end-r.end)[0]:void 0},this.getMeasurementOptions=ke(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(e,s,t,i,a,r)=>(this.prevLanes!==void 0&&this.prevLanes!==r&&(this.lanesChangedFlag=!0),this.prevLanes=r,this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:a,lanes:r}),{key:!1}),this.getMeasurements=ke(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:a,lanes:r},m)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>e)for(const p of this.laneAssignments.keys())p>=e&&this.laneAssignments.delete(p);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&!this.lanesSettling&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(p=>{this.itemSizeCache.set(p.key,p.size)}));const S=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===e&&(this.lanesSettling=!1);const v=this.measurementsCache.slice(0,S),P=new Array(r).fill(void 0);for(let p=0;p<S;p++){const F=v[p];F&&(P[F.lane]=p)}for(let p=S;p<e;p++){const F=i(p),D=this.laneAssignments.get(p);let j,h;if(D!==void 0&&this.options.lanes>1){j=D;const B=P[j],ge=B!==void 0?v[B]:void 0;h=ge?ge.end+this.options.gap:s+t}else{const B=this.options.lanes===1?v[p-1]:this.getFurthestMeasurement(v,p);h=B?B.end+this.options.gap:s+t,j=B?B.lane:p%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(p,j)}const g=m.get(F),x=typeof g=="number"?g:this.options.estimateSize(p),E=h+x;v[p]={index:p,start:h,size:x,end:E,key:F,lane:j},P[j]=p}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ke(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,s,t,i)=>this.range=e.length>0&&s>0?Gs({measurements:e,outerSize:s,scrollOffset:t,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ke(()=>{let e=null,s=null;const t=this.calculateRange();return t&&(e=t.startIndex,s=t.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,s]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,s]},(e,s,t,i,a)=>i===null||a===null?[]:e({startIndex:i,endIndex:a,overscan:s,count:t}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const s=this.options.indexAttribute,t=e.getAttribute(s);return t?parseInt(t,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(e,s)=>{const t=this.indexFromElement(e),i=this.measurementsCache[t];if(!i)return;const a=i.key,r=this.elementsCache.get(a);r!==e&&(r&&this.observer.unobserve(r),this.observer.observe(e),this.elementsCache.set(a,e)),e.isConnected&&this.resizeItem(t,this.options.measureElement(e,s,this))},this.resizeItem=(e,s)=>{const t=this.measurementsCache[e];if(!t)return;const i=this.itemSizeCache.get(t.key)??t.size,a=s-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,a,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,s)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((s,t)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(t))});return}this._measureElement(e,void 0)},this.getVirtualItems=ke(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,s)=>{const t=[];for(let i=0,a=e.length;i<a;i++){const r=e[i],m=s[r];t.push(m)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const s=this.getMeasurements();if(s.length!==0)return At(s[Nt(0,s.length-1,t=>At(s[t]).start,e)])},this.getMaxScrollOffset=()=>{if(!this.scrollElement)return 0;if("scrollHeight"in this.scrollElement)return this.options.horizontal?this.scrollElement.scrollWidth-this.scrollElement.clientWidth:this.scrollElement.scrollHeight-this.scrollElement.clientHeight;{const e=this.scrollElement.document.documentElement;return this.options.horizontal?e.scrollWidth-this.scrollElement.innerWidth:e.scrollHeight-this.scrollElement.innerHeight}},this.getOffsetForAlignment=(e,s,t=0)=>{if(!this.scrollElement)return 0;const i=this.getSize(),a=this.getScrollOffset();s==="auto"&&(s=e>=a+i?"end":"start"),s==="center"?e+=(t-i)/2:s==="end"&&(e-=i);const r=this.getMaxScrollOffset();return Math.max(Math.min(r,e),0)},this.getOffsetForIndex=(e,s="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=this.measurementsCache[e];if(!t)return;const i=this.getSize(),a=this.getScrollOffset();if(s==="auto")if(t.end>=a+i-this.options.scrollPaddingEnd)s="end";else if(t.start<=a+this.options.scrollPaddingStart)s="start";else return[a,s];if(s==="end"&&e===this.options.count-1)return[this.getMaxScrollOffset(),s];const r=s==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(r,s,t.size),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:s="start",behavior:t}={})=>{t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,s),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:s="auto",behavior:t}={})=>{t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e=Math.max(0,Math.min(e,this.options.count-1)),this.currentScrollToIndex=e;let i=0;const a=10,r=S=>{if(!this.targetWindow)return;const v=this.getOffsetForIndex(e,S);if(!v){console.warn("Failed to get offset for index:",e);return}const[P,p]=v;this._scrollToOffset(P,{adjustments:void 0,behavior:t}),this.targetWindow.requestAnimationFrame(()=>{const F=()=>{if(this.currentScrollToIndex!==e)return;const D=this.getScrollOffset(),j=this.getOffsetForIndex(e,p);if(!j){console.warn("Failed to get offset for index:",e);return}Hs(j[0],D)||m(p)};this.isDynamicMode()?this.targetWindow.requestAnimationFrame(F):F()})},m=S=>{this.targetWindow&&this.currentScrollToIndex===e&&(i++,i<a?this.targetWindow.requestAnimationFrame(()=>r(S)):console.warn(`Failed to scroll to index ${e} after ${a} attempts.`))};r(s)},this.scrollBy=(e,{behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var e;const s=this.getMeasurements();let t;if(s.length===0)t=this.options.paddingStart;else if(this.options.lanes===1)t=((e=s[s.length-1])==null?void 0:e.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=s.length-1;for(;a>=0&&i.some(r=>r===null);){const r=s[a];i[r.lane]===null&&(i[r.lane]=r.end),a--}t=Math.max(...i.filter(r=>r!==null))}return Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:s,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(o)}}const Nt=(c,o,e,s)=>{for(;c<=o;){const t=(c+o)/2|0,i=e(t);if(i<s)c=t+1;else if(i>s)o=t-1;else return t}return c>0?c-1:0};function Gs({measurements:c,outerSize:o,scrollOffset:e,lanes:s}){const t=c.length-1,i=m=>c[m].start;if(c.length<=s)return{startIndex:0,endIndex:t};let a=Nt(0,t,i,e),r=a;if(s===1)for(;r<t&&c[r].end<e+o;)r++;else if(s>1){const m=Array(s).fill(0);for(;r<t&&m.some(v=>v<e+o);){const v=c[r];m[v.lane]=v.end,r++}const S=Array(s).fill(e+o);for(;a>=0&&S.some(v=>v>=e);){const v=c[a];S[v.lane]=v.start,a--}a=Math.max(0,a-a%s),r=Math.min(t,r+(s-1-r%s))}return{startIndex:a,endIndex:r}}function Ys(c){const o=new Qs(c),e=o.setOptions;let s;const t=i=>{const a={...o.options,...i,onChange:i.onChange};e({...a,onChange:(r,m)=>{s.set(r),a.onChange?.(r,m)}}),o._willUpdate()};return s=Wt(o,()=>(t(c),o._didMount())),bs(s,i=>Object.assign(i,{setOptions:t}))}function Xs(c){return Ys({observeElementRect:Us,observeElementOffset:Vs,scrollToFn:Js,...c})}var Zs=$('<div class="loading-indicator top"><div class="spinner" role="status" aria-label="Loading new items"></div></div>'),ei=$('<div class="virtual-row" role="article"><!></div>'),ti=ps('<svg class="virtual-spacer" width="100%" aria-hidden="true"></svg><!><svg class="virtual-spacer" width="100%" aria-hidden="true"></svg>',1),si=$('<div class="virtual-row" role="article"><!></div>'),ii=$('<div class="spinner" role="status" aria-label="Loading more items"></div>'),ni=$('<div class="loading-indicator bottom"><!></div>'),ri=$("<p>You've reached the end</p>"),oi=$('<div class="end-of-feed"><!></div>'),ai=$('<div><div class="timeline-scroll" role="region" aria-label="Timeline"><!> <div class="virtual-list" role="feed"><!></div> <!> <!></div></div>');function li(c,o){Ht(o,!0);const e=()=>Ss(h,"$rowVirtualizer",s),[s,t]=ys();let i=ue(o,"items",19,()=>[]),a=ue(o,"virtualScrolling",3,!0),r=ue(o,"loadingTop",3,!1),m=ue(o,"loadingBottom",3,!1),S=ue(o,"endReached",3,!1),v=ue(o,"class",3,""),P=ue(o,"density",3,"comfortable"),p=ue(o,"estimateSize",3,400),F=ue(o,"overscan",3,5),D=ae(null),j=0;const h=Xs({count:Tt(()=>i().length),getScrollElement:()=>n(D),estimateSize:()=>p(),overscan:Tt(()=>F()),getItemKey:w=>i()[w]?.id??w,indexAttribute:"data-index"});Bt(()=>{ze(h).setOptions?.({count:i().length,estimateSize:()=>p(),overscan:F(),enabled:a(),getItemKey:w=>i()[w]?.id??w})});function g(w){return ze(h).measureElement?.(w),{update:()=>ze(h).measureElement?.(w)}}function x(){if(!n(D))return;const{scrollTop:w,scrollHeight:O,clientHeight:Y}=n(D),K=w>j?"down":"up";j=w,K==="down"&&o.onLoadMore&&!m()&&!S()&&O-w-Y<500&&o.onLoadMore(),K==="up"&&o.onLoadPrevious&&!r()&&w<500&&o.onLoadPrevious()}var E=ai(),B=d(E),ge=d(B);{var Ve=w=>{var O=Zs();b(w,O)};V(ge,w=>{r()&&w(Ve)})}var Ie=u(ge,2),Ke=d(Ie);{var Te=w=>{const O=U(()=>e().getVirtualItems?.()??[]),Y=U(()=>e().getTotalSize?.()??0),K=U(()=>n(O)[0]?.start??0),J=U(()=>Math.max(0,n(Y)-(n(O)[n(O).length-1]?.end??0)));var I=ti(),R=xe(I),se=u(R);Oe(se,17,()=>n(O),M=>M.key,(M,k)=>{const X=U(()=>i()[n(k).index]);var ie=Ue(),fe=xe(ie);{var ve=pe=>{const _e=U(()=>typeof o.actionHandlers=="function"?o.actionHandlers(n(X)):o.actionHandlers);var Z=ei(),me=d(Z);ct(me,{get status(){return n(X)},get density(){return P()},showActions:!0,get actionHandlers(){return n(_e)}}),l(Z),Is(Z,be=>g?.(be)),le(()=>Me(Z,"data-index",n(k).index)),b(pe,Z)};V(fe,pe=>{n(X)&&pe(ve)})}b(M,ie)});var f=u(se);le(()=>{Me(R,"height",n(K)),Me(f,"height",n(J))}),b(w,I)},he=w=>{var O=Ue(),Y=xe(O);Oe(Y,19,i,(K,J)=>K?.id||J,(K,J)=>{const I=U(()=>typeof o.actionHandlers=="function"?o.actionHandlers(n(J)):o.actionHandlers);var R=si(),se=d(R);ct(se,{get status(){return n(J)},get density(){return P()},showActions:!0,get actionHandlers(){return n(I)}}),l(R),b(K,R)}),b(w,O)};V(Ke,w=>{a()?w(Te):w(he,!1)})}l(Ie);var Pe=u(Ie,2);{var Je=w=>{var O=ni(),Y=d(O);{var K=I=>{var R=Ue(),se=xe(R);Pt(se,()=>o.gapLoader),b(I,R)},J=I=>{var R=ii();b(I,R)};V(Y,I=>{o.gapLoader?I(K):I(J,!1)})}l(O),b(w,O)};V(Pe,w=>{m()&&!S()&&w(Je)})}var Ae=u(Pe,2);{var $e=w=>{var O=oi(),Y=d(O);{var K=I=>{var R=Ue(),se=xe(R);Pt(se,()=>o.endOfFeed),b(I,R)},J=I=>{var R=ri();b(I,R)};V(Y,I=>{o.endOfFeed?I(K):I(J,!1)})}l(O),b(w,O)};V(Ae,w=>{S()&&w($e)})}l(B),Ts(B,w=>A(D,w),()=>n(D)),l(E),le(()=>{lt(E,1,`timeline-virtualized ${v()}`),Me(B,"aria-busy",r()||m())}),Lt("scroll",B,x),b(c,E),qt(),t()}const ci=(()=>({metadata:{slug:"timeline-demo",title:"Timeline Application",description:"Complete timeline experience with a Compose dock, quick settings, virtualized feed, pinned posts, and notification rail all wired to the published stores.",sections:["Compose dock","Virtualized feed","Profile & notifications"]}})),Bi=Object.freeze(Object.defineProperty({__proto__:null,load:ci},Symbol.toStringTag,{value:"Module"})),$t={home:"People you follow plus curated boosts with client-side hydration hints.",local:"Only actors from the current instance with moderation-friendly pacing.",federated:"Wider network view with prefetch capped to avoid scroll jumps."},di=c=>typeof structuredClone=="function"?structuredClone(c):JSON.parse(JSON.stringify(c)),at=c=>c.map(o=>di(o)),ui=c=>new Promise(o=>setTimeout(o,c));function hi(c){const o=c.pageSize??5,e=c.prefetchTarget,s=c.delayMs,t=c.generator,i=new Map(Object.entries(c.seeds).map(([h,g])=>[h,at(g)])),a=new Map,r=new Map,m=Wt({filter:"home",items:[],loading:!1,error:null,hasMore:!1,viewDescription:$t.home,prefetched:0,lastUpdated:Date.now()});function S(h){const g=at(i.get(h)??[]),x=g.splice(0,o);a.set(h,g),r.set(h,0),m.set({filter:h,items:x,loading:!1,error:null,hasMore:g.length>0,viewDescription:$t[h],prefetched:g.length,lastUpdated:Date.now()}),v(h)}function v(h){const g=a.get(h)??[];for(;g.length<e;){const x=(r.get(h)??0)+1,E=at(t(h,x,o));if(E.length===0)break;r.set(h,x),g.push(...E)}a.set(h,g),m.update(x=>x.filter===h?{...x,hasMore:g.length>0,prefetched:g.length}:x)}async function P(){const h=ze(m);if(!(h.loading||h.error||!h.hasMore)){m.update(g=>g.filter===h.filter?{...g,loading:!0,error:null}:g);try{await ui(s);const g=a.get(h.filter)??[];if(g.length===0){m.update(E=>E.filter===h.filter?{...E,loading:!1,hasMore:!1,prefetched:0}:E);return}const x=g.splice(0,o);a.set(h.filter,g),m.update(E=>E.filter===h.filter?{...E,items:[...E.items,...x],loading:!1,hasMore:g.length>0,prefetched:g.length,lastUpdated:Date.now()}:E),v(h.filter)}catch(g){m.update(x=>x.filter===h.filter?{...x,loading:!1,error:g.message??"Unable to load timeline batch."}:x)}}}function p(h){if(ze(m).filter===h){S(h);return}S(h)}function F(){const h=ze(m);S(h.filter)}function D(h="Simulated network hiccup — retry to continue scrolling."){m.update(g=>({...g,loading:!1,error:h}))}function j(){m.update(h=>({...h,error:null}))}return S("home"),{subscribe:m.subscribe,setFilter:p,loadMore:P,refresh:F,simulateError:D,clearError:j}}var fi=$("<button><!> <span> </span></button>"),vi=$('<!> <!> <!> <div class="compose-dock__controls svelte-1fjec68"><!> <!> <!></div>',1),mi=$('<div class="state-card state-card--error svelte-1fjec68" role="alert"><p> </p> <!></div>'),gi=$('<p class="muted svelte-1fjec68">Boost, reply, or favorite a post to populate this log.</p>'),pi=$("<li> </li>"),_i=$('<ol class="svelte-1fjec68"></ol>'),bi=$('<li><div class="notification-row svelte-1fjec68"><img class="svelte-1fjec68"/> <div><p><strong> </strong> <!> <!> <!> <!> <!></p> <span class="muted svelte-1fjec68"> </span></div> <!></div></li>'),wi=$('<section class="timeline-app svelte-1fjec68" aria-label="Timeline application demo"><section class="timeline-app__sidebar svelte-1fjec68" aria-label="Timeline navigation"><div class="sidebar-header"><p class="section-eyebrow">Compose dock</p> <h2>Filters + quick settings</h2> <p>Switch feeds, tweak density, and open preferences without leaving the dock.</p></div> <nav class="sidebar-nav svelte-1fjec68" aria-label="Timeline filters"><!> <button class="preferences-trigger svelte-1fjec68"><!> <span>Preferences</span></button></nav> <div class="quick-settings svelte-1fjec68"><h3 class="svelte-1fjec68">Quick settings</h3> <div class="quick-settings__list svelte-1fjec68"><div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Auto fetches batches in the background</p></div> <div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Expand attachments inside the feed</p></div> <div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Dim or hide reposts</p></div></div> <p class="muted svelte-1fjec68" aria-live="polite"> </p></div></section> <div class="timeline-app__main svelte-1fjec68"><section class="compose-dock svelte-1fjec68" aria-labelledby="compose-heading"><div class="compose-dock__header"><div><p class="section-eyebrow">Compose dock</p> <h2 id="compose-heading"> </h2></div> <p class="muted svelte-1fjec68" aria-live="polite"> </p></div> <!></section> <section class="timeline-feed svelte-1fjec68" aria-live="polite"><header class="svelte-1fjec68"><div><p class="section-eyebrow">Timeline</p> <h2> </h2> <p class="muted svelte-1fjec68"> </p></div> <div class="timeline-feed__actions svelte-1fjec68"><!> <!></div></header> <!> <div><!></div> <div class="action-log svelte-1fjec68" aria-live="polite"><strong>Recent interactions</strong> <!></div></section></div> <section class="timeline-app__meta svelte-1fjec68" aria-label="Timeline meta"><section class="profile-card svelte-1fjec68" aria-label="Profile summary"><div class="profile-card__header svelte-1fjec68"><!> <div><h3> </h3> <p class="muted svelte-1fjec68"> </p></div></div> <dl class="svelte-1fjec68"><div><dt class="svelte-1fjec68">Followers</dt> <dd class="svelte-1fjec68"> </dd></div> <div><dt class="svelte-1fjec68">Following</dt> <dd class="svelte-1fjec68"> </dd></div> <div><dt class="svelte-1fjec68">Posts</dt> <dd class="svelte-1fjec68"> </dd></div></dl> <!></section> <section class="pinned-card svelte-1fjec68" aria-label="Pinned posts"><header><h3>Pinned posts</h3> <p class="muted svelte-1fjec68">Highlights from product + research teams.</p></header> <div class="pinned-card__list svelte-1fjec68"></div></section> <section class="notifications-card svelte-1fjec68" aria-label="Notifications"><header><div><h3>Notifications</h3> <p class="muted svelte-1fjec68">Mentions, boosts, follows</p></div> <!></header> <ul class="svelte-1fjec68"></ul></section></section></section>'),yi=$('<form class="preferences-form svelte-1fjec68"><div class="preferences-grid svelte-1fjec68"><div><p class="section-eyebrow">Appearance</p> <h3>Density + media</h3> <div class="density-toggle svelte-1fjec68" role="group" aria-label="Timeline density"><!> <!></div> <div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Autoplay attachments</p></div></div> <div><p class="section-eyebrow">Streaming</p> <h3>Live updates</h3> <div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Pulls the next batch when users near the end</p></div> <div class="quick-toggle svelte-1fjec68"><!> <p class="muted svelte-1fjec68">Dim reposts in high-noise timelines</p></div></div></div> <div class="preferences-footer svelte-1fjec68"><!> <!></div></form>'),Si=$("<!> <!>",1);function qi(c,o){Ht(o,!0);const e={density:"comfortable",autoplayMedia:!0,showBoosts:!0,streaming:!0},s="timeline-app-preferences",t=hi({seeds:Ps(),generator:$s,pageSize:4,prefetchTarget:8,delayMs:360});let i=ae(Re(ze(t)));const a=t.subscribe(f=>{A(i,f,!0)});ws(()=>{a()});const r=As(),m=Fs(),S=Ds();let v=ae(Re(e)),P=!1,p=ae(!1),F=ae(!1),D=ae("Spoilers about today's release"),j=ae(Re([])),h=ae("idle"),g=ae(Re(Rs().slice(0,4))),x=ae(Re([]));const E=[{id:"home",label:"Home",icon:js,filter:"home"},{id:"local",label:"Local",icon:zs,filter:"local"},{id:"federated",label:"Federated",icon:Cs,filter:"federated"}],B=f=>new Promise(M=>setTimeout(M,f));Bt(()=>{if(!P){A(v,Ls(s,e),!0),P=!0;return}Ws(s,n(v))});const ge=U(()=>()=>[...n(j),...n(i).items]),Ve=U(()=>()=>n(h)==="sending"?"Posting to "+n(i).filter+"…":n(h)==="saved"?"Posted to "+n(i).filter+" timeline":"Drafts stay local to each filter"),Ie=U(()=>()=>n(v).streaming?n(i).loading?"Streaming new posts…":`Updated ${new Date(n(i).lastUpdated).toLocaleTimeString()}`:"Streaming paused"),Ke={onReply:f=>Te("Reply",f.account.acct),onBoost:f=>Te("Boost",f.account.acct),onFavorite:f=>Te("Favorite",f.account.acct)};function Te(f,M){A(x,[`${f} • ${M}`,...n(x)].slice(0,4),!0)}function he(f,M){A(v,{...n(v),[f]:!n(v)[f]},!0)}function Pe(f){A(v,{...n(v),density:f},!0)}function Je(f){if(f.filter){t.setFilter(f.filter);return}A(p,!0)}function Ae(f){return f>=1e6?`${(f/1e6).toFixed(1)}M`:f>=1e3?`${(f/1e3).toFixed(1)}K`:f.toString()}function $e(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`status-${Date.now()}`}function w(f){const M=f.trim();return M?M.split(`
`).filter(Boolean).map(k=>`<p>${k}</p>`).join(""):"<p>(Shared from Compose dock)</p>"}const O={onSubmit:async f=>{A(h,"sending"),await B(480);const M={id:$e(),uri:`https://equalto.social/@${S.username}/${Date.now()}`,url:`https://equalto.social/@${S.username}/${Date.now()}`,account:{...S},content:w(f.content),createdAt:new Date().toISOString(),visibility:f.visibility,repliesCount:0,reblogsCount:0,favouritesCount:0,spoilerText:f.contentWarning,sensitive:!!f.contentWarning,mediaAttachments:(f.mediaAttachments??[]).map(k=>({id:k.id??$e(),type:k.type??"image",url:k.url??k.previewUrl??"https://placehold.co/600x400/0f172a/ffffff?text=Media",previewUrl:k.previewUrl??k.url,description:k.description??k.file?.name??"Attachment"})),mentions:[],tags:[{name:n(i).filter,url:`https://equalto.social/tags/${n(i).filter}`}]};A(j,[M,...n(j)].slice(0,4),!0),A(g,[{id:`notif-compose-${M.id}`,type:"mention",createdAt:M.createdAt,account:M.account,status:M,read:!1},...n(g).slice(0,3)],!0),A(h,"saved"),setTimeout(()=>A(h,"idle"),1800)},onMediaUpload:async f=>{await B(650);const M=URL.createObjectURL(f);return{id:`timeline-upload-${f.name}-${Date.now()}`,type:f.type.startsWith("video")?"video":"image",url:M,previewUrl:M,description:f.name}}};function Y(f){A(g,n(g).map(M=>M.id===f?{...M,read:!0}:M),!0)}function K(){A(g,n(g).map(f=>({...f,read:!0})),!0)}function J(f){f.preventDefault(),A(p,!1)}var I=Si(),R=xe(I);xs(R,{eyebrow:"Fediverse Surface",get title(){return o.data.metadata.title},get description(){return o.data.metadata.description},children:(f,M)=>{var k=wi(),X=d(k),ie=u(d(X),2),fe=d(ie);Oe(fe,17,()=>E,y=>y.id,(y,_)=>{const z=U(()=>n(_).icon);var T=fi();let L;var Q=d(T);Se(Q,()=>n(z),(Ce,ye)=>{ye(Ce,{size:18,"aria-hidden":"true"})});var ne=u(Q,2),re=d(ne,!0);l(ne),l(T),le(()=>{Me(T,"aria-pressed",n(_).filter?n(i).filter===n(_).filter:void 0),L=lt(T,1,"svelte-1fjec68",null,L,{selected:n(_).filter?n(i).filter===n(_).filter:!1}),W(re,n(_).label)}),It("click",T,()=>Je(n(_))),b(y,T)});var ve=u(fe,2),pe=d(ve);Es(pe,{size:18,"aria-hidden":"true"}),H(2),l(ve),l(ie);var _e=u(ie,2),Z=u(d(_e),2),me=d(Z),be=d(me);Ee(be,{label:"Live streaming",get checked(){return n(v).streaming},onclick:()=>he("streaming")}),H(2),l(me);var Fe=u(me,2),Le=d(Fe);Ee(Le,{label:"Inline media",get checked(){return n(v).autoplayMedia},onclick:()=>he("autoplayMedia")}),H(2),l(Fe);var We=u(Fe,2),He=d(We);Ee(He,{label:"Show boosts",get checked(){return n(v).showBoosts},onclick:()=>he("showBoosts")}),H(2),l(We),l(Z);var De=u(Z,2),Qe=d(De,!0);l(De),l(_e),l(X);var ee=u(X,2),ce=d(ee),de=d(ce),we=d(de),dt=u(d(we),2),Ut=d(dt);l(dt),l(we);var ut=u(we,2),Vt=d(ut,!0);l(ut),l(de);var Kt=u(de,2);Se(Kt,()=>je.Root,(y,_)=>{_(y,{config:{allowMedia:!0,placeholder:"Share a release update…"},get handlers(){return O},children:(z,T)=>{var L=vi(),Q=xe(L);Se(Q,()=>je.Editor,(q,G)=>{G(q,{rows:4})});var ne=u(Q,2);Se(ne,()=>je.MediaUpload,(q,G)=>{G(q,{})});var re=u(ne,2);Ms(re,{get enabled(){return n(F)},set enabled(q){A(F,q,!0)},get text(){return n(D)},set text(q){A(D,q,!0)}});var Ce=u(re,2),ye=d(Ce);Se(ye,()=>je.VisibilitySelect,(q,G)=>{G(q,{})});var qe=u(ye,2);Se(qe,()=>je.CharacterCount,(q,G)=>{G(q,{})});var Ne=u(qe,2);Se(Ne,()=>je.Submit,(q,G)=>{G(q,{text:"Publish"})}),l(Ce),b(z,L)},$$slots:{default:!0}})}),l(ce);var ht=u(ce,2),Ge=d(ht),Ye=d(Ge),Xe=u(d(Ye),2),Jt=d(Xe,!0);l(Xe);var ft=u(Xe,2),Qt=d(ft);l(ft),l(Ye);var vt=u(Ye,2),mt=d(vt);oe(mt,{size:"sm",variant:"outline",onclick:()=>t.refresh(),children:(y,_)=>{H();var z=N("Refresh");b(y,z)},$$slots:{default:!0}});var Gt=u(mt,2);oe(Gt,{size:"sm",onclick:()=>t.loadMore(),get disabled(){return n(i).loading},children:(y,_)=>{H();var z=N();le(()=>W(z,n(i).loading?"Loading…":"Load more")),b(y,z)},$$slots:{default:!0}}),l(vt),l(Ge);var gt=u(Ge,2);{var Yt=y=>{var _=mi(),z=d(_),T=d(z,!0);l(z);var L=u(z,2);oe(L,{size:"sm",variant:"ghost",onclick:()=>t.clearError(),children:(Q,ne)=>{H();var re=N("Dismiss");b(Q,re)},$$slots:{default:!0}}),l(_),le(()=>W(T,n(i).error)),b(y,_)};V(gt,y=>{n(i).error&&y(Yt)})}var Be=u(gt,2),Xt=d(Be);{let y=U(()=>n(ge)());li(Xt,{get items(){return n(y)},get density(){return n(v).density},get actionHandlers(){return Ke},get loadingBottom(){return n(i).loading}})}l(Be);var pt=u(Be,2),Zt=u(d(pt),2);{var es=y=>{var _=gi();b(y,_)},ts=y=>{var _=_i();Oe(_,23,()=>n(x),(z,T)=>z+T,(z,T)=>{var L=pi(),Q=d(L,!0);l(L),le(()=>W(Q,n(T))),b(z,L)}),l(_),b(y,_)};V(Zt,y=>{n(x).length===0?y(es):y(ts,!1)})}l(pt),l(ht),l(ee);var _t=u(ee,2),Ze=d(_t),et=d(Ze),bt=d(et);ks(bt,{get src(){return r.avatar},get alt(){return r.displayName},size:"lg"});var wt=u(bt,2),tt=d(wt),ss=d(tt,!0);l(tt);var yt=u(tt,2),is=d(yt);l(yt),l(wt),l(et);var st=u(et,2),it=d(st),St=u(d(it),2),ns=d(St,!0);l(St),l(it);var nt=u(it,2),xt=u(d(nt),2),rs=d(xt,!0);l(xt),l(nt);var Mt=u(nt,2),zt=u(d(Mt),2),os=d(zt,!0);l(zt),l(Mt),l(st);var as=u(st,2);{let y=U(()=>r.relationship?.following?"ghost":"solid");oe(as,{size:"sm",get variant(){return n(y)},children:(_,z)=>{H();var T=N();le(()=>W(T,r.relationship?.following?"Following":"Follow")),b(_,T)},$$slots:{default:!0}})}l(Ze);var rt=u(Ze,2),Ct=u(d(rt),2);Oe(Ct,21,()=>m,y=>y.id,(y,_)=>{ct(y,{get status(){return n(_)},density:"compact"})}),l(Ct),l(rt);var jt=u(rt,2),ot=d(jt),ls=u(d(ot),2);oe(ls,{size:"sm",variant:"ghost",onclick:K,children:(y,_)=>{H();var z=N("Clear");b(y,z)},$$slots:{default:!0}}),l(ot);var Et=u(ot,2);Oe(Et,21,()=>n(g),y=>y.id,(y,_)=>{var z=bi(),T=d(z),L=d(T),Q=u(L,2),ne=d(Q),re=d(ne),Ce=d(re,!0);l(re);var ye=u(re,2);{var qe=C=>{var te=N("left a mention");b(C,te)};V(ye,C=>{n(_).type==="mention"&&C(qe)})}var Ne=u(ye,2);{var q=C=>{var te=N("followed you");b(C,te)};V(Ne,C=>{n(_).type==="follow"&&C(q)})}var G=u(Ne,2);{var cs=C=>{var te=N("favorited your post");b(C,te)};V(G,C=>{n(_).type==="favourite"&&C(cs)})}var kt=u(G,2);{var ds=C=>{var te=N("boosted your post");b(C,te)};V(kt,C=>{n(_).type==="reblog"&&C(ds)})}var us=u(kt,2);{var hs=C=>{var te=N("requested to follow you");b(C,te)};V(us,C=>{n(_).type==="follow_request"&&C(hs)})}l(ne);var Ot=u(ne,2),fs=d(Ot,!0);l(Ot),l(Q);var vs=u(Q,2);{var ms=C=>{oe(C,{size:"sm",variant:"outline",onclick:()=>Y(n(_).id),children:(te,xi)=>{H();var gs=N("Mark read");b(te,gs)},$$slots:{default:!0}})};V(vs,C=>{n(_).read||C(ms)})}l(T),l(z),le(C=>{Me(L,"src",n(_).account.avatar),Me(L,"alt",n(_).account.displayName),W(Ce,n(_).account.displayName),W(fs,C)},[()=>new Date(n(_).createdAt).toLocaleTimeString()]),b(y,z)}),l(Et),l(jt),l(_t),l(k),le((y,_,z,T,L)=>{W(Qe,y),W(Ut,`Post directly into ${n(i).filter??""} timeline`),W(Vt,_),W(Jt,n(i).viewDescription),W(Qt,`Prefetched ${n(i).prefetched??""} posts · Density ${n(v).density??""}`),lt(Be,1,`timeline-virtualized timeline-virtualized--${n(v).density} ${n(v).autoplayMedia?"":"timeline-virtualized--media-muted"}`,"svelte-1fjec68"),W(ss,r.displayName),W(is,`@${r.acct??""}`),W(ns,z),W(rs,T),W(os,L)},[()=>n(Ie)(),()=>n(Ve)(),()=>Ae(r.followersCount),()=>Ae(r.followingCount),()=>Ae(r.statusesCount)]),It("click",ve,()=>A(p,!0)),b(f,k)},$$slots:{default:!0}});var se=u(R,2);Os(se,{title:"Timeline preferences",size:"lg",get open(){return n(p)},set open(f){A(p,f,!0)},children:(f,M)=>{var k=yi(),X=d(k),ie=d(X),fe=u(d(ie),4),ve=d(fe);{let ee=U(()=>n(v).density==="comfortable"?"solid":"ghost");oe(ve,{size:"sm",get variant(){return n(ee)},onclick:()=>Pe("comfortable"),type:"button",children:(ce,de)=>{H();var we=N("Comfortable");b(ce,we)},$$slots:{default:!0}})}var pe=u(ve,2);{let ee=U(()=>n(v).density==="compact"?"solid":"ghost");oe(pe,{size:"sm",get variant(){return n(ee)},onclick:()=>Pe("compact"),type:"button",children:(ce,de)=>{H();var we=N("Compact");b(ce,we)},$$slots:{default:!0}})}l(fe);var _e=u(fe,2),Z=d(_e);Ee(Z,{label:"Inline media",get checked(){return n(v).autoplayMedia},onclick:()=>he("autoplayMedia")}),H(2),l(_e),l(ie);var me=u(ie,2),be=u(d(me),4),Fe=d(be);Ee(Fe,{label:"Enable live streaming",get checked(){return n(v).streaming},onclick:()=>he("streaming")}),H(2),l(be);var Le=u(be,2),We=d(Le);Ee(We,{label:"Show boosts",get checked(){return n(v).showBoosts},onclick:()=>he("showBoosts")}),H(2),l(Le),l(me),l(X);var He=u(X,2),De=d(He);oe(De,{variant:"ghost",type:"button",onclick:()=>A(p,!1),children:(ee,ce)=>{H();var de=N("Cancel");b(ee,de)},$$slots:{default:!0}});var Qe=u(De,2);oe(Qe,{type:"submit",children:(ee,ce)=>{H();var de=N("Close");b(ee,de)},$$slots:{default:!0}}),l(He),l(k),Lt("submit",k,J),b(f,k)},$$slots:{default:!0}}),b(c,I),qt()}_s(["click"]);export{qi as component,Bi as universal};
