import{g as He,a as l,b as m,c as ye,j as Ke,s as $,h as Te,t as Be}from"../chunks/BTgIKdxS.js";import{h as re,aF as _t,g as e,aC as ft,u as C,d as _,al as yt,Q as Ve,ak as Bt,p as Re,J as st,b as ze,o as St,e as Pt,s as o,t as G,a as qe,c as s,r as a,f as ue,R as Ce,P as jt}from"../chunks/D-WlePPY.js";import{p as k,i as D}from"../chunks/COMTHQNu.js";import{s as Se,c as We,b as Oe,d as ve,e as Ye,r as Et,g as Lt}from"../chunks/EAUZg0eb.js";import{c as xe}from"../chunks/D4O329PC.js";import{D as Rt}from"../chunks/DhBnkOx0.js";import{C as tt}from"../chunks/DeXdVqsM.js";import{B as Me}from"../chunks/B3zyJtUo.js";import{f as qt,b as Ft,g as rt,M as Ut,d as Kt}from"../chunks/CyXc35a2.js";import{b as Je}from"../chunks/gQNFtiqf.js";import{R as kt,A as Ot,P as pt,F as wt,a as Nt,B as Ht,C as Wt,b as Gt,X as Vt,c as Yt,T as Jt}from"../chunks/DziMgXXC.js";import{C as Xt}from"../chunks/CR34osJy.js";import{M as Qt,C as bt}from"../chunks/CvRxRDBZ.js";import{I as Zt,S as $t}from"../chunks/D-nUao87.js";import{S as ea}from"../chunks/DaFBZdGH.js";import{X as ta}from"../chunks/CmyNwxHW.js";import{C as aa}from"../chunks/W22M3h50.js";import{C as xt}from"../chunks/CdTf8eP5.js";import{S as zt}from"../chunks/4NBDaI4l.js";import{C as sa}from"../chunks/WuZ2rQSq.js";import{B as na}from"../chunks/uym6WrKg.js";import{T as oa}from"../chunks/DPkrTyWx.js";import{S as ra}from"../chunks/RefRh14L.js";import{T as Ze}from"../chunks/xP_8Rc2R.js";var Ct=!1;class $e extends Date{#e=re(super.getTime());#t=new Map;#a=_t;constructor(...t){super(...t),Ct||this.#s()}#s(){Ct=!0;var t=$e.prototype,n=Date.prototype,S=Object.getOwnPropertyNames(n);for(const r of S)(r.startsWith("get")||r.startsWith("to")||r==="valueOf")&&(t[r]=function(...h){if(h.length>0)return e(this.#e),n[r].apply(this,h);var g=this.#t.get(r);if(g===void 0){const c=_t;ft(this.#a),g=C(()=>(e(this.#e),n[r].apply(this,h))),this.#t.set(r,g),ft(c)}return e(g)}),r.startsWith("set")&&(t[r]=function(...h){var g=n[r].apply(this,h);return _(this.#e,n.getTime.call(this)),g})}}const it=Symbol("chat-context");function la(){return`msg_${globalThis.crypto.randomUUID()}`}function ia(){return`tc_${globalThis.crypto.randomUUID()}`}function ca(N={},t={}){const n=Ve({messages:[],loading:!1,streaming:!1,streamContent:"",connectionStatus:"disconnected",error:null,settings:{model:void 0,temperature:.7,maxTokens:4096,systemPrompt:void 0,streaming:!0,...t},settingsOpen:!1}),S={state:n,handlers:N,updateState:r=>{Object.assign(n,r)},addMessage:r=>{const h={...r,id:la(),timestamp:new $e};return n.messages=[...n.messages,h],h},updateMessage:(r,h)=>{n.messages=n.messages.map(g=>g.id===r?{...g,...h}:g)},removeMessage:r=>{n.messages=n.messages.filter(h=>h.id!==r)},clearMessages:()=>{n.messages=[],n.error=null,n.streamContent="",n.streaming=!1,N.onClear?.()},setError:r=>{n.error=r,r&&(n.connectionStatus="error")},toggleSettings:()=>{n.settingsOpen=!n.settingsOpen},sendMessage:async r=>{if(!(!r.trim()||n.loading)){n.loading=!0,n.error=null,n.streamContent="",S.addMessage({role:"user",content:r.trim(),status:"complete"});try{await N.onSubmit?.(r.trim())}catch(h){n.error=h instanceof Error?h.message:"Failed to send message";const g=n.messages[n.messages.length-1];g&&g.role==="assistant"&&S.updateMessage(g.id,{status:"error",error:n.error})}finally{n.loading=!1,n.streaming=!1}}},retryLastMessage:async()=>{const r=[...n.messages].reverse().findIndex(c=>c.role==="user");if(r===-1)return;const h=n.messages.length-1-r;if(n.messages[h]){n.messages=n.messages.slice(0,h+1),n.error=null,n.loading=!0;try{await N.onRetry?.()}catch(c){n.error=c instanceof Error?c.message:"Failed to retry message"}finally{n.loading=!1,n.streaming=!1}}},cancelStream:()=>{n.streaming=!1,n.loading=!1,N.onStopStreaming?.();const r=n.messages.find(h=>h.status==="streaming");r&&S.updateMessage(r.id,{status:"complete",content:n.streamContent||r.content}),n.streamContent=""},updateStreamContent:r=>{n.streamContent=r,n.streaming=!0;const h=n.messages.find(g=>g.status==="streaming");h&&S.updateMessage(h.id,{content:r})},setConnectionStatus:r=>{n.connectionStatus=r},addToolCall:(r,h)=>{const g={...h,id:ia()};return n.messages=n.messages.map(c=>c.id===r?{...c,toolCalls:[...c.toolCalls||[],g]}:c),g},updateToolCall:(r,h,g)=>{n.messages=n.messages.map(c=>c.id===r&&c.toolCalls?{...c,toolCalls:c.toolCalls.map(Y=>Y.id===h?{...Y,...g}:Y)}:c)}};return Bt(it,S),S}function Tt(){const N=yt(it);if(!N)throw new Error("Chat components must be used within a Chat.Container component");return N}function da(){try{const N=yt(it);return N!=null}catch{return!1}}function va(N){const t=typeof N=="string"?new $e(N):N,n=new $e,S=n.getTime()-t.getTime(),r=Math.floor(S/1e3),h=Math.floor(r/60),g=Math.floor(h/60),c=Math.floor(g/24);return c===0?t.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit",hour12:!0}):c===1?"Yesterday":c<7?t.toLocaleDateString(void 0,{weekday:"long"}):t.toLocaleDateString(void 0,{month:"short",day:"numeric",year:t.getFullYear()!==n.getFullYear()?"numeric":void 0})}He(["click"]);var ua=m('<span class="chat-container__status-indicator chat-container__status-indicator--connecting svelte-1fchn9x"></span> <span class="svelte-1fchn9x">Connecting...</span>',1),ha=m('<span class="chat-container__status-indicator chat-container__status-indicator--error svelte-1fchn9x"></span> <span class="svelte-1fchn9x">Connection error</span>',1),ga=m('<div class="chat-container__status svelte-1fchn9x" role="status"><!></div>'),ma=m('<div role="region" aria-label="Chat conversation" aria-live="polite"><div class="chat-container__inner svelte-1fchn9x"><!> <div class="chat-container__scroll-anchor svelte-1fchn9x" aria-hidden="true"></div></div> <!></div>');function _a(N,t){Re(t,!0);let n=k(t,"handlers",19,()=>({})),S=k(t,"messages",19,()=>[]),r=k(t,"streaming",3,!1),h=k(t,"streamContent",3,""),g=k(t,"loading",3,!1),c=k(t,"connectionStatus",3,"disconnected"),Y=k(t,"initialSettings",19,()=>({})),X=k(t,"autoScroll",3,!0),F=k(t,"enableKeyboardShortcuts",3,!0),ae=k(t,"fillHeight",3,!1),U=k(t,"flex",3,!1),y=k(t,"class",3,"");const J=C(()=>ae()||U()),T=ca(st(()=>n()),st(()=>Y()));ze(()=>{Object.assign(T.handlers,n())});let j=re(void 0),L=re(void 0);ze(()=>{S().length>0&&T.updateState({messages:S()})}),ze(()=>{T.updateState({streaming:r(),streamContent:h()})}),ze(()=>{T.updateState({loading:g()})}),ze(()=>{T.setConnectionStatus(c())}),ze(()=>{X()&&T.state.messages.length>0&&se()}),ze(()=>{X()&&T.state.streaming&&se()});function se(){e(L)&&e(L).scrollIntoView({behavior:"smooth",block:"end"})}function ie(p){F()&&(p.key==="Escape"&&T.state.streaming&&(p.preventDefault(),T.cancelStream()),(p.ctrlKey||p.metaKey)&&p.shiftKey&&p.key==="Backspace"&&(p.preventDefault(),T.clearMessages()))}St(()=>{F()&&window.addEventListener("keydown",ie)}),Pt(()=>{F()&&window.removeEventListener("keydown",ie)});const ee=C(()=>["chat-container",e(J)&&"chat-container--fill-height",T.state.streaming&&"chat-container--streaming",T.state.loading&&"chat-container--loading",T.state.error&&"chat-container--error",T.state.connectionStatus==="connected"&&"chat-container--connected",T.state.connectionStatus==="connecting"&&"chat-container--connecting",T.state.connectionStatus==="error"&&"chat-container--connection-error",y()].filter(Boolean).join(" "));var x=ma(),H=s(x),ne=s(H);{var M=p=>{var B=ye(),P=ue(B);Oe(P,()=>t.children),l(p,B)};D(ne,p=>{t.children&&p(M)})}var le=o(ne,2);Je(le,p=>_(L,p),()=>e(L)),a(H);var V=o(H,2);{var f=p=>{var B=ga(),P=s(B);{var d=E=>{var Q=ua();Ce(2),l(E,Q)},R=E=>{var Q=ha();Ce(2),l(E,Q)};D(P,E=>{T.state.connectionStatus==="connecting"?E(d):T.state.connectionStatus==="error"&&E(R,1)})}a(B),l(p,B)};D(V,p=>{T.state.connectionStatus!=="connected"&&T.state.connectionStatus!=="disconnected"&&p(f)})}a(x),Je(x,p=>_(j,p),()=>e(j)),G(()=>Se(x,1,We(e(ee)),"svelte-1fchn9x")),l(N,x),qe()}var fa=m('<div class="chat-message__avatar svelte-eor5wh"><!></div>'),pa=m('<span class="chat-message__cursor svelte-eor5wh" aria-hidden="true"></span>'),wa=m('<div class="chat-message__content svelte-eor5wh"><!> <!></div>'),ba=m('<div class="chat-message__content svelte-eor5wh"> </div>'),xa=m('<div class="chat-message__content svelte-eor5wh"> </div>'),Ca=m('<div class="chat-message__error svelte-eor5wh"><span class="chat-message__error-text svelte-eor5wh"> </span></div>'),ya=m('<time class="chat-message__timestamp svelte-eor5wh"> </time>'),Sa=m('<div role="article"><!> <div class="chat-message__content-wrapper svelte-eor5wh"><div><!> <!></div> <div><!> <!> <!></div> <!></div></div>');function ka(N,t){Re(t,!0);let n=k(t,"showAvatar",3,!0),S=k(t,"streaming",3,!1),r=k(t,"status",3,"complete"),h=k(t,"class",3,""),g=re(!1);const c=C(()=>t.showCopyButton??t.role==="assistant"),Y=C(()=>t.showRetryButton??r()==="error"),X=C(()=>r()==="error"),F=C(()=>["chat-message",`chat-message--${t.role}`,S()&&"chat-message--streaming",h()].filter(Boolean).join(" ")),ae=C(()=>{switch(t.role){case"user":return"User";case"assistant":return"AI Assistant";case"system":return"System";default:return"Unknown"}}),U=C(()=>{switch(t.role){case"user":return"You";case"assistant":return"AI";case"system":return"Sys";default:return"?"}});var y=Sa(),J=s(y);{var T=v=>{var b=fa(),w=s(b);{var te=u=>{var A=ye(),q=ue(A);Oe(q,()=>t.userAvatar),l(u,A)},K=u=>{var A=ye(),q=ue(A);Oe(q,()=>t.assistantAvatar),l(u,A)},Z=u=>{qt(u,{get src(){return t.avatar},get name(){return e(ae)},get label(){return e(U)},fallbackMode:"label",size:"sm",shape:"circle"})};D(w,u=>{t.role==="user"&&t.userAvatar?u(te):t.role==="assistant"&&t.assistantAvatar?u(K,1):u(Z,!1)})}a(b),l(v,b)};D(J,v=>{t.role!=="system"&&n()&&v(T)})}var j=o(J,2),L=s(j);let se;var ie=s(L);{var ee=v=>{var b=ye(),w=ue(b);Oe(w,()=>t.renderContent,()=>({content:t.content,streaming:S()})),l(v,b)},x=v=>{var b=wa(),w=s(b);Qt(w,{get content(){return t.content},sanitize:!0,enableLinks:!0,openLinksInNewTab:!0});var te=o(w,2);{var K=Z=>{var u=pa();l(Z,u)};D(te,Z=>{S()&&Z(K)})}a(b),l(v,b)},H=v=>{var b=ba(),w=s(b,!0);a(b),G(()=>$(w,t.content)),l(v,b)},ne=v=>{var b=xa(),w=s(b,!0);a(b),G(()=>$(w,t.content)),l(v,b)};D(ie,v=>{t.renderContent?v(ee):t.role==="assistant"?v(x,1):t.role==="user"?v(H,2):v(ne,!1)})}var M=o(ie,2);{var le=v=>{var b=Ca(),w=s(b),te=s(w,!0);a(w),a(b),G(()=>$(te,t.error)),l(v,b)};D(M,v=>{e(X)&&t.error&&v(le)})}a(L);var V=o(L,2);let f;var p=s(V);{var B=v=>{var b=ye(),w=ue(b);Oe(w,()=>t.actions),l(v,b)};D(p,v=>{t.actions&&v(B)})}var P=o(p,2);{var d=v=>{Xt(v,{get text(){return t.content},variant:"icon",buttonVariant:"ghost",size:"sm"})};D(P,v=>{e(c)&&t.content&&!e(X)&&v(d)})}var R=o(P,2);{var E=v=>{Me(v,{variant:"ghost",size:"sm",get onclick(){return t.onRetry},"aria-label":"Retry message",prefix:w=>{kt(w,{size:14})},$$slots:{prefix:!0}})};D(R,v=>{e(Y)&&e(X)&&t.onRetry&&v(E)})}a(V);var Q=o(V,2);{var ge=v=>{var b=ya(),w=s(b,!0);a(b),G((te,K)=>{ve(b,"datetime",te),$(w,K)},[()=>t.timestamp.toISOString(),()=>va(t.timestamp)]),l(v,b)};D(Q,v=>{t.timestamp&&v(ge)})}a(j),a(y),G(()=>{Se(y,1,We(e(F)),"svelte-eor5wh"),ve(y,"aria-label",`${e(ae)} message`),se=Se(L,1,"chat-message__bubble svelte-eor5wh",null,se,{"chat-message__bubble--error":e(X)}),f=Se(V,1,"chat-message__actions svelte-eor5wh",null,f,{"chat-message__actions--visible":e(g)&&!S()})}),Ke("mouseenter",y,()=>_(g,!0)),Ke("mouseleave",y,()=>_(g,!1)),l(N,y),qe()}var za=m('<div class="chat-messages__loading svelte-10bzdee"><div class="chat-messages__skeleton svelte-10bzdee"><div class="chat-messages__skeleton-avatar svelte-10bzdee"></div> <div class="chat-messages__skeleton-content svelte-10bzdee"><div class="chat-messages__skeleton-line chat-messages__skeleton-line--short svelte-10bzdee"></div> <div class="chat-messages__skeleton-line chat-messages__skeleton-line--medium svelte-10bzdee"></div></div></div> <div class="chat-messages__skeleton chat-messages__skeleton--right svelte-10bzdee"><div class="chat-messages__skeleton-content svelte-10bzdee"><div class="chat-messages__skeleton-line chat-messages__skeleton-line--medium svelte-10bzdee"></div></div> <div class="chat-messages__skeleton-avatar svelte-10bzdee"></div></div> <div class="chat-messages__skeleton svelte-10bzdee"><div class="chat-messages__skeleton-avatar svelte-10bzdee"></div> <div class="chat-messages__skeleton-content svelte-10bzdee"><div class="chat-messages__skeleton-line chat-messages__skeleton-line--long svelte-10bzdee"></div> <div class="chat-messages__skeleton-line chat-messages__skeleton-line--short svelte-10bzdee"></div> <div class="chat-messages__skeleton-line chat-messages__skeleton-line--medium svelte-10bzdee"></div></div></div></div>'),Ta=m('<button type="button" class="chat-messages__suggestion svelte-10bzdee"> </button>'),Ma=m('<div class="chat-messages__suggestions svelte-10bzdee"></div>'),Aa=m('<div class="chat-messages__empty-state svelte-10bzdee"><div class="chat-messages__empty-icon svelte-10bzdee"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-10bzdee"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" class="svelte-10bzdee"></path></svg></div> <h3 class="chat-messages__empty-title svelte-10bzdee"> </h3> <p class="chat-messages__empty-message svelte-10bzdee"> </p> <!></div>'),Ia=m('<div class="chat-messages__list svelte-10bzdee"><!></div> <div class="chat-messages__scroll-anchor svelte-10bzdee" aria-hidden="true"></div>',1),Da=m('<div class="chat-messages__scroll-button-wrapper svelte-10bzdee"><!></div>'),Ba=m('<div role="log" aria-label="Chat messages" aria-live="polite" aria-relevant="additions"><!> <!></div>');function Pa(N,t){Re(t,!0);let n=k(t,"class",3,""),S=k(t,"welcomeTitle",3,"Welcome!"),r=k(t,"welcomeMessage",3,"How can I help you today?"),h=k(t,"suggestions",19,()=>[]),g=k(t,"showAvatars",3,!0),c=k(t,"scrollThreshold",3,100);const Y=Tt();let X=re(void 0),F=re(void 0),ae=re(!0),U=re(!1),y=re(0);const J=C(()=>Y.state.messages),T=C(()=>Y.state.loading),j=C(()=>Y.state.streaming),L=C(()=>e(J).length>0),se=C(()=>e(T)&&e(J).length===0);function ie(){if(!e(X))return!0;const{scrollTop:d,scrollHeight:R,clientHeight:E}=e(X);return R-d-E<=c()}function ee(d=!0){e(F)&&e(F).scrollIntoView({behavior:d?"smooth":"instant",block:"end"})}function x(){const d=ie();_(ae,d,!0),_(U,!d&&e(L),!0)}function H(){ee(!0),_(U,!1)}ze(()=>{const d=e(J).length;d>e(y)&&e(ae)&&requestAnimationFrame(()=>{ee(!0)}),_(y,d,!0)}),ze(()=>{e(j)&&e(ae)&&requestAnimationFrame(()=>{ee(!1)})}),St(()=>{e(L)&&ee(!1)});const ne=C(()=>["chat-messages",e(T)&&"chat-messages--loading",e(j)&&"chat-messages--streaming",!e(L)&&"chat-messages--empty",n()].filter(Boolean).join(" "));var M=Ba(),le=s(M);{var V=d=>{var R=za();l(d,R)},f=d=>{var R=ye(),E=ue(R);{var Q=v=>{var b=ye(),w=ue(b);Oe(w,()=>t.emptyState),l(v,b)},ge=v=>{var b=Aa(),w=o(s(b),2),te=s(w,!0);a(w);var K=o(w,2),Z=s(K,!0);a(K);var u=o(K,2);{var A=q=>{var oe=Ma();Ye(oe,20,h,he=>he,(he,ce)=>{var W=Ta(),we=s(W,!0);a(W),G(()=>$(we,ce)),Te("click",W,()=>t.onSuggestionClick?.(ce)),l(he,W)}),a(oe),l(q,oe)};D(u,q=>{h().length>0&&q(A)})}a(b),G(()=>{$(te,S()),$(Z,r())}),l(v,b)};D(E,v=>{t.emptyState?v(Q):v(ge,!1)})}l(d,R)},p=d=>{var R=Ia(),E=ue(R),Q=s(E);{var ge=w=>{var te=ye(),K=ue(te);Oe(K,()=>t.children),l(w,te)},v=w=>{var te=ye(),K=ue(te);Ye(K,17,()=>e(J),Z=>Z.id,(Z,u)=>{{let A=C(()=>e(u).status==="streaming"),q=C(()=>e(u).role==="assistant"?t.assistantAvatar:t.userAvatar),oe=C(()=>e(u).role==="assistant"?t.assistantAvatarLabel:t.userAvatarLabel);ka(Z,{get role(){return e(u).role},get content(){return e(u).content},get timestamp(){return e(u).timestamp},get streaming(){return e(A)},get status(){return e(u).status},get error(){return e(u).error},get avatar(){return e(q)},get showAvatar(){return g()},get avatarLabel(){return e(oe)},get userAvatar(){return t.userAvatarSnippet},get assistantAvatar(){return t.assistantAvatarSnippet},get renderContent(){return t.renderMessageContent}})}}),l(w,te)};D(Q,w=>{t.children?w(ge):w(v,!1)})}a(E);var b=o(E,2);Je(b,w=>_(F,w),()=>e(F)),l(d,R)};D(le,d=>{e(se)?d(V):e(L)?d(p,!1):d(f,1)})}var B=o(le,2);{var P=d=>{var R=Da(),E=s(R);Me(E,{variant:"solid",size:"sm",class:"chat-messages__scroll-button",onclick:H,"aria-label":"Scroll to bottom",children:(Q,ge)=>{Ot(Q,{size:16})},$$slots:{default:!0}}),a(R),l(d,R)};D(B,d=>{e(U)&&d(P)})}a(M),Je(M,d=>_(X,d),()=>e(X)),G(()=>Se(M,1,We(e(ne)),"svelte-10bzdee")),Ke("scroll",M,x),l(N,M),qe()}He(["click"]);var ja=m('<div class="chat-input__drag-overlay svelte-oh1jm"><div class="chat-input__drag-content svelte-oh1jm"><!> <span>Drop files here</span></div></div>'),Ea=m('<img class="chat-input__attachment-preview svelte-oh1jm"/>'),La=m('<div class="chat-input__attachment-icon svelte-oh1jm"><!></div>'),Ra=m('<div class="chat-input__attachment svelte-oh1jm" role="listitem"><!> <div class="chat-input__attachment-info svelte-oh1jm"><span class="chat-input__attachment-name svelte-oh1jm"> </span> <span class="chat-input__attachment-size svelte-oh1jm"> </span></div> <button type="button" class="chat-input__attachment-remove svelte-oh1jm"><!></button></div>'),qa=m('<div class="chat-input__attachments svelte-oh1jm" role="list" aria-label="Attached files"></div>'),Fa=m('<input type="file" class="chat-input__file-input svelte-oh1jm" aria-hidden="true" tabindex="-1"/> <!>',1),Ua=m('<div id="chat-input-char-count" aria-live="polite"> </div>'),Ka=m('<div role="region" aria-label="Message composer"><!> <!> <div class="chat-input__container svelte-oh1jm"><!> <div class="chat-input__textarea-wrapper gr-autosize-textarea svelte-oh1jm"><textarea aria-label="Message input"></textarea></div> <!></div> <!></div>');function Oa(N,t){Re(t,!0);let n=k(t,"value",15,""),S=k(t,"placeholder",3,"Type a message..."),r=k(t,"disabled",3,!1),h=k(t,"showFileUpload",3,!1),g=k(t,"acceptedFileTypes",3,"image/*,.pdf,.txt,.md"),c=k(t,"maxFiles",3,4),Y=k(t,"maxFileSize",3,10*1024*1024),X=k(t,"class",3,""),F=re(void 0),ae=re(void 0),U=re(Ve([])),y=re(!1),J=re(!1),T=0;const j=C(()=>n().length),L=C(()=>t.maxLength?e(j)>t.maxLength:!1),se=C(()=>t.maxLength?e(j)>=t.maxLength*.9:!1),ie=C(()=>!r()&&!e(J)&&(n().trim().length>0||e(U).length>0)&&!e(L)),ee=C(()=>e(U).length>0),x=C(()=>e(U).length<c());function H(i){const I=i.target;n(I.value)}function ne(i){if(i.key==="Enter"&&!i.shiftKey){i.preventDefault(),e(ie)&&le();return}if(i.key==="Escape"){i.preventDefault(),V();return}}async function M(i){if(!h())return;const I=i.clipboardData?.items;if(!I)return;const z=[];for(const O of I)O.type.startsWith("image/")&&z.push(O);if(z.length>0){i.preventDefault();for(const O of z){const _e=O.getAsFile();_e&&e(x)&&await B(_e)}}}async function le(){if(!e(ie))return;const i=n().trim(),I=e(U).map(z=>z.file);_(J,!0);try{await t.onSend(i,I.length>0?I:void 0),n(""),f()}finally{_(J,!1)}}function V(){n(""),f(),e(F)?.focus()}function f(){for(const i of e(U))i.preview&&URL.revokeObjectURL(i.preview);_(U,[],!0)}function p(){return T+=1,`file_${Date.now()}_${T}`}async function B(i){if(i.size>Y())return console.warn(`File ${i.name} exceeds maximum size of ${Y()} bytes`),!1;if(!e(x))return console.warn(`Maximum of ${c()} files allowed`),!1;const I=i.type.startsWith("image/"),z={id:p(),file:i,type:I?"image":"file",preview:I?URL.createObjectURL(i):void 0};return _(U,[...e(U),z],!0),!0}function P(i){const I=e(U).find(z=>z.id===i);I?.preview&&URL.revokeObjectURL(I.preview),_(U,e(U).filter(z=>z.id!==i),!0)}async function d(i){const I=i.target,z=I.files;if(z){for(const O of z)e(x)&&await B(O);I.value=""}}function R(){e(ae)?.click()}function E(i){h()&&(i.preventDefault(),_(y,!0))}function Q(i){i.preventDefault();const I=i.relatedTarget;(!i.currentTarget||!i.currentTarget.contains(I))&&_(y,!1)}function ge(i){h()&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="copy"))}async function v(i){if(!h())return;i.preventDefault(),_(y,!1);const I=i.dataTransfer?.files;if(I)for(const z of I)e(x)&&await B(z)}function b(i){return i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}ze(()=>()=>{for(const i of e(U))i.preview&&URL.revokeObjectURL(i.preview)});var w=Ka();let te;var K=s(w);{var Z=i=>{var I=ja(),z=s(I),O=s(z);Zt(O,{size:32}),Ce(2),a(z),a(I),l(i,I)};D(K,i=>{e(y)&&i(Z)})}var u=o(K,2);{var A=i=>{var I=qa();Ye(I,21,()=>e(U),z=>z.id,(z,O)=>{var _e=Ra(),Ae=s(_e);{var Fe=De=>{var Ee=Ea();G(()=>{ve(Ee,"src",e(O).preview),ve(Ee,"alt",e(O).file.name)}),l(De,Ee)},Xe=De=>{var Ee=La(),nt=s(Ee);pt(nt,{size:16}),a(Ee),l(De,Ee)};D(Ae,De=>{e(O).type==="image"&&e(O).preview?De(Fe):De(Xe,!1)})}var je=o(Ae,2),pe=s(je),fe=s(pe,!0);a(pe);var Ie=o(pe,2),Qe=s(Ie,!0);a(Ie),a(je);var Ge=o(je,2),et=s(Ge);ta(et,{size:14}),a(Ge),a(_e),G(De=>{ve(pe,"title",e(O).file.name),$(fe,e(O).file.name),$(Qe,De),ve(Ge,"aria-label",`Remove ${e(O).file.name}`)},[()=>b(e(O).file.size)]),Te("click",Ge,()=>P(e(O).id)),l(z,_e)}),a(I),l(i,I)};D(u,i=>{e(ee)&&i(A)})}var q=o(u,2),oe=s(q);{var he=i=>{var I=Fa(),z=ue(I);Je(z,_e=>_(ae,_e),()=>e(ae));var O=o(z,2);{let _e=C(()=>r()||!e(x));Me(O,{variant:"ghost",size:"sm",onclick:R,get disabled(){return e(_e)},class:"chat-input__upload-button","aria-label":"Attach file",children:(Ae,Fe)=>{pt(Ae,{size:20})},$$slots:{default:!0}})}G(()=>{ve(z,"accept",g()),z.multiple=c()>1}),Te("change",z,d),l(i,I)};D(oe,i=>{h()&&i(he)})}var ce=o(oe,2),W=s(ce);jt(W),ve(W,"rows",1);let we;Je(W,i=>_(F,i),()=>e(F)),a(ce);var me=o(ce,2);{let i=C(()=>!e(ie));Me(me,{variant:"solid",size:"sm",onclick:le,get disabled(){return e(i)},get loading(){return e(J)},class:"chat-input__send-button","aria-label":"Send message",children:(I,z)=>{ea(I,{size:20})},$$slots:{default:!0}})}a(q);var Pe=o(q,2);{var Ne=i=>{var I=Ua();let z;var O=s(I);a(I),G(()=>{z=Se(I,1,"chat-input__char-count svelte-oh1jm",null,z,{"chat-input__char-count--warning":e(se)&&!e(L),"chat-input__char-count--error":e(L)}),$(O,`${e(j)??""}/${t.maxLength??""}`)}),l(i,I)};D(Pe,i=>{t.maxLength&&i(Ne)})}a(w),G(i=>{te=Se(w,1,i,"svelte-oh1jm",te,{"chat-input--disabled":r(),"chat-input--dragging":e(y)}),ve(ce,"data-gr-value",`${n()}
`),ve(W,"placeholder",S()),W.disabled=r(),ve(W,"maxlength",t.maxLength),we=Se(W,1,"chat-input__textarea svelte-oh1jm",null,we,{"chat-input__textarea--error":e(L)}),ve(W,"aria-describedby",t.maxLength?"chat-input-char-count":void 0),ve(W,"aria-invalid",e(L)||void 0)},[()=>We(`chat-input ${X()}`.trim())]),Ke("dragenter",w,E),Ke("dragleave",w,Q),Ke("dragover",w,ge),Ke("drop",w,v),Te("input",W,H),Te("keydown",W,ne),Ke("paste",W,M),Ft(W,n),l(N,w),qe()}He(["click","change","input","keydown"]);var Na=m('<span class="chat-tool-call__toggle svelte-171uxw4" aria-hidden="true"><!></span>'),Ha=m('<span class="chat-tool-call__status-icon chat-tool-call__status-icon--pending svelte-171uxw4"><!></span>'),Wa=m('<span class="chat-tool-call__status-icon chat-tool-call__status-icon--running svelte-171uxw4"><!></span>'),Ga=m('<span class="chat-tool-call__status-icon chat-tool-call__status-icon--complete svelte-171uxw4"><!></span>'),Va=m('<span class="chat-tool-call__status-icon chat-tool-call__status-icon--error svelte-171uxw4"><!></span>'),Ya=m('<div class="chat-tool-call__section svelte-171uxw4"><span class="chat-tool-call__section-label svelte-171uxw4">Arguments</span> <div class="chat-tool-call__code-wrapper svelte-171uxw4"><!></div></div>'),Ja=m('<div class="chat-tool-call__error svelte-171uxw4"> </div>'),Xa=m('<div class="chat-tool-call__code-wrapper svelte-171uxw4"><!></div>'),Qa=m('<div class="chat-tool-call__result-text svelte-171uxw4"> </div>'),Za=m('<button class="chat-tool-call__show-more svelte-171uxw4" type="button"> </button>'),$a=m('<div class="chat-tool-call__result-wrapper"><!> <!></div>'),es=m('<div class="chat-tool-call__section svelte-171uxw4"><span class="chat-tool-call__section-label svelte-171uxw4"> </span> <!></div>'),ts=m('<div class="chat-tool-call__content svelte-171uxw4"><!> <!></div>'),as=m('<button class="chat-tool-call__header svelte-171uxw4" type="button"><!> <span class="chat-tool-call__tool-info svelte-171uxw4"><span class="chat-tool-call__icon svelte-171uxw4" aria-hidden="true"><!></span> <!></span> <span class="chat-tool-call__status svelte-171uxw4"><!></span></button> <!>',1),ss=m("<div><!></div>");function at(N,t){Re(t,!0);let n=k(t,"showResult",3,!0),S=k(t,"collapsible",3,!0),r=k(t,"defaultCollapsed",3,!0),h=k(t,"class",3,""),g=re(Ve(st(()=>!r()))),c=re(!1);const Y=300,X={query_knowledge:Ht,search:$t,read_file:Nt,list_files:wt,file_search:wt,code_search:xt,grep:xt},F=C(()=>X[t.toolCall.tool]||zt),ae=C(()=>t.toolCall.tool.split("_").map(M=>M.charAt(0).toUpperCase()+M.slice(1)).join(" ")),U=C(()=>t.toolCall.args?JSON.stringify(t.toolCall.args,null,2):null),y=C(()=>t.toolCall.result?typeof t.toolCall.result=="string"?t.toolCall.result:JSON.stringify(t.toolCall.result,null,2):null),J=C(()=>e(y)&&e(y).length>Y),T=C(()=>e(y)?!e(J)||e(c)?e(y):e(y).slice(0,Y)+"...":null),j=C(()=>{if(!e(y))return!1;const M=e(y).trim();return M.startsWith("{")&&M.endsWith("}")||M.startsWith("[")&&M.endsWith("]")}),L=C(()=>e(y)?e(y).includes("function ")||e(y).includes("const ")||e(y).includes("import ")||e(y).includes("export ")||e(y).includes("class ")||e(y).includes("def ")||e(y).includes("```"):!1),se=C(()=>e(j)?"json":e(L)?"typescript":"text"),ie=C(()=>["chat-tool-call",`chat-tool-call--${t.toolCall.status}`,S()&&"chat-tool-call--collapsible",e(g)&&"chat-tool-call--expanded",h()].filter(Boolean).join(" "));function ee(){S()&&_(g,!e(g))}function x(M){S()&&(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),_(g,!e(g)))}var H=ss(),ne=s(H);sa(ne,{variant:"outlined",padding:"sm",children:(M,le)=>{var V=as(),f=ue(V),p=s(f);{var B=u=>{var A=Na(),q=s(A);{var oe=ce=>{aa(ce,{size:14})},he=ce=>{Yt(ce,{size:14})};D(q,ce=>{e(g)?ce(oe):ce(he,!1)})}a(A),l(u,A)};D(p,u=>{S()&&u(B)})}var P=o(p,2),d=s(P),R=s(d);xe(R,()=>e(F),(u,A)=>{A(u,{size:14})}),a(d);var E=o(d,2);na(E,{variant:"filled",color:"gray",get label(){return e(ae)}}),a(P);var Q=o(P,2),ge=s(Q);{var v=u=>{var A=Ha(),q=s(A);Wt(q,{size:14}),a(A),l(u,A)},b=u=>{var A=Wa(),q=s(A);kt(q,{size:14}),a(A),l(u,A)},w=u=>{var A=Ga(),q=s(A);Gt(q,{size:14}),a(A),l(u,A)},te=u=>{var A=Va(),q=s(A);Vt(q,{size:14}),a(A),l(u,A)};D(ge,u=>{t.toolCall.status==="pending"?u(v):t.toolCall.status==="running"?u(b,1):t.toolCall.status==="complete"?u(w,2):t.toolCall.status==="error"&&u(te,3)})}a(Q),a(f);var K=o(f,2);{var Z=u=>{var A=ts(),q=s(A);{var oe=W=>{var we=Ya(),me=o(s(we),2),Pe=s(me);bt(Pe,{get code(){return e(U)},language:"json",showCopy:!1,showLineNumbers:!1}),a(me),a(we),l(W,we)};D(q,W=>{e(U)&&W(oe)})}var he=o(q,2);{var ce=W=>{var we=es(),me=s(we),Pe=s(me,!0);a(me);var Ne=o(me,2);{var i=z=>{var O=Ja(),_e=s(O,!0);a(O),G(()=>$(_e,t.toolCall.error)),l(z,O)},I=z=>{var O=$a(),_e=s(O);{var Ae=pe=>{var fe=Xa(),Ie=s(fe);bt(Ie,{get code(){return e(T)},get language(){return e(se)},showCopy:!1,showLineNumbers:!1}),a(fe),l(pe,fe)},Fe=pe=>{var fe=Qa(),Ie=s(fe,!0);a(fe),G(()=>$(Ie,e(T))),l(pe,fe)};D(_e,pe=>{e(j)||e(L)?pe(Ae):pe(Fe,!1)})}var Xe=o(_e,2);{var je=pe=>{var fe=Za(),Ie=s(fe,!0);a(fe),G(()=>$(Ie,e(c)?"Show less":"Show more")),Te("click",fe,()=>_(c,!e(c))),l(pe,fe)};D(Xe,pe=>{e(J)&&pe(je)})}a(O),l(z,O)};D(Ne,z=>{t.toolCall.error?z(i):e(T)&&z(I,1)})}a(we),G(()=>$(Pe,t.toolCall.error?"Error":"Result")),l(W,we)};D(he,W=>{n()&&(e(y)||t.toolCall.error)&&W(ce)})}a(A),G(()=>ve(A,"id",S()?`tool-call-content-${t.toolCall.id}`:void 0)),l(u,A)};D(K,u=>{(!S()||e(g))&&u(Z)})}G(()=>{ve(f,"aria-expanded",S()?e(g):void 0),ve(f,"aria-controls",S()?`tool-call-content-${t.toolCall.id}`:void 0),f.disabled=!S(),ve(Q,"aria-label",`Status: ${t.toolCall.status}`)}),Te("click",f,ee),Te("keydown",f,x),l(M,V)},$$slots:{default:!0}}),a(H),G(()=>Se(H,1,We(e(ie)),"svelte-171uxw4")),l(N,H),qe()}He(["click","keydown"]);He(["click"]);var ns=m('<p class="chat-header__subtitle svelte-1ajzqvp"> </p>'),os=m('<div role="status"><span class="chat-header__status-dot svelte-1ajzqvp" aria-hidden="true"></span></div>'),rs=m('<header role="banner" aria-label="Chat header"><div class="chat-header__left svelte-1ajzqvp"><div class="chat-header__title-group svelte-1ajzqvp"><h1 class="chat-header__title svelte-1ajzqvp"> </h1> <!></div> <!></div> <div class="chat-header__right svelte-1ajzqvp"><!> <!> <!></div></header>');function ls(N,t){Re(t,!0);function n(f){switch(f){case"disconnected":return"Disconnected";case"connecting":return"Connecting...";case"connected":return"Connected";default:return"Unknown"}}let S=k(t,"title",3,"Chat"),r=k(t,"showClearButton",3,!0),h=k(t,"showSettingsButton",3,!1),g=k(t,"class",3,"");function c(){t.onClear?.()}function Y(){t.onSettings?.()}const X=C(()=>["chat-header",t.connectionStatus&&`chat-header--${t.connectionStatus}`,g()].filter(Boolean).join(" ")),F=C(()=>t.connectionStatus?n(t.connectionStatus):"");var ae=rs(),U=s(ae),y=s(U),J=s(y),T=s(J,!0);a(J);var j=o(J,2);{var L=f=>{var p=ns(),B=s(p,!0);a(p),G(()=>$(B,t.subtitle)),l(f,p)};D(j,f=>{t.subtitle&&f(L)})}a(y);var se=o(y,2);{var ie=f=>{rt(f,{get content(){return e(F)},placement:"bottom",children:(p,B)=>{var P=os();let d;G(()=>{d=Se(P,1,"chat-header__status svelte-1ajzqvp",null,d,{"chat-header__status--connected":t.connectionStatus==="connected","chat-header__status--connecting":t.connectionStatus==="connecting","chat-header__status--disconnected":t.connectionStatus==="disconnected"}),ve(P,"aria-label",e(F))}),l(p,P)},$$slots:{default:!0}})};D(se,f=>{t.connectionStatus&&f(ie)})}a(U);var ee=o(U,2),x=s(ee);{var H=f=>{var p=ye(),B=ue(p);Oe(B,()=>t.actions),l(f,p)};D(x,f=>{t.actions&&f(H)})}var ne=o(x,2);{var M=f=>{rt(f,{content:"Clear conversation",placement:"bottom",children:(p,B)=>{Me(p,{variant:"ghost",size:"sm",onclick:c,"aria-label":"Clear conversation",prefix:d=>{Jt(d,{size:18})},$$slots:{prefix:!0}})},$$slots:{default:!0}})};D(ne,f=>{r()&&f(M)})}var le=o(ne,2);{var V=f=>{rt(f,{content:"Settings",placement:"bottom",children:(p,B)=>{Me(p,{variant:"ghost",size:"sm",onclick:Y,"aria-label":"Open settings",prefix:d=>{zt(d,{size:18})},$$slots:{prefix:!0}})},$$slots:{default:!0}})};D(le,f=>{h()&&f(V)})}a(ee),a(ae),G(()=>{Se(ae,1,We(e(X)),"svelte-1ajzqvp"),$(T,S())}),l(N,ae),qe()}var is=m('<span class="chat-suggestions__description svelte-1h67vbf"> </span>'),cs=m('<button type="button" class="chat-suggestions__item svelte-1h67vbf"><span class="chat-suggestions__text svelte-1h67vbf"> </span> <!></button>'),ds=m('<div role="group" aria-label="Suggested prompts"></div>');function lt(N,t){Re(t,!0);let n=k(t,"variant",3,"pills"),S=k(t,"placement",3,"empty-only"),r=k(t,"class",3,"");const g=da()?Tt():null,c=C(()=>g?.state.messages.length??0),Y=C(()=>{switch(S()){case"empty-only":return e(c)===0;case"inline":case"bottom":return!0;default:return e(c)===0}});function X(j){return typeof j=="string"?{text:j}:j}function F(j){t.onSelect(j.text)}function ae(j,L){(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),t.onSelect(L.text))}const U=C(()=>["chat-suggestions",`chat-suggestions--${n()}`,`chat-suggestions--${S()}`,r()].filter(Boolean).join(" "));var y=ye(),J=ue(y);{var T=j=>{var L=ds();Ye(L,21,()=>t.suggestions,se=>typeof se=="string"?se:se.text,(se,ie)=>{const ee=C(()=>X(e(ie)));var x=cs();ve(x,"tabindex",0);var H=s(x),ne=s(H,!0);a(H);var M=o(H,2);{var le=V=>{var f=is(),p=s(f,!0);a(f),G(()=>$(p,e(ee).description)),l(V,f)};D(M,V=>{n()==="cards"&&e(ee).description&&V(le)})}a(x),G(()=>{ve(x,"aria-label",`Suggestion: ${e(ee).text}`),$(ne,e(ee).text)}),Te("click",x,()=>F(e(ee))),Te("keydown",x,V=>ae(V,e(ee))),l(se,x)}),a(L),G(()=>Se(L,1,We(e(U)),"svelte-1h67vbf")),l(j,L)};D(J,j=>{e(Y)&&j(T)})}l(N,y),qe()}He(["click","keydown"]);var vs=m('<div class="chat-settings__footer svelte-1qu40vt"><!> <!></div>'),us=m('<div class="chat-settings__kb-item svelte-1qu40vt"><!> <!></div>'),hs=m('<div class="chat-settings__group svelte-1qu40vt"><span class="chat-settings__label svelte-1qu40vt">Knowledge Bases</span> <!> <div class="chat-settings__kb-list svelte-1qu40vt"></div></div>'),gs=m('<div class="chat-settings__content svelte-1qu40vt"><div class="chat-settings__group svelte-1qu40vt"><!> <!></div> <div class="chat-settings__group svelte-1qu40vt"><label class="chat-settings__label svelte-1qu40vt" for="chat-settings-temperature"> </label> <input id="chat-settings-temperature" type="range" min="0" max="2" step="0.1" class="chat-settings__slider svelte-1qu40vt" aria-describedby="chat-settings-temperature-help"/> <div class="chat-settings__slider-labels svelte-1qu40vt"><span>Precise (0)</span> <span>Creative (2)</span></div> <!></div> <div class="chat-settings__group svelte-1qu40vt"><!> <!></div> <!></div>');function ms(N,t){Re(t,!0);const n=[{id:"gpt-4",name:"GPT-4"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo"},{id:"claude-3",name:"Claude 3"}];let S=k(t,"open",15,!1),r=k(t,"availableModels",3,n),h=k(t,"availableKnowledgeBases",19,()=>[]),g=k(t,"class",3,""),c=re(Ve(st(()=>({...t.settings}))));ze(()=>{_(c,{...t.settings},!0)});const Y=C(()=>r().map(x=>({label:x.name,value:x.id}))),X=C(()=>e(c).temperature?.toFixed(1)??"0.7");function F(x){return e(c).knowledgeBases?.includes(x)??!1}function ae(x){_(c,{...e(c),model:x},!0),T()}function U(x){const H=x.target,ne=parseFloat(H.value);_(c,{...e(c),temperature:ne},!0),T()}function y(x){const H=parseInt(x,10);!isNaN(H)&&H>0&&(_(c,{...e(c),maxTokens:H},!0),T())}function J(x,H){const ne=e(c).knowledgeBases??[];let M;H?M=[...ne,x]:M=ne.filter(le=>le!==x),_(c,{...e(c),knowledgeBases:M},!0),T()}function T(){t.onSettingsChange?.(e(c)),t.onChange?.(e(c))}function j(){t.onSave?.(e(c)),L()}function L(){_(c,{...t.settings},!0),S(!1),t.onClose?.()}var se=ye(),ie=ue(se);{var ee=x=>{{const H=M=>{var le=vs(),V=s(le);Me(V,{variant:"ghost",onclick:L,children:(p,B)=>{Ce();var P=Be("Cancel");l(p,P)},$$slots:{default:!0}});var f=o(V,2);Me(f,{variant:"solid",onclick:j,children:(p,B)=>{Ce();var P=Be("Save Settings");l(p,P)},$$slots:{default:!0}}),a(le),l(M,le)};let ne=C(()=>`chat-settings ${g()}`.trim());Ut(x,{title:"Chat Settings",size:"md",closable:!0,get class(){return e(ne)},get open(){return S()},set open(M){S(M)},footer:H,children:(M,le)=>{var V=gs(),f=s(V),p=s(f);{let K=C(()=>e(c).model??"");Kt(p,{get value(){return e(K)},get options(){return e(Y)},label:"Model",placeholder:"Select a model",onchange:ae})}var B=o(p,2);Ze(B,{size:"sm",color:"secondary",class:"chat-settings__helper",children:(K,Z)=>{Ce();var u=Be("Choose the AI model for generating responses.");l(K,u)},$$slots:{default:!0}}),a(f);var P=o(f,2),d=s(P),R=s(d);a(d);var E=o(d,2);Et(E);var Q=o(E,4);Ze(Q,{size:"sm",color:"secondary",id:"chat-settings-temperature-help",class:"chat-settings__helper",children:(K,Z)=>{Ce();var u=Be(`Lower values produce more focused and deterministic responses. Higher values increase
					creativity and randomness.`);l(K,u)},$$slots:{default:!0}}),a(P);var ge=o(P,2),v=s(ge);{let K=C(()=>String(e(c).maxTokens??4096));oa(v,{label:"Max Tokens",get value(){return e(K)},type:"text",placeholder:"4096",oninput:Z=>y(Z.target.value)})}var b=o(v,2);Ze(b,{size:"sm",color:"secondary",class:"chat-settings__helper",children:(K,Z)=>{Ce();var u=Be("Maximum number of tokens in the response. Higher values allow longer responses.");l(K,u)},$$slots:{default:!0}}),a(ge);var w=o(ge,2);{var te=K=>{var Z=hs(),u=o(s(Z),2);Ze(u,{size:"sm",color:"secondary",class:"chat-settings__helper",children:(q,oe)=>{Ce();var he=Be("Enable knowledge bases to provide context for responses.");l(q,he)},$$slots:{default:!0}});var A=o(u,2);Ye(A,21,h,q=>q.id,(q,oe)=>{var he=us(),ce=s(he);{let me=C(()=>F(e(oe).id));ra(ce,{get checked(){return e(me)},onchange:()=>J(e(oe).id,!F(e(oe).id)),get label(){return e(oe).name}})}var W=o(ce,2);{var we=me=>{Ze(me,{size:"xs",color:"secondary",class:"chat-settings__kb-description",children:(Pe,Ne)=>{Ce();var i=Be();G(()=>$(i,e(oe).description)),l(Pe,i)},$$slots:{default:!0}})};D(W,me=>{e(oe).description&&me(we)})}a(he),l(q,he)}),a(A),a(Z),l(K,Z)};D(w,K=>{h().length>0&&K(te)})}a(V),G(()=>{$(R,`Temperature: ${e(X)??""}`),Lt(E,e(c).temperature??.7)}),Te("input",E,U),l(M,V)},$$slots:{footer:!0,default:!0}})}};D(ie,x=>{S()&&x(ee)})}l(N,se),qe()}He(["input"]);var _s=m("<!> <!>",1),fs=m("<!> <!> <!> <!>",1),ps=m('<li class="svelte-23dtxz"> </li>'),ws=m(`<section class="chat-section svelte-23dtxz"><header><p class="section-eyebrow svelte-23dtxz">01 · Full Chat Interface</p> <h2 class="svelte-23dtxz">Complete chat experience with all components</h2> <p>The chat interface combines <code>Chat.Container</code>, <code>Chat.Header</code>, <code>Chat.Messages</code>, <code>Chat.Suggestions</code>, and <code>Chat.Input</code> to create a full conversational UI. Try sending a message to see the simulated streaming response.</p></header> <div class="chat-demo-container svelte-23dtxz"><!></div> <!></section> <section class="chat-section svelte-23dtxz"><header><p class="section-eyebrow svelte-23dtxz">02 · Quick Suggestions</p> <h2 class="svelte-23dtxz">Prompt suggestions for empty state</h2> <p><code>Chat.Suggestions</code> displays clickable prompts to help users get started. Supports
				both <code>pills</code> (horizontal) and <code>cards</code> (grid) variants.</p></header> <div class="suggestions-demo svelte-23dtxz"><div class="suggestions-variant svelte-23dtxz"><h3 class="svelte-23dtxz">Pills Variant (default)</h3> <!></div> <div class="suggestions-variant svelte-23dtxz"><h3 class="svelte-23dtxz">Cards Variant</h3> <!></div></div> <!></section> <section class="chat-section svelte-23dtxz"><header><p class="section-eyebrow svelte-23dtxz">03 · Tool Call Display</p> <h2 class="svelte-23dtxz">AI tool invocations with status indicators</h2> <p><code>Chat.ToolCallDisplay</code> displays tool/function calls during AI responses with collapsible
				results, status indicators, and syntax-highlighted arguments.</p></header> <div class="tool-calls-demo svelte-23dtxz"><div class="tool-call-item svelte-23dtxz"><h3 class="svelte-23dtxz">Pending</h3> <!></div> <div class="tool-call-item svelte-23dtxz"><h3 class="svelte-23dtxz">Running</h3> <!></div> <div class="tool-call-item svelte-23dtxz"><h3 class="svelte-23dtxz">Complete</h3> <!></div> <div class="tool-call-item svelte-23dtxz"><h3 class="svelte-23dtxz">Error</h3> <!></div></div> <!></section> <section class="chat-section svelte-23dtxz"><header><p class="section-eyebrow svelte-23dtxz">04 · Settings Configuration</p> <h2 class="svelte-23dtxz">Chat settings modal with model selection</h2> <p><code>Chat.Settings</code> provides a configuration modal for model selection, temperature, max
				tokens, system prompt, and knowledge base toggles.</p></header> <div class="settings-demo svelte-23dtxz"><div class="settings-preview svelte-23dtxz"><h3 class="svelte-23dtxz">Current Settings</h3> <dl class="settings-list svelte-23dtxz"><dt class="svelte-23dtxz">Model</dt> <dd class="svelte-23dtxz"> </dd> <dt class="svelte-23dtxz">Temperature</dt> <dd class="svelte-23dtxz"> </dd> <dt class="svelte-23dtxz">Max Tokens</dt> <dd class="svelte-23dtxz"> </dd> <dt class="svelte-23dtxz">Streaming</dt> <dd class="svelte-23dtxz"> </dd> <dt class="svelte-23dtxz">Knowledge Bases</dt> <dd class="svelte-23dtxz"> </dd></dl> <!></div></div> <!></section> <section class="chat-section svelte-23dtxz"><header><p class="section-eyebrow svelte-23dtxz">05 · Accessibility</p> <h2 class="svelte-23dtxz">ARIA roles + keyboard navigation</h2></header> <ul class="guidance-list svelte-23dtxz"></ul></section>`,1),bs=m("<!> <!>",1);function Ws(N,t){Re(t,!0);const n=[{id:"tc_1",tool:"query_knowledge",args:{query:"PAI documentation",knowledgeBase:"paytheory"},result:{found:3,snippets:["PAI is an AI-powered assistant...","Scopes define context..."]},status:"complete"},{id:"tc_2",tool:"search_files",args:{pattern:"*.svelte",path:"src/routes"},status:"running"}],S=[{id:"msg_1",role:"user",content:"What is PAI?",timestamp:new Date(Date.now()-3e5),status:"complete"},{id:"msg_2",role:"assistant",content:`**PAI** (Penny AI) is an AI-powered development assistant designed to help you build applications faster.

Key features include:
- **Knowledge Base Integration**: Query documentation and code examples
- **Scope Management**: Define context for focused assistance
- **Tool Execution**: Run commands and search files directly
- **Streaming Responses**: Real-time response generation

Would you like me to show you how to create a scope?`,timestamp:new Date(Date.now()-24e4),status:"complete",toolCalls:[n[0]]},{id:"msg_3",role:"user",content:"Yes, show me how to create a scope with file search.",timestamp:new Date(Date.now()-18e4),status:"complete"},{id:"msg_4",role:"assistant",content:`Here's how to create a scope with file search capabilities:

\`\`\`typescript
const scope = createScope({
  name: 'my-project',
  include: ['src/**/*.ts', 'src/**/*.svelte'],
  exclude: ['node_modules', 'dist'],
  knowledgeBases: ['paytheory', 'svelte-docs'],
});
\`\`\`

I'm currently searching for relevant files in your project...`,timestamp:new Date(Date.now()-12e4),status:"complete",toolCalls:[n[1]]}];let r=re(Ve([...S])),h=re(!1),g=re(""),c=re("connected"),Y=re(!1),X=re(!1),F=re(Ve({model:"gpt-4",temperature:.7,maxTokens:4096,streaming:!0,systemPrompt:"You are PAI, a helpful AI development assistant.",knowledgeBases:["paytheory","svelte-docs"]}));const ae=[{id:"gpt-4",name:"GPT-4"},{id:"gpt-4-turbo",name:"GPT-4 Turbo"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo"},{id:"claude-3-opus",name:"Claude 3 Opus"},{id:"claude-3-sonnet",name:"Claude 3 Sonnet"}],U=[{id:"paytheory",name:"Pay Theory",description:"Payment processing documentation"},{id:"svelte-docs",name:"Svelte Docs",description:"Svelte framework documentation"},{id:"typescript",name:"TypeScript",description:"TypeScript language reference"}],y=["What is PAI?","How do I create a scope?","Show me an example workflow","What knowledgebases are available?"],J=[`Great question! Here's a quick overview of the available knowledge bases:

1. **Pay Theory** - Payment processing APIs and integration guides
2. **Svelte Docs** - Component patterns and reactivity
3. **TypeScript** - Type system and language features

Each knowledge base can be enabled in settings to provide contextual assistance.`,`To create a new workflow, you can use the following pattern:

\`\`\`typescript
import { createWorkflow } from '@pai/core';

const workflow = createWorkflow({
  name: 'code-review',
  steps: [
    { action: 'analyze', target: 'src/**/*.ts' },
    { action: 'suggest', type: 'improvements' },
    { action: 'generate', output: 'report.md' },
  ],
});

await workflow.execute();
\`\`\`

This will analyze your TypeScript files and generate improvement suggestions.`];async function T(B){_(h,!0),_(g,""),_(c,"connected");const P={id:`msg_${Date.now()}`,role:"assistant",content:"",timestamp:new Date,status:"streaming"};_(r,[...e(r),P],!0);const d=B.split("");for(let R=0;R<d.length;R++)await new Promise(E=>setTimeout(E,15+Math.random()*25)),_(g,e(g)+d[R]),_(r,e(r).map(E=>E.id===P.id?{...E,content:e(g)}:E),!0);_(r,e(r).map(R=>R.id===P.id?{...R,status:"complete"}:R),!0),_(h,!1),_(g,"")}const j={onSubmit:async B=>{const P={id:`msg_${Date.now()}`,role:"user",content:B,timestamp:new Date,status:"complete"};_(r,[...e(r),P],!0);const d=Math.floor(Math.random()*J.length);await T(J[d])},onClear:()=>{_(r,[],!0),_(g,""),_(h,!1)},onSettingsChange:B=>{_(F,B,!0)},onStopStreaming:()=>{_(h,!1)}};function L(B){j.onSubmit?.(B)}function se(){j.onClear?.()}function ie(){_(X,!e(X)),e(X)?_(r,[],!0):_(r,[...S],!0)}function ee(){const B={id:`msg_${Date.now()}`,role:"assistant",content:"Let me search for that information...",timestamp:new Date,status:"complete",toolCalls:[{id:`tc_${Date.now()}_1`,tool:"query_knowledge",args:{query:"component patterns",limit:5},status:"pending"},{id:`tc_${Date.now()}_2`,tool:"read_file",args:{path:"src/lib/components/Button.svelte"},status:"running"},{id:`tc_${Date.now()}_3`,tool:"search_files",args:{pattern:"*.test.ts"},result:{files:["Button.test.ts","Modal.test.ts"],count:2},status:"complete"}]};_(r,[...e(r),B],!0)}const x=`
<script>
  import * as Chat from '@equaltoai/greater-components-chat';

  const handlers = {
    onSubmit: async (content) => {
      // Send message to your AI backend
      const response = await fetch('/api/chat', {
        method: 'POST',
        body: JSON.stringify({ message: content }),
      });
      return response.json();
    },
  };
<\/script>

<Chat.Container {handlers}>
  <Chat.Header title="AI Assistant" connectionStatus="connected" />
  <Chat.Messages />
  <Chat.Input onSend={(content) => handlers.onSubmit(content)} />
</Chat.Container>`,H=`
<Chat.Container {handlers}>
  <Chat.Header title="PAI Demo" />
  <Chat.Messages />
  {#if messages.length === 0}
    <Chat.Suggestions
      suggestions={[
        "What is PAI?",
        "How do I create a scope?",
        "Show me an example workflow"
      ]}
      onSelect={(suggestion) => handlers.onSubmit(suggestion)}
    />
  {/if}
  <Chat.Input onSend={(content) => handlers.onSubmit(content)} />
</Chat.Container>`,ne=`
<script>
  import * as Chat from '@equaltoai/greater-components-chat';
  
  let showSettings = $state(false);
  let settings = $state({
    model: 'gpt-4',
    temperature: 0.7,
    streaming: true,
  });
<\/script>

<Chat.Container {handlers}>
  <Chat.Header
    title="PAI Demo"
    showSettingsButton={true}
    onSettings={() => showSettings = true}
  />
  <Chat.Messages />
  <Chat.Input onSend={(content) => handlers.onSubmit(content)} />
</Chat.Container>

<Chat.Settings
  bind:open={showSettings}
  {settings}
  availableModels={[
    { id: 'gpt-4', name: 'GPT-4' },
    { id: 'claude-3', name: 'Claude 3' },
  ]}
  onSettingsChange={(s) => settings = s}
/>`,M=`
<!-- Tool calls are displayed within assistant messages -->
<Chat.Message
  message={{
    id: '1',
    role: 'assistant',
    content: 'Searching for information...',
    timestamp: new Date(),
    status: 'complete',
    toolCalls: [
      {
        id: 'tc_1',
        tool: 'query_knowledge',
        args: { query: 'search term' },
        status: 'running',
      },
      {
        id: 'tc_2',
        tool: 'read_file',
        args: { path: 'src/index.ts' },
        result: { content: '...' },
        status: 'complete',
      },
    ],
  }}
/>

<!-- Or use Chat.ToolCallDisplay directly -->
<Chat.ToolCallDisplay
  toolCall={{
    id: 'tc_1',
    tool: 'search_files',
    args: { pattern: '*.svelte' },
    result: { files: ['Button.svelte'] },
    status: 'complete',
  }}
  showResult={true}
  collapsible={true}
/>`,le=['The chat container uses `role="region"` with `aria-label="Chat conversation"` for screen reader navigation.','Messages are announced via `aria-live="polite"` to notify users of new content.',"Keyboard shortcuts: Enter to send, Shift+Enter for newline, Escape to cancel streaming.","Connection status is conveyed via both visual indicators and `aria-label` attributes.","Tool call status changes are announced to assistive technologies."];var V=bs(),f=ue(V);Rt(f,{eyebrow:"AI Interface",title:"Chat Components",description:"AI chat interface components for building conversational UIs with streaming responses, tool calls, and configurable settings.",actions:P=>{var d=_s(),R=ue(d);Me(R,{variant:"outline",size:"sm",onclick:ie,children:(Q,ge)=>{Ce();var v=Be();G(()=>$(v,e(X)?"Show Messages":"Show Empty State")),l(Q,v)},$$slots:{default:!0}});var E=o(R,2);Me(E,{variant:"outline",size:"sm",onclick:ee,children:(Q,ge)=>{Ce();var v=Be("Add Tool Call Demo");l(Q,v)},$$slots:{default:!0}}),l(P,d)},children:(P,d)=>{var R=ws(),E=ue(R),Q=o(s(E),2),ge=s(Q);xe(ge,()=>_a,(de,be)=>{be(de,{get handlers(){return j},get messages(){return e(r)},get streaming(){return e(h)},get streamContent(){return e(g)},get connectionStatus(){return e(c)},class:"chat-demo",children:(ke,vt)=>{var ut=fs(),ht=ue(ut);xe(ht,()=>ls,(Le,Ue)=>{Ue(Le,{title:"PAI Demo",subtitle:"Powered by Greater Components",get connectionStatus(){return e(c)},showClearButton:!0,showSettingsButton:!0,onClear:se,onSettings:()=>_(Y,!0)})});var gt=o(ht,2);xe(gt,()=>Pa,(Le,Ue)=>{Ue(Le,{showAvatars:!0})});var mt=o(gt,2);{var Mt=Le=>{var Ue=ye(),ot=ue(Ue);xe(ot,()=>lt,(It,Dt)=>{Dt(It,{get suggestions(){return y},onSelect:L,variant:"cards"})}),l(Le,Ue)};D(mt,Le=>{e(r).length===0&&Le(Mt)})}var At=o(mt,2);xe(At,()=>Oa,(Le,Ue)=>{Ue(Le,{placeholder:"Ask PAI anything...",get disabled(){return e(h)},showFileUpload:!1,onSend:ot=>j.onSubmit?.(ot)})}),l(ke,ut)},$$slots:{default:!0}})}),a(Q);var v=o(Q,2);tt(v,{title:"Basic Chat Setup",description:"Import and configure the chat components",code:x}),a(E);var b=o(E,2),w=o(s(b),2),te=s(w),K=o(s(te),2);xe(K,()=>lt,(de,be)=>{be(de,{get suggestions(){return y},onSelect:ke=>console.log("Selected:",ke),variant:"pills"})}),a(te);var Z=o(te,2),u=o(s(Z),2);xe(u,()=>lt,(de,be)=>{be(de,{suggestions:[{text:"What is PAI?",description:"Learn about the AI assistant"},{text:"Create a scope",description:"Define context for your project"},{text:"Example workflow",description:"See automation in action"},{text:"Knowledge bases",description:"Explore available documentation"}],onSelect:ke=>console.log("Selected:",ke),variant:"cards"})}),a(Z),a(w);var A=o(w,2);tt(A,{title:"Suggestions with empty state",description:"Show suggestions when conversation is empty",code:H}),a(b);var q=o(b,2),oe=o(s(q),2),he=s(oe),ce=o(s(he),2);xe(ce,()=>at,(de,be)=>{be(de,{toolCall:{id:"demo_pending",tool:"query_knowledge",args:{query:"component patterns",knowledgeBase:"svelte-docs"},status:"pending"}})}),a(he);var W=o(he,2),we=o(s(W),2);xe(we,()=>at,(de,be)=>{be(de,{toolCall:{id:"demo_running",tool:"search_files",args:{pattern:"**/*.svelte",path:"src/lib"},status:"running"}})}),a(W);var me=o(W,2),Pe=o(s(me),2);xe(Pe,()=>at,(de,be)=>{be(de,{toolCall:{id:"demo_complete",tool:"read_file",args:{path:"src/lib/Button.svelte",limit:50},result:{content:`// Svelte component content
export let variant = "solid";`,lines:50},status:"complete"},showResult:!0,collapsible:!0})}),a(me);var Ne=o(me,2),i=o(s(Ne),2);xe(i,()=>at,(de,be)=>{be(de,{toolCall:{id:"demo_error",tool:"execute_command",args:{command:"npm run build"},status:"error",error:"Command failed with exit code 1"}})}),a(Ne),a(oe);var I=o(oe,2);tt(I,{title:"Tool Call Usage",description:"Display tool calls within messages or standalone",code:M}),a(q);var z=o(q,2),O=o(s(z),2),_e=s(O),Ae=o(s(_e),2),Fe=o(s(Ae),2),Xe=s(Fe,!0);a(Fe);var je=o(Fe,4),pe=s(je,!0);a(je);var fe=o(je,4),Ie=s(fe,!0);a(fe);var Qe=o(fe,4),Ge=s(Qe,!0);a(Qe);var et=o(Qe,4),De=s(et,!0);a(et),a(Ae);var Ee=o(Ae,2);Me(Ee,{onclick:()=>_(Y,!0),children:(de,be)=>{Ce();var ke=Be("Open Settings");l(de,ke)},$$slots:{default:!0}}),a(_e),a(O);var nt=o(O,2);tt(nt,{title:"Settings Integration",description:"Add settings button to header and handle changes",code:ne}),a(z);var ct=o(z,2),dt=o(s(ct),2);Ye(dt,20,()=>le,de=>de,(de,be)=>{var ke=ps(),vt=s(ke,!0);a(ke),G(()=>$(vt,be)),l(de,ke)}),a(dt),a(ct),G(de=>{$(Xe,e(F).model),$(pe,e(F).temperature),$(Ie,e(F).maxTokens),$(Ge,e(F).streaming?"Enabled":"Disabled"),$(De,de)},[()=>e(F).knowledgeBases?.join(", ")||"None"]),l(P,R)},$$slots:{actions:!0,default:!0}});var p=o(f,2);xe(p,()=>ms,(B,P)=>{P(B,{get settings(){return e(F)},get availableModels(){return ae},get availableKnowledgeBases(){return U},onSettingsChange:d=>_(F,d,!0),onSave:d=>{_(F,d,!0),_(Y,!1)},onClose:()=>_(Y,!1),get open(){return e(Y)},set open(d){_(Y,d,!0)}})}),l(N,V),qe()}export{Ws as component};
