import{a as o,b as d,c as he,g as Ke,t as z,s as w,h as Me}from"../chunks/BTgIKdxS.js";import{p as Y,Q as W,J as de,b as X,t as P,a as Z,c as i,r as l,f as Q,h as C,d as g,g as a,s as u,u as ve,R as B}from"../chunks/D-WlePPY.js";import{p as I,i as R}from"../chunks/COMTHQNu.js";import{s as fe,b as Ge,e as A}from"../chunks/EAUZg0eb.js";import{c as G}from"../chunks/D4O329PC.js";import{D as Ve}from"../chunks/DhBnkOx0.js";import{c as We,b as Xe,g as Ye,B as Ze,F as et,S as tt}from"../chunks/-F1yS8MK.js";import"../chunks/BcdIAkWN.js";import{h as V}from"../chunks/CyXc35a2.js";import{B as L}from"../chunks/B3zyJtUo.js";import{r as at}from"../chunks/Cl-J97cL.js";import{l as st,p as rt}from"../chunks/LKMhQozY.js";var lt=d("<div><!></div>");function ot(F,h){Y(h,!0);let k=I(h,"handlers",19,()=>({})),x=I(h,"initialQuery",3,""),j=I(h,"class",3,"");const m=W(We(de(()=>x()))),p=Xe(m,de(()=>k()));X(()=>{Object.assign(p.handlers,k())}),X(()=>{x()&&x().trim()&&p.search(x())});var q=lt(),$=i(q);{var y=b=>{var _=he(),N=Q(_);Ge(N,()=>h.children),o(b,_)};R($,b=>{h.children&&b(y)})}l(q),P(()=>fe(q,1,`search-root ${j()}`)),o(F,q),Z()}const it=(()=>({metadata:{slug:"search-demo",title:"Search Application",description:"Unified search bar with semantic toggle, filter chips, and mixed results spanning posts, accounts, and hashtags.",sections:["Search surface","Results","Recents & states"]}})),Dt=Object.freeze(Object.defineProperty({__proto__:null,load:it},Symbol.toStringTag,{value:"Module"}));function nt(F,h){Y(h,!0);let k=I(h,"context",15,null);X(()=>{k(Ye())}),Z()}var ct=d('<div class="state-card svelte-e12qt1" role="alert"><p> </p> <!></div>'),ut=d('<div class="status-skeletons svelte-e12qt1"></div>'),dt=d('<div class="state-card svelte-e12qt1"><p>No posts match this query yet.</p></div>'),vt=d('<div class="status-stack svelte-e12qt1"></div>'),ht=d('<p class="muted svelte-e12qt1">Search to build this list. It stores locally only.</p>'),ft=d('<li class="svelte-e12qt1"><button class="svelte-e12qt1"> </button></li>'),mt=d('<ul class="svelte-e12qt1"></ul>'),pt=d('<li class="svelte-e12qt1"><div><strong> </strong> <p class="muted svelte-e12qt1"> </p></div> <!></li>'),_t=d('<ul class="actor-list svelte-e12qt1"></ul>'),gt=d('<p class="muted svelte-e12qt1">Run a search to populate accounts.</p>'),qt=d("<span> </span>"),yt=d('<div class="tag-grid svelte-e12qt1"></div>'),bt=d('<p class="muted svelte-e12qt1">No tags yet.</p>'),St=d(`<section class="search-section svelte-e12qt1"><header><p class="section-eyebrow svelte-e12qt1">Unified search</p> <h2>Posts, accounts, hashtags</h2> <p class="muted svelte-e12qt1">Semantic mode flips the Lesser API flag; filter chips scope results without refetching
					clients.</p></header> <div class="search-surface svelte-e12qt1"><!> <!></div> <!> <!></section> <section class="search-section search-layout svelte-e12qt1"><div class="results-column svelte-e12qt1" aria-live="polite"><header class="results-header svelte-e12qt1"><h3>Posts</h3> <p class="muted svelte-e12qt1">StatusCard renders note results with optimistic counts.</p></header> <!></div> <section class="side-column svelte-e12qt1" aria-label="Search sidebar"><section class="side-card svelte-e12qt1"><header class="svelte-e12qt1"><h3>Recent searches</h3> <!></header> <!></section> <section class="side-card svelte-e12qt1"><h3>People</h3> <!></section> <section class="side-card svelte-e12qt1"><h3>Hashtags</h3> <!></section></section></section>`,1),xt=d("<!> <!>",1);function Et(F,h){Y(h,!0);const k=t=>new Promise(c=>setTimeout(c,t)),x="search-demo-recents",j=Array.from({length:3},(t,c)=>c);let m=C(null),p=C(!1),q=C(null),$=C(""),y=C(null),b=C(W([])),_=C(W(st(x,[])));function N(t){rt(x,t)}function me(t){const c=t.trim();c&&(g(_,[c,...a(_).filter(D=>D!==c)].slice(0,6),!0),N(a(_)))}function pe(){g(_,[],!0),N([]),a(m)?.updateState({recentSearches:[]})}function _e(t){a(m)&&(a(m).updateState({query:t}),a(m).search(t))}async function ge(){!a(m)||!a($)||a(m).search(a($))}function qe(t){return{id:`search-note-${t.id}`,uri:`https://equalto.social/@${t.author.username}/${t.id}`,url:`https://equalto.social/@${t.author.username}/${t.id}`,account:{id:t.author.id,username:t.author.username,acct:`${t.author.username}@equalto.social`,displayName:t.author.displayName,avatar:t.author.avatar??"https://placehold.co/64x64/0f172a/ffffff?text=AP",url:`https://equalto.social/@${t.author.username}`,note:t.author.bio?`<p>${t.author.bio}</p>`:void 0,followersCount:t.likesCount??0,followingCount:t.repliesCount??0,statusesCount:t.reblogsCount??0,verified:!1,locked:!1,bot:!1,createdAt:t.createdAt},content:t.content,createdAt:t.createdAt,visibility:"public",repliesCount:t.repliesCount??0,reblogsCount:t.reblogsCount??0,favouritesCount:t.likesCount??0,mediaAttachments:[],mentions:[],tags:[]}}const ye={onSearch:async t=>{g(p,!0),g(q,null),g($,t.query,!0);try{if(await k(t.semantic?620:420),t.query.toLowerCase().includes("error"))throw new Error("Lesser API temporarily unavailable. Please retry.");const c=at({query:t.query,semantic:t.semantic,following:t.following,type:t.type});return g(y,c,!0),g(b,c.notes.map(qe),!0),me(t.query),c}catch(c){throw g(q,c instanceof Error?c.message:"Search failed",!0),c}finally{g(p,!1)}}};var ee=he(),be=Q(ee);G(be,()=>ot,(t,c)=>{c(t,{get handlers(){return ye},initialQuery:"compose dock",children:(D,wt)=>{var te=xt(),ae=Q(te);nt(ae,{get context(){return a(m)},set context(E){g(m,E,!0)}});var Se=u(ae,2);Ve(Se,{eyebrow:"Search",get title(){return h.data.metadata.title},get description(){return h.data.metadata.description},children:(E,Ct)=>{var se=St(),O=Q(se),T=u(i(O),2),re=i(T);G(re,()=>Ze,(e,s)=>{s(e,{placeholder:"Search posts, people, tags…",autofocus:!0})});var xe=u(re,2);L(xe,{size:"sm",variant:"outline",onclick:()=>a(m)?.search(),get disabled(){return a(p)},children:(e,s)=>{B();var r=z();P(()=>w(r,a(p)?"Searching…":"Run search")),o(e,r)},$$slots:{default:!0}}),l(T);var le=u(T,2);G(le,()=>et,(e,s)=>{s(e,{})});var we=u(le,2);{var Ce=e=>{var s=ct(),r=i(s),n=i(r,!0);l(r);var v=u(r,2);L(v,{size:"sm",onclick:ge,children:(f,S)=>{B();var M=z("Retry search");o(f,M)},$$slots:{default:!0}}),l(s),P(()=>w(n,a(q))),o(e,s)};R(we,e=>{a(q)&&e(Ce)})}l(O);var oe=u(O,2),U=i(oe),Pe=u(i(U),2);{var ke=e=>{var s=ut();A(s,20,()=>j,r=>r,(r,n)=>{V(r,{variant:"rounded",get"data-index"(){return n}})}),l(s),o(e,s)},Re=e=>{var s=dt();o(e,s)},$e=e=>{var s=vt();A(s,21,()=>a(b),r=>r.id,(r,n)=>{tt(r,{get status(){return a(n)},density:"comfortable"})}),l(s),o(e,s)};R(Pe,e=>{a(p)&&a(b).length===0?e(ke):!a(p)&&a(b).length===0?e(Re,1):e($e,!1)})}l(U);var ie=u(U,2),H=i(ie),J=i(H),Ae=u(i(J),2);{let e=ve(()=>a(_).length===0);L(Ae,{size:"sm",variant:"ghost",onclick:pe,get disabled(){return a(e)},children:(s,r)=>{B();var n=z("Clear recents");o(s,n)},$$slots:{default:!0}})}l(J);var Fe=u(J,2);{var Ne=e=>{var s=ht();o(e,s)},ze=e=>{var s=mt();A(s,20,()=>a(_),r=>r,(r,n)=>{var v=ft(),f=i(v),S=i(f,!0);l(f),l(v),P(()=>w(S,n)),Me("click",f,()=>_e(n)),o(r,v)}),l(s),o(e,s)};R(Fe,e=>{a(_).length===0?e(Ne):e(ze,!1)})}l(H);var K=u(H,2),Be=u(i(K),2);{var Le=e=>{V(e,{variant:"rounded",height:"xl"})},Qe=e=>{var s=_t();A(s,21,()=>a(y).actors,r=>r.id,(r,n)=>{var v=pt(),f=i(v),S=i(f),M=i(S,!0);l(S);var ce=u(S,2),Te=i(ce);l(ce),l(f);var Ue=u(f,2);{let He=ve(()=>a(n).isFollowing?"outline":"solid");L(Ue,{size:"sm",get variant(){return a(He)},children:(Je,Pt)=>{B();var ue=z();P(()=>w(ue,a(n).isFollowing?"Following":"Follow")),o(Je,ue)},$$slots:{default:!0}})}l(v),P(()=>{w(M,a(n).displayName),w(Te,`@${a(n).username??""}`)}),o(r,v)}),l(s),o(e,s)},Ie=e=>{var s=gt();o(e,s)};R(Be,e=>{a(p)&&!a(y)?e(Le):a(y)?.actors.length?e(Qe,1):e(Ie,!1)})}l(K);var ne=u(K,2),je=u(i(ne),2);{var De=e=>{V(e,{variant:"rounded",height:"lg"})},Ee=e=>{var s=yt();A(s,21,()=>a(y).tags,r=>r.name,(r,n)=>{var v=qt();let f;var S=i(v);l(v),P(()=>{f=fe(v,1,"svelte-e12qt1",null,f,{trending:a(n).trending}),w(S,`#${a(n).name??""}`)}),o(r,v)}),l(s),o(e,s)},Oe=e=>{var s=bt();o(e,s)};R(je,e=>{a(p)&&!a(y)?e(De):a(y)?.tags.length?e(Ee,1):e(Oe,!1)})}l(ne),l(ie),l(oe),o(E,se)},$$slots:{default:!0}}),o(D,te)},$$slots:{default:!0}})}),o(F,ee),Z()}Ke(["click"]);export{Et as component,Dt as universal};
