import{a as f,b as W,s as T,j as V,c as z,t as F,f as J}from"./BTgIKdxS.js";import{p as I,s as C,t as S,a as U,c as p,r as b,J as R,Q,b as j,f as N,g as w,u as M}from"./D-WlePPY.js";import{p as v,i as E}from"./COMTHQNu.js";import{d as L,s as B,b as q}from"./EAUZg0eb.js";import"./CyXc35a2.js";import{T as G}from"./DPkrTyWx.js";import{S as H}from"./RefRh14L.js";import{d as K,e as O,f as X,h as Y,E as Z,V as $,M as tt,i as et,D as at}from"./-F1yS8MK.js";var rt=W('<fieldset class="cw-field svelte-hbi49p"><legend class="svelte-hbi49p"> </legend> <div class="cw-toggle svelte-hbi49p"><!> <label class="svelte-hbi49p">Add content warning</label></div> <p class="cw-hint svelte-hbi49p"> </p> <!></fieldset>');function St(k,r){I(r,!0);let m=v(r,"enabled",15,!1),_=v(r,"text",15,""),s=v(r,"label",3,"Content warning"),c=v(r,"hint",3,"Explain why viewers should opt in before revealing the preview.");const u=typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`cw-${Math.random().toString(36).slice(2)}`,a=`${u}-toggle`,l=`${u}-hint`;var t=rt(),x=p(t),i=p(x,!0);b(x);var o=C(x,2),d=p(o);H(d,{get id(){return a},get checked(){return m()},set checked(e){m(e)}});var D=C(d,2);b(o);var y=C(o,2),A=p(y,!0);b(y);var h=C(y,2);{var g=e=>{G(e,{label:"Warning text",placeholder:"e.g., spoilers, content note",maxlength:160,get"aria-describedby"(){return l},get value(){return _()},set value(n){_(n)}})};E(h,e=>{m()&&e(g)})}b(t),S(()=>{T(i,s()),L(D,"for",a),L(y,"id",l),T(A,c())}),f(k,t),U()}var ot=W('<div class="compose-root__error" role="alert"> </div>'),it=W('<div class="compose-root__reply-indicator">Replying to post</div>'),nt=W("<form><!> <!> <!></form>");function st(k,r){I(r,!0);let m=v(r,"config",19,()=>({})),_=v(r,"handlers",19,()=>({})),s=v(r,"initialState",19,()=>({}));const c=R(()=>m().characterLimit)||500,u={content:"",contentWarning:"",visibility:R(()=>m().defaultVisibility)||"public",mediaAttachments:[],submitting:!1,error:null,characterCount:0,overLimit:!1,inReplyTo:void 0,contentWarningEnabled:!1};let a=Q(R(()=>({...u,...s()})));a.characterCount=a.content.length+a.contentWarning.length,a.overLimit=a.characterCount>c,j(()=>{const e=a.content.length+a.contentWarning.length;a.characterCount=e,a.overLimit=e>c});function l(){Object.assign(a,u),a.characterCount=a.content.length+a.contentWarning.length,a.overLimit=a.characterCount>c}const t=K(R(()=>m()),R(()=>_()),R(()=>s()),a);j(()=>{Object.assign(t.handlers,_()),Object.assign(t.config,m())}),t.reset=l;async function x(e){if(e.preventDefault(),!(t.state.overLimit||t.state.submitting)){if(!t.handlers.onSubmit){console.warn("No onSubmit handler provided to Compose.Root");return}t.updateState({submitting:!0,error:null});try{await t.handlers.onSubmit({content:t.state.content,visibility:t.state.visibility,contentWarning:t.state.contentWarningEnabled?t.state.contentWarning:void 0,mediaAttachments:t.state.mediaAttachments,inReplyTo:t.state.inReplyTo}),t.reset()}catch(n){t.updateState({error:n})}finally{t.updateState({submitting:!1})}}}var i=nt();let o;var d=p(i);{var D=e=>{var n=ot(),P=p(n,!0);b(n),S(()=>T(P,t.state.error.message)),f(e,n)};E(d,e=>{t.state.error&&e(D)})}var y=C(d,2);{var A=e=>{var n=it();f(e,n)};E(y,e=>{t.state.inReplyTo&&e(A)})}var h=C(y,2);{var g=e=>{var n=z(),P=N(n);q(P,()=>r.children),f(e,n)};E(h,e=>{r.children&&e(g)})}b(i),S(()=>{o=B(i,1,`compose-root ${t.config.class}`,null,o,{"compose-root--submitting":t.state.submitting,"compose-root--over-limit":t.state.overLimit}),L(i,"aria-busy",t.state.submitting)}),V("submit",i,x),f(k,i),U()}var ct=W('<span class="compose-submit__spinner"><svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"></path><path fill="currentColor" d="M12 4a8 8 0 0 0-8 8h2a6 6 0 0 1 6-6z"></path></svg></span> ',1),lt=W("<button><!></button>");function dt(k,r){I(r,!0);let m=v(r,"text",3,"Post"),_=v(r,"loadingText",3,"Posting..."),s=v(r,"class",3,"");const c=O(),u=X({type:"submit"}),a=M(()=>c.state.submitting||c.state.overLimit||c.state.content.trim().length===0);j(()=>{u.helpers.setDisabled(w(a)),u.helpers.setLoading(c.state.submitting)});var l=lt(),t=p(l);{var x=o=>{var d=ct(),D=C(N(d));S(()=>T(D,` ${_()??""}`)),f(o,d)},i=o=>{var d=F();S(()=>T(d,m())),f(o,d)};E(t,o=>{c.state.submitting?o(x):o(i,!1)})}b(l),Y(l,o=>u.actions.button?.(o)),S(()=>B(l,1,`compose-submit ${s()}`)),f(k,l),U()}var mt=J('<svg class="compose-character-count__progress" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" fill="none" stroke="var(--compose-progress-bg, #e1e8ed)" stroke-width="2"></circle><circle cx="16" cy="16" fill="none" stroke="currentColor" stroke-width="2" transform="rotate(-90 16 16)" class="compose-character-count__progress-circle"></circle></svg>'),ut=W('<span class="compose-character-count__text"> </span>'),vt=W('<div id="compose-character-count" role="status" aria-live="polite"><!> <!></div>');function ht(k,r){I(r,!0);let m=v(r,"showProgress",3,!0),_=v(r,"class",3,"");const s=O(),c=M(()=>s.state.characterCount/s.config.characterLimit*100),u=M(()=>w(c)>=80),a=M(()=>s.state.overLimit),l=14,t=2*Math.PI*l,x=M(()=>t-w(c)/100*t);var i=vt();let o;var d=p(i);{var D=h=>{var g=mt(),e=p(g);L(e,"r",l);var n=C(e);L(n,"r",l),L(n,"stroke-dasharray",t),b(g),S(()=>L(n,"stroke-dashoffset",w(x))),f(h,g)};E(d,h=>{m()&&h(D)})}var y=C(d,2);{var A=h=>{var g=ut(),e=p(g);b(g),S(()=>T(e,`${s.state.characterCount??""} / ${s.config.characterLimit??""}`)),f(h,g)};E(y,h=>{(w(u)||w(a))&&h(A)})}b(i),S(()=>{o=B(i,1,`compose-character-count ${_()}`,null,o,{"compose-character-count--near-limit":w(u),"compose-character-count--over-limit":w(a)}),L(i,"aria-label",`${s.state.characterCount} of ${s.config.characterLimit} characters used`)}),f(k,i),U()}const wt={Root:st,Editor:Z,EditorWithAutocomplete:et,Submit:dt,CharacterCount:ht,VisibilitySelect:$,DraftSaver:at,MediaUpload:tt};export{wt as C,St as a};
